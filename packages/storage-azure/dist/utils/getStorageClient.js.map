{"version":3,"sources":["../../src/utils/getStorageClient.ts"],"sourcesContent":["import type { ContainerClient } from '@azure/storage-blob'\n\nimport { BlobServiceClient } from '@azure/storage-blob'\n\nimport type { AzureStorageOptions } from '../index.js'\n\n// Cache the Azure Blob storage clients in a map so that multiple instances are not overriding each other in the case of different configurations used per collection\nconst azureClients = new Map<string, ContainerClient>()\n\nexport function getStorageClient(\n  options: Pick<AzureStorageOptions, 'clientCacheKey' | 'connectionString' | 'containerName'>,\n): ContainerClient {\n  const cacheKey = options.clientCacheKey || `azure:${options.containerName}`\n\n  if (azureClients.has(cacheKey)) {\n    return azureClients.get(cacheKey)!\n  }\n\n  const { connectionString, containerName } = options\n\n  const blobServiceClient = BlobServiceClient.fromConnectionString(connectionString)\n\n  azureClients.set(cacheKey, blobServiceClient.getContainerClient(containerName))\n\n  return azureClients.get(cacheKey)!\n}\n"],"names":["BlobServiceClient","azureClients","Map","getStorageClient","options","cacheKey","clientCacheKey","containerName","has","get","connectionString","blobServiceClient","fromConnectionString","set","getContainerClient"],"mappings":"AAEA,SAASA,iBAAiB,QAAQ,sBAAqB;AAIvD,qKAAqK;AACrK,MAAMC,eAAe,IAAIC;AAEzB,OAAO,SAASC,iBACdC,OAA2F;IAE3F,MAAMC,WAAWD,QAAQE,cAAc,IAAI,CAAC,MAAM,EAAEF,QAAQG,aAAa,EAAE;IAE3E,IAAIN,aAAaO,GAAG,CAACH,WAAW;QAC9B,OAAOJ,aAAaQ,GAAG,CAACJ;IAC1B;IAEA,MAAM,EAAEK,gBAAgB,EAAEH,aAAa,EAAE,GAAGH;IAE5C,MAAMO,oBAAoBX,kBAAkBY,oBAAoB,CAACF;IAEjET,aAAaY,GAAG,CAACR,UAAUM,kBAAkBG,kBAAkB,CAACP;IAEhE,OAAON,aAAaQ,GAAG,CAACJ;AAC1B"}
{"version":3,"sources":["../../src/queries/getLocalizedSortProperty.spec.ts"],"sourcesContent":["import { describe, beforeAll, it, expect } from 'vitest'\nimport type { Config, SanitizedConfig } from 'payload'\nimport { flattenAllFields, sanitizeConfig } from 'payload'\n\nimport { getLocalizedSortProperty } from './getLocalizedSortProperty.js'\n\nlet config: SanitizedConfig\n\ndescribe('get localized sort property', () => {\n  beforeAll(async () => {\n    config = await sanitizeConfig({\n      localization: {\n        defaultLocale: 'en',\n        fallback: true,\n        locales: ['en', 'es'],\n      },\n    } as Config)\n  })\n  it('passes through a non-localized sort property', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: [\n        {\n          name: 'title',\n          type: 'text',\n        },\n      ],\n      locale: 'en',\n      segments: ['title'],\n    })\n\n    expect(result).toStrictEqual('title')\n  })\n\n  it('properly localizes an un-localized sort property', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: [\n        {\n          name: 'title',\n          type: 'text',\n          localized: true,\n        },\n      ],\n      locale: 'en',\n      segments: ['title'],\n    })\n\n    expect(result).toStrictEqual('title.en')\n  })\n\n  it('keeps specifically asked-for localized sort properties', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: [\n        {\n          name: 'title',\n          type: 'text',\n          localized: true,\n        },\n      ],\n      locale: 'en',\n      segments: ['title', 'es'],\n    })\n\n    expect(result).toStrictEqual('title.es')\n  })\n\n  it('properly localizes nested sort properties', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: flattenAllFields({\n        fields: [\n          {\n            name: 'group',\n            type: 'group',\n            fields: [\n              {\n                name: 'title',\n                type: 'text',\n                localized: true,\n              },\n            ],\n          },\n        ],\n      }),\n      locale: 'en',\n      segments: ['group', 'title'],\n    })\n\n    expect(result).toStrictEqual('group.title.en')\n  })\n\n  it('keeps requested locale with nested sort properties', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: flattenAllFields({\n        fields: [\n          {\n            name: 'group',\n            type: 'group',\n            fields: [\n              {\n                name: 'title',\n                type: 'text',\n                localized: true,\n              },\n            ],\n          },\n        ],\n      }),\n      locale: 'en',\n      segments: ['group', 'title', 'es'],\n    })\n\n    expect(result).toStrictEqual('group.title.es')\n  })\n\n  it('properly localizes field within row', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: flattenAllFields({\n        fields: [\n          {\n            type: 'row',\n            fields: [\n              {\n                name: 'title',\n                type: 'text',\n                localized: true,\n              },\n            ],\n          },\n        ],\n      }),\n      locale: 'en',\n      segments: ['title'],\n    })\n\n    expect(result).toStrictEqual('title.en')\n  })\n\n  it('properly localizes field within named tab', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: flattenAllFields({\n        fields: [\n          {\n            type: 'tabs',\n            tabs: [\n              {\n                name: 'tab',\n                fields: [\n                  {\n                    name: 'title',\n                    type: 'text',\n                    localized: true,\n                  },\n                ],\n              },\n            ],\n          },\n        ],\n      }),\n      locale: 'en',\n      segments: ['tab', 'title'],\n    })\n\n    expect(result).toStrictEqual('tab.title.en')\n  })\n\n  it('properly localizes field within unnamed tab', () => {\n    const result = getLocalizedSortProperty({\n      config,\n      parentIsLocalized: false,\n      fields: flattenAllFields({\n        fields: [\n          {\n            type: 'tabs',\n            tabs: [\n              {\n                fields: [\n                  {\n                    name: 'title',\n                    type: 'text',\n                    localized: true,\n                  },\n                ],\n                label: 'Tab',\n              },\n            ],\n          },\n        ],\n      }),\n      locale: 'en',\n      segments: ['title'],\n    })\n\n    expect(result).toStrictEqual('title.en')\n  })\n})\n"],"names":["describe","beforeAll","it","expect","flattenAllFields","sanitizeConfig","getLocalizedSortProperty","config","localization","defaultLocale","fallback","locales","result","parentIsLocalized","fields","name","type","locale","segments","toStrictEqual","localized","tabs","label"],"mappings":"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"}
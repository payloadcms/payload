{"version":3,"sources":["../../../../src/collections/carts/endpoints/removeItem.ts"],"sourcesContent":["import type { CollectionSlug, Endpoint } from 'payload'\n\nimport { addDataAndFileToRequest } from 'payload'\n\nimport { removeItem } from '../operations/removeItem.js'\n\ntype Args = {\n  cartsSlug: CollectionSlug\n}\n\n/**\n * Creates an endpoint handler for removing items from a cart.\n *\n * Route: POST /api/{cartsSlug}/:id/remove-item\n *\n * Request body:\n * - itemID: string (the cart item row ID to remove)\n * - secret?: string (for guest cart access)\n */\nexport const removeItemEndpoint = ({ cartsSlug }: Args): Endpoint => ({\n  handler: async (req) => {\n    await addDataAndFileToRequest(req)\n\n    const cartID = req.routeParams?.id as string | undefined\n    const data = req.data as {\n      itemID?: string\n      secret?: string\n    }\n\n    if (!cartID) {\n      return Response.json({ message: 'Cart ID is required', success: false }, { status: 400 })\n    }\n\n    if (!data?.itemID) {\n      return Response.json({ message: 'Item ID is required', success: false }, { status: 400 })\n    }\n\n    const result = await removeItem({\n      cartID,\n      cartsSlug,\n      itemID: data.itemID,\n      payload: req.payload,\n      req,\n      secret: data.secret,\n    })\n\n    if (!result.success) {\n      return Response.json(result, { status: 404 })\n    }\n\n    return Response.json(result)\n  },\n  method: 'post',\n  path: '/:id/remove-item',\n})\n"],"names":["addDataAndFileToRequest","removeItem","removeItemEndpoint","cartsSlug","handler","req","cartID","routeParams","id","data","Response","json","message","success","status","itemID","result","payload","secret","method","path"],"mappings":"AAEA,SAASA,uBAAuB,QAAQ,UAAS;AAEjD,SAASC,UAAU,QAAQ,8BAA6B;AAMxD;;;;;;;;CAQC,GACD,OAAO,MAAMC,qBAAqB,CAAC,EAAEC,SAAS,EAAQ,GAAgB,CAAA;QACpEC,SAAS,OAAOC;YACd,MAAML,wBAAwBK;YAE9B,MAAMC,SAASD,IAAIE,WAAW,EAAEC;YAChC,MAAMC,OAAOJ,IAAII,IAAI;YAKrB,IAAI,CAACH,QAAQ;gBACX,OAAOI,SAASC,IAAI,CAAC;oBAAEC,SAAS;oBAAuBC,SAAS;gBAAM,GAAG;oBAAEC,QAAQ;gBAAI;YACzF;YAEA,IAAI,CAACL,MAAMM,QAAQ;gBACjB,OAAOL,SAASC,IAAI,CAAC;oBAAEC,SAAS;oBAAuBC,SAAS;gBAAM,GAAG;oBAAEC,QAAQ;gBAAI;YACzF;YAEA,MAAME,SAAS,MAAMf,WAAW;gBAC9BK;gBACAH;gBACAY,QAAQN,KAAKM,MAAM;gBACnBE,SAASZ,IAAIY,OAAO;gBACpBZ;gBACAa,QAAQT,KAAKS,MAAM;YACrB;YAEA,IAAI,CAACF,OAAOH,OAAO,EAAE;gBACnB,OAAOH,SAASC,IAAI,CAACK,QAAQ;oBAAEF,QAAQ;gBAAI;YAC7C;YAEA,OAAOJ,SAASC,IAAI,CAACK;QACvB;QACAG,QAAQ;QACRC,MAAM;IACR,CAAA,EAAE"}
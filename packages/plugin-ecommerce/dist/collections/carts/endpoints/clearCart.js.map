{"version":3,"sources":["../../../../src/collections/carts/endpoints/clearCart.ts"],"sourcesContent":["import type { CollectionSlug, Endpoint } from 'payload'\n\nimport { addDataAndFileToRequest } from 'payload'\n\nimport { clearCart } from '../operations/clearCart.js'\n\ntype Args = {\n  cartsSlug: CollectionSlug\n}\n\n/**\n * Creates an endpoint handler for clearing all items from a cart.\n *\n * Route: POST /api/{cartsSlug}/:id/clear\n *\n * Request body:\n * - secret?: string (for guest cart access)\n */\nexport const clearCartEndpoint = ({ cartsSlug }: Args): Endpoint => ({\n  handler: async (req) => {\n    await addDataAndFileToRequest(req)\n\n    const cartID = req.routeParams?.id as string | undefined\n    const data = req.data as {\n      secret?: string\n    }\n\n    if (!cartID) {\n      return Response.json({ message: 'Cart ID is required', success: false }, { status: 400 })\n    }\n\n    const result = await clearCart({\n      cartID,\n      cartsSlug,\n      payload: req.payload,\n      req,\n      secret: data?.secret,\n    })\n\n    if (!result.success) {\n      return Response.json(result, { status: 404 })\n    }\n\n    return Response.json(result)\n  },\n  method: 'post',\n  path: '/:id/clear',\n})\n"],"names":["addDataAndFileToRequest","clearCart","clearCartEndpoint","cartsSlug","handler","req","cartID","routeParams","id","data","Response","json","message","success","status","result","payload","secret","method","path"],"mappings":"AAEA,SAASA,uBAAuB,QAAQ,UAAS;AAEjD,SAASC,SAAS,QAAQ,6BAA4B;AAMtD;;;;;;;CAOC,GACD,OAAO,MAAMC,oBAAoB,CAAC,EAAEC,SAAS,EAAQ,GAAgB,CAAA;QACnEC,SAAS,OAAOC;YACd,MAAML,wBAAwBK;YAE9B,MAAMC,SAASD,IAAIE,WAAW,EAAEC;YAChC,MAAMC,OAAOJ,IAAII,IAAI;YAIrB,IAAI,CAACH,QAAQ;gBACX,OAAOI,SAASC,IAAI,CAAC;oBAAEC,SAAS;oBAAuBC,SAAS;gBAAM,GAAG;oBAAEC,QAAQ;gBAAI;YACzF;YAEA,MAAMC,SAAS,MAAMd,UAAU;gBAC7BK;gBACAH;gBACAa,SAASX,IAAIW,OAAO;gBACpBX;gBACAY,QAAQR,MAAMQ;YAChB;YAEA,IAAI,CAACF,OAAOF,OAAO,EAAE;gBACnB,OAAOH,SAASC,IAAI,CAACI,QAAQ;oBAAED,QAAQ;gBAAI;YAC7C;YAEA,OAAOJ,SAASC,IAAI,CAACI;QACvB;QACAG,QAAQ;QACRC,MAAM;IACR,CAAA,EAAE"}
{"version":3,"sources":["../../../src/collections/carts/hasCartSecretAccess.ts"],"sourcesContent":["import type { Access } from 'payload'\n\n/**\n * Internal access function for guest cart access via secret in context or queries.\n * Only active when allowGuestCarts is enabled.\n *\n * @param allowGuestCarts - Whether guest cart access is enabled\n * @returns Access function that checks for valid cart secret in context\n */\nexport const hasCartSecretAccess = (allowGuestCarts: boolean): Access => {\n  return ({ req }) => {\n    if (!allowGuestCarts) {\n      return false\n    }\n\n    const cartSecret = req.context?.cartSecret ?? req.query?.secret\n\n    if (!cartSecret || typeof cartSecret !== 'string') {\n      return false\n    }\n\n    return {\n      secret: {\n        equals: cartSecret,\n      },\n    }\n  }\n}\n"],"names":["hasCartSecretAccess","allowGuestCarts","req","cartSecret","context","query","secret","equals"],"mappings":"AAEA;;;;;;CAMC,GACD,OAAO,MAAMA,sBAAsB,CAACC;IAClC,OAAO,CAAC,EAAEC,GAAG,EAAE;QACb,IAAI,CAACD,iBAAiB;YACpB,OAAO;QACT;QAEA,MAAME,aAAaD,IAAIE,OAAO,EAAED,cAAcD,IAAIG,KAAK,EAAEC;QAEzD,IAAI,CAACH,cAAc,OAAOA,eAAe,UAAU;YACjD,OAAO;QACT;QAEA,OAAO;YACLG,QAAQ;gBACNC,QAAQJ;YACV;QACF;IACF;AACF,EAAC"}
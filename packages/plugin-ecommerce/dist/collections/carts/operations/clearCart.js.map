{"version":3,"sources":["../../../../src/collections/carts/operations/clearCart.ts"],"sourcesContent":["import type { CartOperationResult, ClearCartArgs } from './types.js'\n\nimport { createRequestWithSecret } from './createRequestWithSecret.js'\n\n/**\n * Clears all items from a cart.\n *\n * This handler is isolated and can be used from:\n * - Custom endpoints\n * - Local API operations\n * - Hooks\n *\n * @example\n * ```ts\n * const result = await clearCart({\n *   payload,\n *   cartsSlug: 'carts',\n *   cartID: '123',\n * })\n * ```\n */\nexport const clearCart = async (args: ClearCartArgs): Promise<CartOperationResult> => {\n  const { cartID, cartsSlug, payload, req, secret } = args\n\n  // Inject secret into request context for access control\n  const reqWithSecret = createRequestWithSecret(req, secret)\n\n  const cart = await payload.findByID({\n    id: cartID,\n    collection: cartsSlug,\n    depth: 0,\n    overrideAccess: false,\n    req: reqWithSecret,\n  })\n\n  if (!cart) {\n    return {\n      cart: null,\n      message: `Cart with ID ${cartID} not found`,\n      success: false,\n    }\n  }\n\n  const updatedCart = await payload.update({\n    id: cartID,\n    collection: cartsSlug,\n    data: {\n      items: [],\n    },\n    depth: 0,\n    overrideAccess: false,\n    req: reqWithSecret,\n  })\n\n  return {\n    cart: updatedCart,\n    message: 'Cart cleared',\n    success: true,\n  }\n}\n"],"names":["createRequestWithSecret","clearCart","args","cartID","cartsSlug","payload","req","secret","reqWithSecret","cart","findByID","id","collection","depth","overrideAccess","message","success","updatedCart","update","data","items"],"mappings":"AAEA,SAASA,uBAAuB,QAAQ,+BAA8B;AAEtE;;;;;;;;;;;;;;;;CAgBC,GACD,OAAO,MAAMC,YAAY,OAAOC;IAC9B,MAAM,EAAEC,MAAM,EAAEC,SAAS,EAAEC,OAAO,EAAEC,GAAG,EAAEC,MAAM,EAAE,GAAGL;IAEpD,wDAAwD;IACxD,MAAMM,gBAAgBR,wBAAwBM,KAAKC;IAEnD,MAAME,OAAO,MAAMJ,QAAQK,QAAQ,CAAC;QAClCC,IAAIR;QACJS,YAAYR;QACZS,OAAO;QACPC,gBAAgB;QAChBR,KAAKE;IACP;IAEA,IAAI,CAACC,MAAM;QACT,OAAO;YACLA,MAAM;YACNM,SAAS,CAAC,aAAa,EAAEZ,OAAO,UAAU,CAAC;YAC3Ca,SAAS;QACX;IACF;IAEA,MAAMC,cAAc,MAAMZ,QAAQa,MAAM,CAAC;QACvCP,IAAIR;QACJS,YAAYR;QACZe,MAAM;YACJC,OAAO,EAAE;QACX;QACAP,OAAO;QACPC,gBAAgB;QAChBR,KAAKE;IACP;IAEA,OAAO;QACLC,MAAMQ;QACNF,SAAS;QACTC,SAAS;IACX;AACF,EAAC"}
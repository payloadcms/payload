{"version":3,"sources":["../../../../src/collections/carts/operations/types.ts"],"sourcesContent":["import type { DefaultDocumentIDType, Payload, PayloadRequest } from 'payload'\n\n/**\n * Represents an item in the cart with populated or ID references.\n */\nexport type CartItemData = {\n  [key: string]: unknown\n  /**\n   * The ID of the cart item. Array item IDs are always strings in Payload,\n   * regardless of the database adapter's default ID type.\n   */\n  id?: string\n  product: { [key: string]: unknown; id: DefaultDocumentIDType } | DefaultDocumentIDType\n  quantity: number\n  variant?: { [key: string]: unknown; id: DefaultDocumentIDType } | DefaultDocumentIDType\n}\n\n/**\n * Represents a new item to be added to the cart.\n */\nexport type NewCartItem = {\n  [key: string]: unknown\n  product: DefaultDocumentIDType\n  quantity?: number\n  variant?: DefaultDocumentIDType\n}\n\n/**\n * Arguments for the cart item matcher function.\n */\nexport type CartItemMatcherArgs = {\n  /** The existing cart item to compare against */\n  existingItem: CartItemData\n  /** The new item being added */\n  newItem: NewCartItem\n}\n\n/**\n * Function to determine if two cart items should be considered the same.\n * When items match, their quantities are combined instead of creating separate entries.\n */\nexport type CartItemMatcher = (args: CartItemMatcherArgs) => boolean\n\n/**\n * MongoDB-style update operator for numeric fields.\n * Supports $inc for increment/decrement operations.\n *\n * @example\n * ```ts\n * // Set quantity to 5\n * { quantity: 5 }\n *\n * // Increment quantity by 1\n * { quantity: { $inc: 1 } }\n *\n * // Decrement quantity by 2\n * { quantity: { $inc: -2 } }\n * ```\n */\nexport type NumericOperator = {\n  /** Increment by this value (use negative to decrement) */\n  $inc: number\n}\n\n/**\n * A field value that can be either a direct value or an operator.\n */\nexport type FieldWithOperator<T> = NumericOperator | T\n\n/**\n * Checks if a value is a NumericOperator.\n */\nexport function isNumericOperator(value: unknown): value is NumericOperator {\n  return typeof value === 'object' && value !== null && '$inc' in value\n}\n\n/**\n * Base arguments for all cart operations.\n */\nexport type BaseCartOperationArgs = {\n  /** The cart ID to operate on */\n  cartID: DefaultDocumentIDType\n  /** The carts collection slug */\n  cartsSlug: string\n  /** Payload instance */\n  payload: Payload\n  /** Optional request context for access control */\n  req?: PayloadRequest\n  /** Secret for guest cart access */\n  secret?: string\n}\n\n/**\n * Arguments for the addItem operation.\n */\nexport type AddItemArgs = {\n  /** Custom matcher function to determine item uniqueness */\n  cartItemMatcher?: CartItemMatcher\n  /** The item to add */\n  item: NewCartItem\n  /** Quantity to add (defaults to 1) */\n  quantity?: number\n} & BaseCartOperationArgs\n\n/**\n * Arguments for the removeItem operation.\n */\nexport type RemoveItemArgs = {\n  /**\n   * The cart item row ID to remove.\n   * Array item IDs are always strings in Payload, regardless of the database adapter's default ID type.\n   */\n  itemID: string\n} & BaseCartOperationArgs\n\n/**\n * Arguments for the updateItem operation.\n * Supports MongoDB-style operators for flexible updates.\n */\nexport type UpdateItemArgs = {\n  /**\n   * The cart item row ID to update.\n   * Array item IDs are always strings in Payload, regardless of the database adapter's default ID type.\n   */\n  itemID: string\n  /**\n   * The quantity value or operator.\n   * - Direct number: Sets the quantity to this value\n   * - { $inc: n }: Increments quantity by n (use negative to decrement)\n   *\n   * @example\n   * ```ts\n   * // Set quantity to 5\n   * { quantity: 5 }\n   *\n   * // Increment by 1\n   * { quantity: { $inc: 1 } }\n   *\n   * // Decrement by 1\n   * { quantity: { $inc: -1 } }\n   * ```\n   */\n  quantity: FieldWithOperator<number>\n  /** Whether to remove the item if quantity reaches 0 (defaults to true) */\n  removeOnZero?: boolean\n} & BaseCartOperationArgs\n\n/**\n * Arguments for the clearCart operation.\n */\nexport type ClearCartArgs = BaseCartOperationArgs\n\n/**\n * Result of a cart operation.\n */\nexport type CartOperationResult<T = unknown> = {\n  cart: T\n  message: string\n  success: boolean\n}\n"],"names":["isNumericOperator","value"],"mappings":"AAqEA;;CAEC,GACD,OAAO,SAASA,kBAAkBC,KAAc;IAC9C,OAAO,OAAOA,UAAU,YAAYA,UAAU,QAAQ,UAAUA;AAClE"}
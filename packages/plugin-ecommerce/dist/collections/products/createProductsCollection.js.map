{"version":3,"sources":["../../../src/collections/products/createProductsCollection.ts"],"sourcesContent":["import type { CollectionConfig } from 'payload'\n\nimport type { AccessConfig, CurrenciesConfig, InventoryConfig } from '../../types/index.js'\n\nimport { inventoryField } from '../../fields/inventoryField.js'\nimport { pricesField } from '../../fields/pricesField.js'\nimport { variantsFields } from '../../fields/variantsFields.js'\n\ntype Props = {\n  access: Pick<AccessConfig, 'adminOrPublishedStatus' | 'isAdmin'>\n  currenciesConfig: CurrenciesConfig\n  enableVariants?: boolean\n  /**\n   * Adds in an inventory field to the product and its variants. This is useful for tracking inventory levels.\n   * Defaults to true.\n   */\n  inventory?: boolean | InventoryConfig\n  /**\n   * Slug of the variants collection, defaults to 'variants'.\n   */\n  variantsSlug?: string\n  /**\n   * Slug of the variant types collection, defaults to 'variantTypes'.\n   */\n  variantTypesSlug?: string\n}\n\nexport const createProductsCollection: (props: Props) => CollectionConfig = (props) => {\n  const {\n    access,\n    currenciesConfig,\n    enableVariants = false,\n    inventory = true,\n    variantsSlug = 'variants',\n    variantTypesSlug = 'variantTypes',\n  } = props || {}\n\n  const fields = [\n    ...(inventory\n      ? [\n          inventoryField({\n            overrides: {\n              admin: {\n                condition: ({ enableVariants }) => !enableVariants,\n              },\n            },\n          }),\n        ]\n      : []),\n    ...(enableVariants ? variantsFields({ variantsSlug, variantTypesSlug }) : []),\n    ...(currenciesConfig ? [...pricesField({ currenciesConfig })] : []),\n  ]\n\n  const baseConfig: CollectionConfig = {\n    slug: 'products',\n    access: {\n      create: access.isAdmin,\n      delete: access.isAdmin,\n      read: access.adminOrPublishedStatus,\n      update: access.isAdmin,\n    },\n    admin: {\n      defaultColumns: [\n        ...(currenciesConfig ? ['prices'] : []),\n        ...(enableVariants ? ['variants'] : []),\n      ],\n      group: 'Ecommerce',\n    },\n    fields,\n    labels: {\n      plural: ({ t }) =>\n        // @ts-expect-error - translations are not typed in plugins yet\n        t('plugin-ecommerce:products'),\n      singular: ({ t }) =>\n        // @ts-expect-error - translations are not typed in plugins yet\n        t('plugin-ecommerce:product'),\n    },\n    trash: true,\n    versions: {\n      drafts: {\n        autosave: true,\n      },\n    },\n  }\n\n  return baseConfig\n}\n"],"names":["inventoryField","pricesField","variantsFields","createProductsCollection","props","access","currenciesConfig","enableVariants","inventory","variantsSlug","variantTypesSlug","fields","overrides","admin","condition","baseConfig","slug","create","isAdmin","delete","read","adminOrPublishedStatus","update","defaultColumns","group","labels","plural","t","singular","trash","versions","drafts","autosave"],"mappings":"AAIA,SAASA,cAAc,QAAQ,iCAAgC;AAC/D,SAASC,WAAW,QAAQ,8BAA6B;AACzD,SAASC,cAAc,QAAQ,iCAAgC;AAqB/D,OAAO,MAAMC,2BAA+D,CAACC;IAC3E,MAAM,EACJC,MAAM,EACNC,gBAAgB,EAChBC,iBAAiB,KAAK,EACtBC,YAAY,IAAI,EAChBC,eAAe,UAAU,EACzBC,mBAAmB,cAAc,EAClC,GAAGN,SAAS,CAAC;IAEd,MAAMO,SAAS;WACTH,YACA;YACER,eAAe;gBACbY,WAAW;oBACTC,OAAO;wBACLC,WAAW,CAAC,EAAEP,cAAc,EAAE,GAAK,CAACA;oBACtC;gBACF;YACF;SACD,GACD,EAAE;WACFA,iBAAiBL,eAAe;YAAEO;YAAcC;QAAiB,KAAK,EAAE;WACxEJ,mBAAmB;eAAIL,YAAY;gBAAEK;YAAiB;SAAG,GAAG,EAAE;KACnE;IAED,MAAMS,aAA+B;QACnCC,MAAM;QACNX,QAAQ;YACNY,QAAQZ,OAAOa,OAAO;YACtBC,QAAQd,OAAOa,OAAO;YACtBE,MAAMf,OAAOgB,sBAAsB;YACnCC,QAAQjB,OAAOa,OAAO;QACxB;QACAL,OAAO;YACLU,gBAAgB;mBACVjB,mBAAmB;oBAAC;iBAAS,GAAG,EAAE;mBAClCC,iBAAiB;oBAAC;iBAAW,GAAG,EAAE;aACvC;YACDiB,OAAO;QACT;QACAb;QACAc,QAAQ;YACNC,QAAQ,CAAC,EAAEC,CAAC,EAAE,GACZ,+DAA+D;gBAC/DA,EAAE;YACJC,UAAU,CAAC,EAAED,CAAC,EAAE,GACd,+DAA+D;gBAC/DA,EAAE;QACN;QACAE,OAAO;QACPC,UAAU;YACRC,QAAQ;gBACNC,UAAU;YACZ;QACF;IACF;IAEA,OAAOjB;AACT,EAAC"}
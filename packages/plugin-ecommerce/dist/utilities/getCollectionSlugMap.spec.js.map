{"version":3,"sources":["../../src/utilities/getCollectionSlugMap.spec.ts"],"sourcesContent":["import { describe, it, expect, vitest } from 'vitest'\nimport type { SanitizedEcommercePluginConfig } from '../types/index.js'\n\nimport { USD } from '../currencies/index.js'\nimport { getCollectionSlugMap } from './getCollectionSlugMap'\n\ndescribe('getCollectionSlugMap', () => {\n  const mockAccessConfig = {\n    adminOnlyFieldAccess: vitest.fn(),\n    adminOrPublishedStatus: vitest.fn(),\n    customerOnlyFieldAccess: vitest.fn(),\n    isAdmin: vitest.fn(),\n    isAuthenticated: vitest.fn(),\n    isDocumentOwner: vitest.fn(),\n    publicAccess: vitest.fn(),\n  }\n\n  const baseConfig: SanitizedEcommercePluginConfig = {\n    access: mockAccessConfig,\n    addresses: {\n      addressFields: [],\n    },\n    carts: true,\n    currencies: {\n      defaultCurrency: 'USD',\n      supportedCurrencies: [USD],\n    },\n    customers: {\n      slug: 'users',\n    },\n    orders: true,\n    payments: {\n      paymentMethods: [],\n    },\n    products: true,\n    transactions: true,\n  }\n\n  it('should return default slug map without variant slugs when enableVariants is false', () => {\n    const result = getCollectionSlugMap({ sanitizedPluginConfig: baseConfig })\n\n    expect(result).toEqual({\n      addresses: 'addresses',\n      carts: 'carts',\n      customers: 'users',\n      orders: 'orders',\n      products: 'products',\n      transactions: 'transactions',\n    })\n  })\n\n  it('should return default slug map with variant slugs when enableVariants is true', () => {\n    const result = getCollectionSlugMap({ enableVariants: true, sanitizedPluginConfig: baseConfig })\n\n    expect(result).toEqual({\n      addresses: 'addresses',\n      carts: 'carts',\n      customers: 'users',\n      orders: 'orders',\n      products: 'products',\n      transactions: 'transactions',\n      variantOptions: 'variantOptions',\n      variants: 'variants',\n      variantTypes: 'variantTypes',\n    })\n  })\n\n  it('should use custom customers slug when provided', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      customers: {\n        slug: 'custom-users',\n      },\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: true, sanitizedPluginConfig: config })\n\n    expect(result.customers).toBe('custom-users')\n  })\n\n  it('should apply slugMap overrides when variants enabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: {\n        products: 'custom-products',\n        variants: 'custom-variants',\n        orders: 'custom-orders',\n      },\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: true, sanitizedPluginConfig: config })\n\n    expect(result.products).toBe('custom-products')\n    expect(result.variants).toBe('custom-variants')\n    expect(result.orders).toBe('custom-orders')\n    // Other slugs should remain default\n    expect(result.addresses).toBe('addresses')\n    expect(result.carts).toBe('carts')\n  })\n\n  it('should not apply variant slugMap overrides when variants disabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: {\n        products: 'custom-products',\n        variants: 'custom-variants',\n        orders: 'custom-orders',\n      },\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: false, sanitizedPluginConfig: config })\n\n    expect(result.products).toBe('custom-products')\n    expect(result.variants).toBeUndefined()\n    expect(result.orders).toBe('custom-orders')\n  })\n\n  it('should prioritize slugMap overrides over customers slug', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      customers: {\n        slug: 'my-users',\n      },\n      slugMap: {\n        customers: 'overridden-users',\n      },\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: true, sanitizedPluginConfig: config })\n\n    expect(result.customers).toBe('overridden-users')\n  })\n\n  it('should handle partial slugMap overrides with variants enabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: {\n        products: 'items',\n      },\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: true, sanitizedPluginConfig: config })\n\n    expect(result.products).toBe('items')\n    expect(result.addresses).toBe('addresses')\n    expect(result.carts).toBe('carts')\n    expect(result.customers).toBe('users')\n    expect(result.orders).toBe('orders')\n    expect(result.transactions).toBe('transactions')\n    expect(result.variants).toBe('variants')\n    expect(result.variantOptions).toBe('variantOptions')\n    expect(result.variantTypes).toBe('variantTypes')\n  })\n\n  it('should handle partial slugMap overrides with variants disabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: {\n        products: 'items',\n      },\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: false, sanitizedPluginConfig: config })\n\n    expect(result.products).toBe('items')\n    expect(result.addresses).toBe('addresses')\n    expect(result.carts).toBe('carts')\n    expect(result.customers).toBe('users')\n    expect(result.orders).toBe('orders')\n    expect(result.transactions).toBe('transactions')\n    expect(result.variants).toBeUndefined()\n    expect(result.variantOptions).toBeUndefined()\n    expect(result.variantTypes).toBeUndefined()\n  })\n\n  it('should handle empty slugMap with variants enabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: {},\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: true, sanitizedPluginConfig: config })\n\n    expect(result).toEqual({\n      addresses: 'addresses',\n      carts: 'carts',\n      customers: 'users',\n      orders: 'orders',\n      products: 'products',\n      transactions: 'transactions',\n      variantOptions: 'variantOptions',\n      variants: 'variants',\n      variantTypes: 'variantTypes',\n    })\n  })\n\n  it('should handle empty slugMap with variants disabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: {},\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: false, sanitizedPluginConfig: config })\n\n    expect(result).toEqual({\n      addresses: 'addresses',\n      carts: 'carts',\n      customers: 'users',\n      orders: 'orders',\n      products: 'products',\n      transactions: 'transactions',\n    })\n  })\n\n  it('should handle undefined slugMap with variants enabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: undefined,\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: true, sanitizedPluginConfig: config })\n\n    expect(result).toEqual({\n      addresses: 'addresses',\n      carts: 'carts',\n      customers: 'users',\n      orders: 'orders',\n      products: 'products',\n      transactions: 'transactions',\n      variantOptions: 'variantOptions',\n      variants: 'variants',\n      variantTypes: 'variantTypes',\n    })\n  })\n\n  it('should handle undefined slugMap with variants disabled', () => {\n    const config: SanitizedEcommercePluginConfig = {\n      ...baseConfig,\n      slugMap: undefined,\n    }\n\n    const result = getCollectionSlugMap({ enableVariants: false, sanitizedPluginConfig: config })\n\n    expect(result).toEqual({\n      addresses: 'addresses',\n      carts: 'carts',\n      customers: 'users',\n      orders: 'orders',\n      products: 'products',\n      transactions: 'transactions',\n    })\n  })\n})\n"],"names":["describe","it","expect","vitest","USD","getCollectionSlugMap","mockAccessConfig","adminOnlyFieldAccess","fn","adminOrPublishedStatus","customerOnlyFieldAccess","isAdmin","isAuthenticated","isDocumentOwner","publicAccess","baseConfig","access","addresses","addressFields","carts","currencies","defaultCurrency","supportedCurrencies","customers","slug","orders","payments","paymentMethods","products","transactions","result","sanitizedPluginConfig","toEqual","enableVariants","variantOptions","variants","variantTypes","config","toBe","slugMap","toBeUndefined","undefined"],"mappings":"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"}
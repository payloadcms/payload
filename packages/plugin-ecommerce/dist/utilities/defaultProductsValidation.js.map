{"version":3,"sources":["../../src/utilities/defaultProductsValidation.ts"],"sourcesContent":["import type { ProductsValidation } from '../types/index.js'\n\nimport { MissingPrice, OutOfStock } from './errorCodes.js'\n\nexport const defaultProductsValidation: ProductsValidation = ({\n  currenciesConfig,\n  currency,\n  product,\n  quantity = 1,\n  variant,\n}) => {\n  if (!currency) {\n    throw new Error('Currency must be provided for product validation.')\n  }\n\n  const priceField = `priceIn${currency.toUpperCase()}`\n\n  if (variant) {\n    if (!variant[priceField]) {\n      throw new Error(`Variant with ID ${variant.id} does not have a price in ${currency}.`)\n    }\n\n    if (variant.inventory === 0 || (variant.inventory && variant.inventory < quantity)) {\n      throw new Error(\n        `Variant with ID ${variant.id} is out of stock or does not have enough inventory.`,\n      )\n    }\n  } else if (product) {\n    // Validate the product's details only if the variant is not provided as it can have its own inventory and price\n    if (!product[priceField]) {\n      throw new Error(`Product does not have a price in.`, {\n        cause: { code: MissingPrice, codes: [product.id, currency] },\n      })\n    }\n\n    if (product.inventory === 0 || (product.inventory && product.inventory < quantity)) {\n      throw new Error(`Product is out of stock or does not have enough inventory.`, {\n        cause: { code: OutOfStock, codes: [product.id] },\n      })\n    }\n  }\n}\n"],"names":["MissingPrice","OutOfStock","defaultProductsValidation","currenciesConfig","currency","product","quantity","variant","Error","priceField","toUpperCase","id","inventory","cause","code","codes"],"mappings":"AAEA,SAASA,YAAY,EAAEC,UAAU,QAAQ,kBAAiB;AAE1D,OAAO,MAAMC,4BAAgD,CAAC,EAC5DC,gBAAgB,EAChBC,QAAQ,EACRC,OAAO,EACPC,WAAW,CAAC,EACZC,OAAO,EACR;IACC,IAAI,CAACH,UAAU;QACb,MAAM,IAAII,MAAM;IAClB;IAEA,MAAMC,aAAa,CAAC,OAAO,EAAEL,SAASM,WAAW,IAAI;IAErD,IAAIH,SAAS;QACX,IAAI,CAACA,OAAO,CAACE,WAAW,EAAE;YACxB,MAAM,IAAID,MAAM,CAAC,gBAAgB,EAAED,QAAQI,EAAE,CAAC,0BAA0B,EAAEP,SAAS,CAAC,CAAC;QACvF;QAEA,IAAIG,QAAQK,SAAS,KAAK,KAAML,QAAQK,SAAS,IAAIL,QAAQK,SAAS,GAAGN,UAAW;YAClF,MAAM,IAAIE,MACR,CAAC,gBAAgB,EAAED,QAAQI,EAAE,CAAC,mDAAmD,CAAC;QAEtF;IACF,OAAO,IAAIN,SAAS;QAClB,gHAAgH;QAChH,IAAI,CAACA,OAAO,CAACI,WAAW,EAAE;YACxB,MAAM,IAAID,MAAM,CAAC,iCAAiC,CAAC,EAAE;gBACnDK,OAAO;oBAAEC,MAAMd;oBAAce,OAAO;wBAACV,QAAQM,EAAE;wBAAEP;qBAAS;gBAAC;YAC7D;QACF;QAEA,IAAIC,QAAQO,SAAS,KAAK,KAAMP,QAAQO,SAAS,IAAIP,QAAQO,SAAS,GAAGN,UAAW;YAClF,MAAM,IAAIE,MAAM,CAAC,0DAA0D,CAAC,EAAE;gBAC5EK,OAAO;oBAAEC,MAAMb;oBAAYc,OAAO;wBAACV,QAAQM,EAAE;qBAAC;gBAAC;YACjD;QACF;IACF;AACF,EAAC"}
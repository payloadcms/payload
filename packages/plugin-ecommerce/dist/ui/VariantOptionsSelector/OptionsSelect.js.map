{"version":3,"sources":["../../../src/ui/VariantOptionsSelector/OptionsSelect.tsx"],"sourcesContent":["'use client'\n\nimport type { SelectFieldClient } from 'payload'\n\nimport { FieldLabel, ReactSelect, useField, useForm } from '@payloadcms/ui'\nimport { useCallback, useId, useMemo } from 'react'\n\ntype Props = {\n  field: Omit<SelectFieldClient, 'type'>\n  label: string\n  options: { label: string; value: number | string }[]\n  path: string\n}\n\nexport const OptionsSelect: React.FC<Props> = (props) => {\n  const {\n    field: { required },\n    label,\n    options: optionsFromProps,\n    path,\n  } = props\n\n  const { setValue, value } = useField<(number | string)[]>({ path })\n  const id = useId()\n\n  const selectedValue = useMemo(() => {\n    if (!value || !Array.isArray(value) || value.length === 0) {\n      return undefined\n    }\n    const foundOption = optionsFromProps.find((option) => {\n      return value.find((item) => item === option.value)\n    })\n\n    return foundOption\n  }, [optionsFromProps, value])\n\n  const handleChange = useCallback(\n    // @ts-expect-error - TODO: Fix types\n    (option) => {\n      if (selectedValue) {\n        let selectedValueIndex = -1\n\n        const valuesWithoutSelected = [...value].filter((o, index) => {\n          if (o === selectedValue.value) {\n            selectedValueIndex = index\n            return false\n          }\n\n          return true\n        })\n\n        const newValues = [...valuesWithoutSelected]\n\n        newValues.splice(selectedValueIndex, 0, option.value)\n\n        setValue(newValues)\n      } else {\n        const values = [...(value || []), option.value]\n\n        setValue(values)\n      }\n    },\n    [selectedValue, setValue, value],\n  )\n\n  return (\n    <div className=\"variantOptionsSelectorItem\">\n      <FieldLabel htmlFor={id} label={label} required={required} />\n\n      <ReactSelect\n        inputId={id}\n        onChange={handleChange}\n        options={optionsFromProps}\n        value={selectedValue}\n      />\n    </div>\n  )\n}\n"],"names":["FieldLabel","ReactSelect","useField","useCallback","useId","useMemo","OptionsSelect","props","field","required","label","options","optionsFromProps","path","setValue","value","id","selectedValue","Array","isArray","length","undefined","foundOption","find","option","item","handleChange","selectedValueIndex","valuesWithoutSelected","filter","o","index","newValues","splice","values","div","className","htmlFor","inputId","onChange"],"mappings":"AAAA;;AAIA,SAASA,UAAU,EAAEC,WAAW,EAAEC,QAAQ,QAAiB,iBAAgB;AAC3E,SAASC,WAAW,EAAEC,KAAK,EAAEC,OAAO,QAAQ,QAAO;AASnD,OAAO,MAAMC,gBAAiC,CAACC;IAC7C,MAAM,EACJC,OAAO,EAAEC,QAAQ,EAAE,EACnBC,KAAK,EACLC,SAASC,gBAAgB,EACzBC,IAAI,EACL,GAAGN;IAEJ,MAAM,EAAEO,QAAQ,EAAEC,KAAK,EAAE,GAAGb,SAA8B;QAAEW;IAAK;IACjE,MAAMG,KAAKZ;IAEX,MAAMa,gBAAgBZ,QAAQ;QAC5B,IAAI,CAACU,SAAS,CAACG,MAAMC,OAAO,CAACJ,UAAUA,MAAMK,MAAM,KAAK,GAAG;YACzD,OAAOC;QACT;QACA,MAAMC,cAAcV,iBAAiBW,IAAI,CAAC,CAACC;YACzC,OAAOT,MAAMQ,IAAI,CAAC,CAACE,OAASA,SAASD,OAAOT,KAAK;QACnD;QAEA,OAAOO;IACT,GAAG;QAACV;QAAkBG;KAAM;IAE5B,MAAMW,eAAevB,YACnB,qCAAqC;IACrC,CAACqB;QACC,IAAIP,eAAe;YACjB,IAAIU,qBAAqB,CAAC;YAE1B,MAAMC,wBAAwB;mBAAIb;aAAM,CAACc,MAAM,CAAC,CAACC,GAAGC;gBAClD,IAAID,MAAMb,cAAcF,KAAK,EAAE;oBAC7BY,qBAAqBI;oBACrB,OAAO;gBACT;gBAEA,OAAO;YACT;YAEA,MAAMC,YAAY;mBAAIJ;aAAsB;YAE5CI,UAAUC,MAAM,CAACN,oBAAoB,GAAGH,OAAOT,KAAK;YAEpDD,SAASkB;QACX,OAAO;YACL,MAAME,SAAS;mBAAKnB,SAAS,EAAE;gBAAGS,OAAOT,KAAK;aAAC;YAE/CD,SAASoB;QACX;IACF,GACA;QAACjB;QAAeH;QAAUC;KAAM;IAGlC,qBACE,MAACoB;QAAIC,WAAU;;0BACb,KAACpC;gBAAWqC,SAASrB;gBAAIN,OAAOA;gBAAOD,UAAUA;;0BAEjD,KAACR;gBACCqC,SAAStB;gBACTuB,UAAUb;gBACVf,SAASC;gBACTG,OAAOE;;;;AAIf,EAAC"}
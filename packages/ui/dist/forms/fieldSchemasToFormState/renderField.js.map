{"version":3,"file":"renderField.js","names":["getTranslation","createClientField","MissingEditorProp","fieldIsHiddenOrDisabled","RenderServerComponent","FieldDescription","WatchCondition","defaultUIFieldComponentKeys","renderField","id","clientFieldSchemaMap","collectionSlug","data","fieldConfig","fieldSchemaMap","fieldState","forceCreateClientField","formState","indexPath","lastRenderedPath","mockRSCs","operation","parentPath","parentSchemaPath","path","permissions","preferences","readOnly","readOnlyFromProps","renderAllFields","req","schemaPath","siblingData","hasBeforeOrAfterInput","admin","components","requiresRender","type","clientField","get","defaultIDType","payload","config","db","field","i18n","importMap","clientProps","customComponents","includes","serverProps","user","value","name","rows","forEach","row","rowIndex","rowLastRenderedPath","rowPath","rowRequiresRender","RowLabel","Component","key","rowLabel","labels","singular","String","padStart","rowNumber","blockTypeToMatch","blockType","blockConfig","blocks","blockReferences","find","block","slug","Label","Object","keys","length","description","editor","Error","Field","_jsx","FieldComponent","sanitizedEditorConfig","editorConfig","undefined","Description","t","AfterInput","afterInput","BeforeInput","beforeInput"],"sources":["../../../src/forms/fieldSchemasToFormState/renderField.tsx"],"sourcesContent":["import type {\n  ClientComponentProps,\n  ClientField,\n  FieldPaths,\n  FlattenedBlock,\n  ServerComponentProps,\n} from 'payload'\n\nimport { getTranslation } from '@payloadcms/translations'\nimport { createClientField, MissingEditorProp } from 'payload'\nimport { fieldIsHiddenOrDisabled } from 'payload/shared'\n\nimport type { RenderFieldMethod } from './types.js'\n\nimport { RenderServerComponent } from '../../elements/RenderServerComponent/index.js'\n\n// eslint-disable-next-line payload/no-imports-from-exports-dir -- MUST reference the exports dir: https://github.com/payloadcms/payload/issues/12002#issuecomment-2791493587\nimport { FieldDescription, WatchCondition } from '../../exports/client/index.js'\n\nconst defaultUIFieldComponentKeys: Array<'Cell' | 'Description' | 'Field' | 'Filter'> = [\n  'Cell',\n  'Description',\n  'Field',\n  'Filter',\n]\n\nexport const renderField: RenderFieldMethod = ({\n  id,\n  clientFieldSchemaMap,\n  collectionSlug,\n  data,\n  fieldConfig,\n  fieldSchemaMap,\n  fieldState,\n  forceCreateClientField,\n  formState,\n  indexPath,\n  lastRenderedPath,\n  mockRSCs,\n  operation,\n  parentPath,\n  parentSchemaPath,\n  path,\n  permissions,\n  preferences,\n  readOnly: readOnlyFromProps,\n  renderAllFields,\n  req,\n  schemaPath,\n  siblingData,\n}) => {\n  // Fields with beforeInput/afterInput need custom components created, so they require render\n  const hasBeforeOrAfterInput =\n    fieldConfig.admin?.components &&\n    ('beforeInput' in fieldConfig.admin.components || 'afterInput' in fieldConfig.admin.components)\n\n  const requiresRender =\n    renderAllFields || !lastRenderedPath || lastRenderedPath !== path || hasBeforeOrAfterInput\n\n  if (!requiresRender && fieldConfig.type !== 'array' && fieldConfig.type !== 'blocks') {\n    return\n  }\n\n  const clientField =\n    clientFieldSchemaMap && !forceCreateClientField\n      ? (clientFieldSchemaMap.get(schemaPath) as ClientField)\n      : createClientField({\n          defaultIDType: req.payload.config.db.defaultIDType,\n          field: fieldConfig,\n          i18n: req.i18n,\n          importMap: req.payload.importMap,\n        })\n\n  const clientProps: ClientComponentProps & Partial<FieldPaths> = {\n    field: clientField,\n    path,\n    permissions,\n    readOnly:\n      readOnlyFromProps === true\n        ? true\n        : typeof permissions === 'boolean'\n          ? !permissions\n          : !permissions?.[operation],\n    schemaPath,\n  }\n\n  if (fieldState?.customComponents) {\n    clientProps.customComponents = fieldState.customComponents\n  }\n\n  // fields with subfields\n  if (['array', 'blocks', 'collapsible', 'group', 'row', 'tabs'].includes(fieldConfig.type)) {\n    clientProps.indexPath = indexPath\n    clientProps.parentPath = parentPath\n    clientProps.parentSchemaPath = parentSchemaPath\n  }\n\n  const serverProps: ServerComponentProps = {\n    id,\n    clientField,\n    clientFieldSchemaMap,\n    data,\n    field: fieldConfig,\n    fieldSchemaMap,\n    permissions,\n    // TODO: Should we pass explicit values? initialValue, value, valid\n    // value and initialValue should be typed\n    collectionSlug,\n    formState,\n    i18n: req.i18n,\n    operation,\n    payload: req.payload,\n    preferences,\n    req,\n    siblingData,\n    user: req.user,\n    value: 'name' in fieldConfig && data?.[fieldConfig.name],\n  }\n\n  switch (fieldConfig.type) {\n    case 'array': {\n      fieldState?.rows?.forEach((row, rowIndex) => {\n        const rowLastRenderedPath = row.lastRenderedPath\n\n        const rowPath = `${path}.${rowIndex}`\n\n        const rowRequiresRender =\n          renderAllFields || !rowLastRenderedPath || rowLastRenderedPath !== rowPath\n\n        if (!rowRequiresRender) {\n          return\n        }\n\n        row.lastRenderedPath = rowPath\n\n        if (fieldConfig.admin?.components && 'RowLabel' in fieldConfig.admin.components) {\n          if (!row.customComponents) {\n            row.customComponents = {}\n          }\n\n          row.customComponents.RowLabel = !mockRSCs\n            ? RenderServerComponent({\n                clientProps,\n                Component: fieldConfig.admin.components.RowLabel,\n                importMap: req.payload.importMap,\n                key: `${rowIndex}`,\n                serverProps: {\n                  ...serverProps,\n                  rowLabel: `${getTranslation(fieldConfig.labels.singular, req.i18n)} ${String(\n                    rowIndex + 1,\n                  ).padStart(2, '0')}`,\n                  rowNumber: rowIndex + 1,\n                },\n              })\n            : 'Mock'\n        }\n      })\n\n      break\n    }\n\n    case 'blocks': {\n      fieldState?.rows?.forEach((row, rowIndex) => {\n        const rowLastRenderedPath = row.lastRenderedPath\n\n        const rowPath = `${path}.${rowIndex}`\n\n        const rowRequiresRender =\n          renderAllFields || !rowLastRenderedPath || rowLastRenderedPath !== rowPath\n\n        if (!rowRequiresRender) {\n          return\n        }\n\n        row.lastRenderedPath = rowPath\n\n        const blockTypeToMatch: string = row.blockType\n\n        const blockConfig =\n          req.payload.blocks[blockTypeToMatch] ??\n          ((fieldConfig.blockReferences ?? fieldConfig.blocks).find(\n            (block) => typeof block !== 'string' && block.slug === blockTypeToMatch,\n          ) as FlattenedBlock | undefined)\n\n        if (blockConfig.admin?.components && 'Label' in blockConfig.admin.components) {\n          if (!fieldState.rows[rowIndex]?.customComponents) {\n            fieldState.rows[rowIndex].customComponents = {}\n          }\n\n          fieldState.rows[rowIndex].customComponents.RowLabel = !mockRSCs\n            ? RenderServerComponent({\n                clientProps,\n                Component: blockConfig.admin.components.Label,\n                importMap: req.payload.importMap,\n                key: `${rowIndex}`,\n                serverProps: {\n                  ...serverProps,\n                  blockType: row.blockType,\n                  rowLabel: `${getTranslation(blockConfig.labels.singular, req.i18n)} ${String(\n                    rowIndex + 1,\n                  ).padStart(2, '0')}`,\n                  rowNumber: rowIndex + 1,\n                },\n              })\n            : 'Mock'\n        }\n      })\n\n      break\n    }\n  }\n\n  if (!requiresRender) {\n    return\n  }\n\n  /**\n   * Set the `lastRenderedPath` equal to the new path of the field, this will prevent it from being rendered again\n   */\n  fieldState.lastRenderedPath = path\n\n  if (fieldIsHiddenOrDisabled(clientField)) {\n    return\n  }\n\n  /**\n   * Only create the `customComponents` object if needed.\n   * This will prevent unnecessary data from being transferred to the client.\n   */\n  if (fieldConfig.admin) {\n    if (\n      (Object.keys(fieldConfig.admin.components || {}).length > 0 ||\n        fieldConfig.type === 'richText' ||\n        ('description' in fieldConfig.admin &&\n          typeof fieldConfig.admin.description === 'function')) &&\n      !fieldState?.customComponents\n    ) {\n      fieldState.customComponents = {}\n    }\n  }\n\n  switch (fieldConfig.type) {\n    case 'richText': {\n      if (!fieldConfig?.editor) {\n        throw new MissingEditorProp(fieldConfig) // while we allow disabling editor functionality, you should not have any richText fields defined if you do not have an editor\n      }\n\n      if (typeof fieldConfig?.editor === 'function') {\n        throw new Error('Attempted to access unsanitized rich text editor.')\n      }\n\n      if (!fieldConfig.admin) {\n        fieldConfig.admin = {}\n      }\n\n      if (!fieldConfig.admin.components) {\n        fieldConfig.admin.components = {}\n      }\n\n      fieldState.customComponents.Field = !mockRSCs ? (\n        <WatchCondition path={path}>\n          {RenderServerComponent({\n            clientProps,\n            Component: fieldConfig.editor.FieldComponent,\n            importMap: req.payload.importMap,\n            serverProps: {\n              ...serverProps,\n              // Manually inject lexical-specific `sanitizedEditorConfig` server prop, in order to reduce the size of the field schema.\n              // Otherwise, the editorConfig would be included twice - once on the top-level, and once as part of the `FieldComponent` server props.\n              sanitizedEditorConfig:\n                'editorConfig' in fieldConfig.editor ? fieldConfig.editor.editorConfig : undefined,\n            },\n          })}\n        </WatchCondition>\n      ) : (\n        'Mock'\n      )\n\n      break\n    }\n\n    case 'ui': {\n      if (fieldConfig?.admin?.components) {\n        // Render any extra, untyped components\n        for (const key in fieldConfig.admin.components) {\n          if (key in defaultUIFieldComponentKeys) {\n            continue\n          }\n\n          const Component = fieldConfig.admin.components[key]\n\n          fieldState.customComponents[key] = !mockRSCs\n            ? RenderServerComponent({\n                clientProps,\n                Component,\n                importMap: req.payload.importMap,\n                key: `field.admin.components.${key}`,\n                serverProps,\n              })\n            : 'Mock'\n        }\n      }\n      break\n    }\n\n    default: {\n      break\n    }\n  }\n\n  if (fieldConfig.admin) {\n    if (\n      'description' in fieldConfig.admin &&\n      typeof fieldConfig.admin?.description === 'function'\n    ) {\n      fieldState.customComponents.Description = !mockRSCs ? (\n        <FieldDescription\n          description={fieldConfig.admin?.description({\n            i18n: req.i18n,\n            t: req.i18n.t,\n          })}\n          path={path}\n        />\n      ) : (\n        'Mock'\n      )\n    }\n\n    if (fieldConfig.admin?.components) {\n      if ('afterInput' in fieldConfig.admin.components) {\n        fieldState.customComponents.AfterInput = !mockRSCs\n          ? RenderServerComponent({\n              clientProps,\n              Component: fieldConfig.admin.components.afterInput,\n              importMap: req.payload.importMap,\n              key: `field.admin.components.afterInput.${path}`,\n              serverProps,\n            })\n          : 'Mock'\n      }\n\n      if ('beforeInput' in fieldConfig.admin.components) {\n        fieldState.customComponents.BeforeInput = !mockRSCs\n          ? RenderServerComponent({\n              clientProps,\n              Component: fieldConfig.admin.components.beforeInput,\n              importMap: req.payload.importMap,\n              key: `field.admin.components.beforeInput.${path}`,\n              serverProps,\n            })\n          : 'Mock'\n      }\n\n      if ('Description' in fieldConfig.admin.components) {\n        fieldState.customComponents.Description = !mockRSCs\n          ? RenderServerComponent({\n              clientProps,\n              Component: fieldConfig.admin.components.Description,\n              importMap: req.payload.importMap,\n              key: 'field.admin.components.Description',\n              serverProps,\n            })\n          : 'Mock'\n      }\n\n      if ('Error' in fieldConfig.admin.components) {\n        fieldState.customComponents.Error = !mockRSCs\n          ? RenderServerComponent({\n              clientProps,\n              Component: fieldConfig.admin.components.Error,\n              importMap: req.payload.importMap,\n              key: 'field.admin.components.Error',\n              serverProps,\n            })\n          : 'Mock'\n      }\n\n      if ('Label' in fieldConfig.admin.components) {\n        fieldState.customComponents.Label = !mockRSCs\n          ? RenderServerComponent({\n              clientProps,\n              Component: fieldConfig.admin.components.Label,\n              importMap: req.payload.importMap,\n              key: 'field.admin.components.Label',\n              serverProps,\n            })\n          : 'Mock'\n      }\n\n      if ('Field' in fieldConfig.admin.components) {\n        fieldState.customComponents.Field = !mockRSCs ? (\n          <WatchCondition path={path}>\n            {RenderServerComponent({\n              clientProps,\n              Component: fieldConfig.admin.components.Field,\n              importMap: req.payload.importMap,\n              key: 'field.admin.components.Field',\n              serverProps,\n            })}\n          </WatchCondition>\n        ) : (\n          'Mock'\n        )\n      }\n    }\n  }\n}\n"],"mappings":";AAQA,SAASA,cAAc,QAAQ;AAC/B,SAASC,iBAAiB,EAAEC,iBAAiB,QAAQ;AACrD,SAASC,uBAAuB,QAAQ;AAIxC,SAASC,qBAAqB,QAAQ;AAEtC;AACA,SAASC,gBAAgB,EAAEC,cAAc,QAAQ;AAEjD,MAAMC,2BAAA,GAAkF,CACtF,QACA,eACA,SACA,SACD;AAED,OAAO,MAAMC,WAAA,GAAiCA,CAAC;EAC7CC,EAAE;EACFC,oBAAoB;EACpBC,cAAc;EACdC,IAAI;EACJC,WAAW;EACXC,cAAc;EACdC,UAAU;EACVC,sBAAsB;EACtBC,SAAS;EACTC,SAAS;EACTC,gBAAgB;EAChBC,QAAQ;EACRC,SAAS;EACTC,UAAU;EACVC,gBAAgB;EAChBC,IAAI;EACJC,WAAW;EACXC,WAAW;EACXC,QAAA,EAAUC,iBAAiB;EAC3BC,eAAe;EACfC,GAAG;EACHC,UAAU;EACVC;AAAW,CACZ;EACC;EACA,MAAMC,qBAAA,GACJpB,WAAA,CAAYqB,KAAK,EAAEC,UAAA,KAClB,iBAAiBtB,WAAA,CAAYqB,KAAK,CAACC,UAAU,IAAI,gBAAgBtB,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAAD;EAE/F,MAAMC,cAAA,GACJP,eAAA,IAAmB,CAACV,gBAAA,IAAoBA,gBAAA,KAAqBK,IAAA,IAAQS,qBAAA;EAEvE,IAAI,CAACG,cAAA,IAAkBvB,WAAA,CAAYwB,IAAI,KAAK,WAAWxB,WAAA,CAAYwB,IAAI,KAAK,UAAU;IACpF;EACF;EAEA,MAAMC,WAAA,GACJ5B,oBAAA,IAAwB,CAACM,sBAAA,GACpBN,oBAAA,CAAqB6B,GAAG,CAACR,UAAA,IAC1B9B,iBAAA,CAAkB;IAChBuC,aAAA,EAAeV,GAAA,CAAIW,OAAO,CAACC,MAAM,CAACC,EAAE,CAACH,aAAa;IAClDI,KAAA,EAAO/B,WAAA;IACPgC,IAAA,EAAMf,GAAA,CAAIe,IAAI;IACdC,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK;EACzB;EAEN,MAAMC,WAAA,GAA0D;IAC9DH,KAAA,EAAON,WAAA;IACPd,IAAA;IACAC,WAAA;IACAE,QAAA,EACEC,iBAAA,KAAsB,OAClB,OACA,OAAOH,WAAA,KAAgB,YACrB,CAACA,WAAA,GACD,CAACA,WAAA,GAAcJ,SAAA,CAAU;IACjCU;EACF;EAEA,IAAIhB,UAAA,EAAYiC,gBAAA,EAAkB;IAChCD,WAAA,CAAYC,gBAAgB,GAAGjC,UAAA,CAAWiC,gBAAgB;EAC5D;EAEA;EACA,IAAI,CAAC,SAAS,UAAU,eAAe,SAAS,OAAO,OAAO,CAACC,QAAQ,CAACpC,WAAA,CAAYwB,IAAI,GAAG;IACzFU,WAAA,CAAY7B,SAAS,GAAGA,SAAA;IACxB6B,WAAA,CAAYzB,UAAU,GAAGA,UAAA;IACzByB,WAAA,CAAYxB,gBAAgB,GAAGA,gBAAA;EACjC;EAEA,MAAM2B,WAAA,GAAoC;IACxCzC,EAAA;IACA6B,WAAA;IACA5B,oBAAA;IACAE,IAAA;IACAgC,KAAA,EAAO/B,WAAA;IACPC,cAAA;IACAW,WAAA;IACA;IACA;IACAd,cAAA;IACAM,SAAA;IACA4B,IAAA,EAAMf,GAAA,CAAIe,IAAI;IACdxB,SAAA;IACAoB,OAAA,EAASX,GAAA,CAAIW,OAAO;IACpBf,WAAA;IACAI,GAAA;IACAE,WAAA;IACAmB,IAAA,EAAMrB,GAAA,CAAIqB,IAAI;IACdC,KAAA,EAAO,UAAUvC,WAAA,IAAeD,IAAA,GAAOC,WAAA,CAAYwC,IAAI;EACzD;EAEA,QAAQxC,WAAA,CAAYwB,IAAI;IACtB,KAAK;MAAS;QACZtB,UAAA,EAAYuC,IAAA,EAAMC,OAAA,CAAQ,CAACC,GAAA,EAAKC,QAAA;UAC9B,MAAMC,mBAAA,GAAsBF,GAAA,CAAIrC,gBAAgB;UAEhD,MAAMwC,OAAA,GAAU,GAAGnC,IAAA,IAAQiC,QAAA,EAAU;UAErC,MAAMG,iBAAA,GACJ/B,eAAA,IAAmB,CAAC6B,mBAAA,IAAuBA,mBAAA,KAAwBC,OAAA;UAErE,IAAI,CAACC,iBAAA,EAAmB;YACtB;UACF;UAEAJ,GAAA,CAAIrC,gBAAgB,GAAGwC,OAAA;UAEvB,IAAI9C,WAAA,CAAYqB,KAAK,EAAEC,UAAA,IAAc,cAActB,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;YAC/E,IAAI,CAACqB,GAAA,CAAIR,gBAAgB,EAAE;cACzBQ,GAAA,CAAIR,gBAAgB,GAAG,CAAC;YAC1B;YAEAQ,GAAA,CAAIR,gBAAgB,CAACa,QAAQ,GAAG,CAACzC,QAAA,GAC7BhB,qBAAA,CAAsB;cACpB2C,WAAA;cACAe,SAAA,EAAWjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAAC0B,QAAQ;cAChDf,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;cAChCiB,GAAA,EAAK,GAAGN,QAAA,EAAU;cAClBP,WAAA,EAAa;gBACX,GAAGA,WAAW;gBACdc,QAAA,EAAU,GAAGhE,cAAA,CAAea,WAAA,CAAYoD,MAAM,CAACC,QAAQ,EAAEpC,GAAA,CAAIe,IAAI,KAAKsB,MAAA,CACpEV,QAAA,GAAW,GACXW,QAAQ,CAAC,GAAG,MAAM;gBACpBC,SAAA,EAAWZ,QAAA,GAAW;cACxB;YACF,KACA;UACN;QACF;QAEA;MACF;IAEA,KAAK;MAAU;QACb1C,UAAA,EAAYuC,IAAA,EAAMC,OAAA,CAAQ,CAACC,GAAA,EAAKC,QAAA;UAC9B,MAAMC,mBAAA,GAAsBF,GAAA,CAAIrC,gBAAgB;UAEhD,MAAMwC,OAAA,GAAU,GAAGnC,IAAA,IAAQiC,QAAA,EAAU;UAErC,MAAMG,iBAAA,GACJ/B,eAAA,IAAmB,CAAC6B,mBAAA,IAAuBA,mBAAA,KAAwBC,OAAA;UAErE,IAAI,CAACC,iBAAA,EAAmB;YACtB;UACF;UAEAJ,GAAA,CAAIrC,gBAAgB,GAAGwC,OAAA;UAEvB,MAAMW,gBAAA,GAA2Bd,GAAA,CAAIe,SAAS;UAE9C,MAAMC,WAAA,GACJ1C,GAAA,CAAIW,OAAO,CAACgC,MAAM,CAACH,gBAAA,CAAiB,IACnC,CAACzD,WAAA,CAAY6D,eAAe,IAAI7D,WAAA,CAAY4D,MAAM,EAAEE,IAAI,CACtDC,KAAA,IAAU,OAAOA,KAAA,KAAU,YAAYA,KAAA,CAAMC,IAAI,KAAKP,gBAAA;UAG3D,IAAIE,WAAA,CAAYtC,KAAK,EAAEC,UAAA,IAAc,WAAWqC,WAAA,CAAYtC,KAAK,CAACC,UAAU,EAAE;YAC5E,IAAI,CAACpB,UAAA,CAAWuC,IAAI,CAACG,QAAA,CAAS,EAAET,gBAAA,EAAkB;cAChDjC,UAAA,CAAWuC,IAAI,CAACG,QAAA,CAAS,CAACT,gBAAgB,GAAG,CAAC;YAChD;YAEAjC,UAAA,CAAWuC,IAAI,CAACG,QAAA,CAAS,CAACT,gBAAgB,CAACa,QAAQ,GAAG,CAACzC,QAAA,GACnDhB,qBAAA,CAAsB;cACpB2C,WAAA;cACAe,SAAA,EAAWU,WAAA,CAAYtC,KAAK,CAACC,UAAU,CAAC2C,KAAK;cAC7ChC,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;cAChCiB,GAAA,EAAK,GAAGN,QAAA,EAAU;cAClBP,WAAA,EAAa;gBACX,GAAGA,WAAW;gBACdqB,SAAA,EAAWf,GAAA,CAAIe,SAAS;gBACxBP,QAAA,EAAU,GAAGhE,cAAA,CAAewE,WAAA,CAAYP,MAAM,CAACC,QAAQ,EAAEpC,GAAA,CAAIe,IAAI,KAAKsB,MAAA,CACpEV,QAAA,GAAW,GACXW,QAAQ,CAAC,GAAG,MAAM;gBACpBC,SAAA,EAAWZ,QAAA,GAAW;cACxB;YACF,KACA;UACN;QACF;QAEA;MACF;EACF;EAEA,IAAI,CAACrB,cAAA,EAAgB;IACnB;EACF;EAEA;;;EAGArB,UAAA,CAAWI,gBAAgB,GAAGK,IAAA;EAE9B,IAAIrB,uBAAA,CAAwBmC,WAAA,GAAc;IACxC;EACF;EAEA;;;;EAIA,IAAIzB,WAAA,CAAYqB,KAAK,EAAE;IACrB,IACE,CAAC6C,MAAA,CAAOC,IAAI,CAACnE,WAAA,CAAYqB,KAAK,CAACC,UAAU,IAAI,CAAC,GAAG8C,MAAM,GAAG,KACxDpE,WAAA,CAAYwB,IAAI,KAAK,cACpB,iBAAiBxB,WAAA,CAAYqB,KAAK,IACjC,OAAOrB,WAAA,CAAYqB,KAAK,CAACgD,WAAW,KAAK,UAAU,KACvD,CAACnE,UAAA,EAAYiC,gBAAA,EACb;MACAjC,UAAA,CAAWiC,gBAAgB,GAAG,CAAC;IACjC;EACF;EAEA,QAAQnC,WAAA,CAAYwB,IAAI;IACtB,KAAK;MAAY;QACf,IAAI,CAACxB,WAAA,EAAasE,MAAA,EAAQ;UACxB,MAAM,IAAIjF,iBAAA,CAAkBW,WAAA,EAAa;UAAA;QAC3C;QAEA,IAAI,OAAOA,WAAA,EAAasE,MAAA,KAAW,YAAY;UAC7C,MAAM,IAAIC,KAAA,CAAM;QAClB;QAEA,IAAI,CAACvE,WAAA,CAAYqB,KAAK,EAAE;UACtBrB,WAAA,CAAYqB,KAAK,GAAG,CAAC;QACvB;QAEA,IAAI,CAACrB,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;UACjCtB,WAAA,CAAYqB,KAAK,CAACC,UAAU,GAAG,CAAC;QAClC;QAEApB,UAAA,CAAWiC,gBAAgB,CAACqC,KAAK,GAAG,CAACjE,QAAA,gBACnCkE,IAAA,CAAChF,cAAA;UAAekB,IAAA,EAAMA,IAAA;oBACnBpB,qBAAA,CAAsB;YACrB2C,WAAA;YACAe,SAAA,EAAWjD,WAAA,CAAYsE,MAAM,CAACI,cAAc;YAC5CzC,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;YAChCI,WAAA,EAAa;cACX,GAAGA,WAAW;cACd;cACA;cACAsC,qBAAA,EACE,kBAAkB3E,WAAA,CAAYsE,MAAM,GAAGtE,WAAA,CAAYsE,MAAM,CAACM,YAAY,GAAGC;YAC7E;UACF;aAGF;QAGF;MACF;IAEA,KAAK;MAAM;QACT,IAAI7E,WAAA,EAAaqB,KAAA,EAAOC,UAAA,EAAY;UAClC;UACA,KAAK,MAAM4B,GAAA,IAAOlD,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;YAC9C,IAAI4B,GAAA,IAAOxD,2BAAA,EAA6B;cACtC;YACF;YAEA,MAAMuD,SAAA,GAAYjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAAC4B,GAAA,CAAI;YAEnDhD,UAAA,CAAWiC,gBAAgB,CAACe,GAAA,CAAI,GAAG,CAAC3C,QAAA,GAChChB,qBAAA,CAAsB;cACpB2C,WAAA;cACAe,SAAA;cACAhB,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;cAChCiB,GAAA,EAAK,0BAA0BA,GAAA,EAAK;cACpCb;YACF,KACA;UACN;QACF;QACA;MACF;IAEA;MAAS;QACP;MACF;EACF;EAEA,IAAIrC,WAAA,CAAYqB,KAAK,EAAE;IACrB,IACE,iBAAiBrB,WAAA,CAAYqB,KAAK,IAClC,OAAOrB,WAAA,CAAYqB,KAAK,EAAEgD,WAAA,KAAgB,YAC1C;MACAnE,UAAA,CAAWiC,gBAAgB,CAAC2C,WAAW,GAAG,CAACvE,QAAA,gBACzCkE,IAAA,CAACjF,gBAAA;QACC6E,WAAA,EAAarE,WAAA,CAAYqB,KAAK,EAAEgD,WAAA,CAAY;UAC1CrC,IAAA,EAAMf,GAAA,CAAIe,IAAI;UACd+C,CAAA,EAAG9D,GAAA,CAAIe,IAAI,CAAC+C;QACd;QACApE,IAAA,EAAMA;WAGR;IAEJ;IAEA,IAAIX,WAAA,CAAYqB,KAAK,EAAEC,UAAA,EAAY;MACjC,IAAI,gBAAgBtB,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;QAChDpB,UAAA,CAAWiC,gBAAgB,CAAC6C,UAAU,GAAG,CAACzE,QAAA,GACtChB,qBAAA,CAAsB;UACpB2C,WAAA;UACAe,SAAA,EAAWjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAAC2D,UAAU;UAClDhD,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;UAChCiB,GAAA,EAAK,qCAAqCvC,IAAA,EAAM;UAChD0B;QACF,KACA;MACN;MAEA,IAAI,iBAAiBrC,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;QACjDpB,UAAA,CAAWiC,gBAAgB,CAAC+C,WAAW,GAAG,CAAC3E,QAAA,GACvChB,qBAAA,CAAsB;UACpB2C,WAAA;UACAe,SAAA,EAAWjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAAC6D,WAAW;UACnDlD,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;UAChCiB,GAAA,EAAK,sCAAsCvC,IAAA,EAAM;UACjD0B;QACF,KACA;MACN;MAEA,IAAI,iBAAiBrC,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;QACjDpB,UAAA,CAAWiC,gBAAgB,CAAC2C,WAAW,GAAG,CAACvE,QAAA,GACvChB,qBAAA,CAAsB;UACpB2C,WAAA;UACAe,SAAA,EAAWjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAACwD,WAAW;UACnD7C,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;UAChCiB,GAAA,EAAK;UACLb;QACF,KACA;MACN;MAEA,IAAI,WAAWrC,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;QAC3CpB,UAAA,CAAWiC,gBAAgB,CAACoC,KAAK,GAAG,CAAChE,QAAA,GACjChB,qBAAA,CAAsB;UACpB2C,WAAA;UACAe,SAAA,EAAWjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAACiD,KAAK;UAC7CtC,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;UAChCiB,GAAA,EAAK;UACLb;QACF,KACA;MACN;MAEA,IAAI,WAAWrC,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;QAC3CpB,UAAA,CAAWiC,gBAAgB,CAAC8B,KAAK,GAAG,CAAC1D,QAAA,GACjChB,qBAAA,CAAsB;UACpB2C,WAAA;UACAe,SAAA,EAAWjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAAC2C,KAAK;UAC7ChC,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;UAChCiB,GAAA,EAAK;UACLb;QACF,KACA;MACN;MAEA,IAAI,WAAWrC,WAAA,CAAYqB,KAAK,CAACC,UAAU,EAAE;QAC3CpB,UAAA,CAAWiC,gBAAgB,CAACqC,KAAK,GAAG,CAACjE,QAAA,gBACnCkE,IAAA,CAAChF,cAAA;UAAekB,IAAA,EAAMA,IAAA;oBACnBpB,qBAAA,CAAsB;YACrB2C,WAAA;YACAe,SAAA,EAAWjD,WAAA,CAAYqB,KAAK,CAACC,UAAU,CAACkD,KAAK;YAC7CvC,SAAA,EAAWhB,GAAA,CAAIW,OAAO,CAACK,SAAS;YAChCiB,GAAA,EAAK;YACLb;UACF;aAGF;MAEJ;IACF;EACF;AACF","ignoreList":[]}
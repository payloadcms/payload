{"version":3,"file":"index.js","names":["useModal","getTranslation","useRouter","formatAdminURL","React","toast","Dots","useConfig","useFolder","useRouteCache","useRouteTransition","useTranslation","ConfirmationModal","useDocumentDrawer","Popup","PopupList","Translation","MoveItemsToFolderDrawer","moveToFolderDrawerSlug","confirmDeleteDrawerSlug","baseClass","CurrentFolderActions","className","router","startRouteTransition","breadcrumbs","currentFolder","folderCollectionConfig","folderCollectionSlug","folderFieldName","folderID","getFolderRoute","moveToFolder","FolderDocumentDrawer","closeDrawer","closeFolderDrawer","openDrawer","openFolderDrawer","id","collectionSlug","clearRouteCache","config","routes","closeModal","openModal","i18n","t","deleteCurrentFolder","useCallback","fetch","apiRoute","api","path","credentials","method","push","length","_jsxs","_Fragment","_jsx","button","filter","Boolean","join","render","ButtonGroup","Button","onClick","label","labels","singular","action","drawerSlug","folderAssignedCollections","value","folderType","fromFolderID","fromFolderName","_folderOrDocumentTitle","itemsToMove","onConfirm","name","toFolderID","success","folderName","title","body","elements","1","children","i18nKey","variables","confirmingLabel","heading","modalSlug","onSave"],"sources":["../../../../src/elements/FolderView/CurrentFolderActions/index.tsx"],"sourcesContent":["import { useModal } from '@faceless-ui/modal'\nimport { getTranslation } from '@payloadcms/translations'\nimport { useRouter } from 'next/navigation.js'\nimport { formatAdminURL } from 'payload/shared'\nimport React from 'react'\nimport { toast } from 'sonner'\n\nimport { Dots } from '../../../icons/Dots/index.js'\nimport { useConfig } from '../../../providers/Config/index.js'\nimport { useFolder } from '../../../providers/Folders/index.js'\nimport { useRouteCache } from '../../../providers/RouteCache/index.js'\nimport { useRouteTransition } from '../../../providers/RouteTransition/index.js'\nimport { useTranslation } from '../../../providers/Translation/index.js'\nimport { ConfirmationModal } from '../../ConfirmationModal/index.js'\nimport { useDocumentDrawer } from '../../DocumentDrawer/index.js'\nimport { Popup, PopupList } from '../../Popup/index.js'\nimport { Translation } from '../../Translation/index.js'\nimport { MoveItemsToFolderDrawer } from '../Drawers/MoveToFolder/index.js'\n\nconst moveToFolderDrawerSlug = 'move-to-folder--current-folder'\nconst confirmDeleteDrawerSlug = 'confirm-many-delete'\n\nconst baseClass = 'current-folder-actions'\n\ntype Props = {\n  className?: string\n}\nexport function CurrentFolderActions({ className }: Props) {\n  const router = useRouter()\n  const { startRouteTransition } = useRouteTransition()\n  const {\n    breadcrumbs,\n    currentFolder,\n    folderCollectionConfig,\n    folderCollectionSlug,\n    folderFieldName,\n    folderID,\n    getFolderRoute,\n    moveToFolder,\n  } = useFolder()\n  const [FolderDocumentDrawer, , { closeDrawer: closeFolderDrawer, openDrawer: openFolderDrawer }] =\n    useDocumentDrawer({\n      id: folderID,\n      collectionSlug: folderCollectionSlug,\n    })\n  const { clearRouteCache } = useRouteCache()\n  const { config } = useConfig()\n  const { routes } = config\n  const { closeModal, openModal } = useModal()\n  const { i18n, t } = useTranslation()\n\n  const deleteCurrentFolder = React.useCallback(async () => {\n    await fetch(\n      formatAdminURL({\n        apiRoute: routes.api,\n        path: `/${folderCollectionSlug}/${folderID}?depth=0`,\n      }),\n      {\n        credentials: 'include',\n        method: 'DELETE',\n      },\n    )\n    startRouteTransition(() => {\n      router.push(getFolderRoute(breadcrumbs[breadcrumbs.length - 2]?.id || null))\n    })\n  }, [\n    breadcrumbs,\n    folderCollectionSlug,\n    folderID,\n    getFolderRoute,\n    router,\n    routes.api,\n    startRouteTransition,\n  ])\n\n  if (!folderID) {\n    return null\n  }\n\n  return (\n    <>\n      <Popup\n        button={<Dots />}\n        className={[baseClass, className].filter(Boolean).join(' ')}\n        render={() => (\n          <PopupList.ButtonGroup>\n            <PopupList.Button\n              onClick={() => {\n                openFolderDrawer()\n              }}\n            >\n              {t('general:editLabel', {\n                label: getTranslation(folderCollectionConfig.labels.singular, i18n),\n              })}\n            </PopupList.Button>\n            <PopupList.Button\n              onClick={() => {\n                openModal(moveToFolderDrawerSlug)\n              }}\n            >\n              {t('folder:moveFolder')}\n            </PopupList.Button>\n            <PopupList.Button\n              onClick={() => {\n                openModal(confirmDeleteDrawerSlug)\n              }}\n            >\n              {t('folder:deleteFolder')}\n            </PopupList.Button>\n          </PopupList.ButtonGroup>\n        )}\n      />\n      <MoveItemsToFolderDrawer\n        action=\"moveItemToFolder\"\n        drawerSlug={moveToFolderDrawerSlug}\n        folderAssignedCollections={currentFolder?.value.folderType}\n        folderCollectionSlug={folderCollectionSlug}\n        folderFieldName={folderFieldName}\n        fromFolderID={currentFolder?.value.id}\n        fromFolderName={currentFolder?.value._folderOrDocumentTitle}\n        itemsToMove={[currentFolder]}\n        onConfirm={async ({ id, name }) => {\n          await moveToFolder({\n            itemsToMove: [currentFolder],\n            toFolderID: id,\n          })\n          if (id) {\n            // moved to folder\n            toast.success(\n              t('folder:itemHasBeenMoved', {\n                folderName: `\"${name}\"`,\n                title: currentFolder.value._folderOrDocumentTitle,\n              }),\n            )\n          } else {\n            // moved to root\n            toast.success(\n              t('folder:itemHasBeenMovedToRoot', {\n                title: currentFolder.value._folderOrDocumentTitle,\n              }),\n            )\n          }\n          closeModal(moveToFolderDrawerSlug)\n        }}\n        title={currentFolder.value._folderOrDocumentTitle}\n      />\n\n      <ConfirmationModal\n        body={\n          <Translation\n            elements={{\n              '1': ({ children }) => <strong>{children}</strong>,\n            }}\n            i18nKey=\"general:aboutToDelete\"\n            t={t}\n            variables={{\n              label: getTranslation(folderCollectionConfig.labels.singular, i18n),\n              title: currentFolder.value._folderOrDocumentTitle,\n            }}\n          />\n        }\n        confirmingLabel={t('general:deleting')}\n        heading={t('general:confirmDeletion')}\n        modalSlug={confirmDeleteDrawerSlug}\n        onConfirm={deleteCurrentFolder}\n      />\n\n      <FolderDocumentDrawer\n        onSave={() => {\n          closeFolderDrawer()\n          clearRouteCache()\n        }}\n      />\n    </>\n  )\n}\n"],"mappings":"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","ignoreList":[]}
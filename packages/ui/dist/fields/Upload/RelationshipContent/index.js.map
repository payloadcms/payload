{"version":3,"file":"index.js","names":["c","_c","getTranslation","formatFilesize","React","Button","useDocumentDrawer","Pill","ThumbnailComponent","useConfig","useTranslation","baseClass","RelationshipContent","props","$","id","allowEdit","allowRemove","alt","byteSize","className","collectionSlug","displayPreview","filename","mimeType","onRemove","reloadDoc","showCollectionSlug","t0","src","thumbnailSrc","updatedAt","withMeta","t1","x","y","undefined","config","i18n","collectionConfig","collections","find","collection","slug","t2","t3","DocumentDrawer","t4","openDrawer","t5","t6","doc","onSave","generateMetaText","mimeType_0","size","sections","push","join","metaText","previewAllowed","upload","t7","filter","Boolean","_jsxs","children","_jsx","fileSrc","imageCacheTag","cacheTags","labels","singular","href","target","buttonStyle","icon","iconStyle","onClick"],"sources":["../../../../src/fields/Upload/RelationshipContent/index.tsx"],"sourcesContent":["'use client'\n\nimport type { TypeWithID } from 'payload'\n\nimport { getTranslation } from '@payloadcms/translations'\nimport { formatFilesize } from 'payload/shared'\nimport React from 'react'\n\nimport type { ReloadDoc } from '../types.js'\n\nimport { Button } from '../../../elements/Button/index.js'\nimport { useDocumentDrawer } from '../../../elements/DocumentDrawer/index.js'\nimport { Pill } from '../../../elements/Pill/index.js'\nimport { ThumbnailComponent } from '../../../elements/Thumbnail/index.js'\nimport './index.scss'\nimport { useConfig } from '../../../providers/Config/index.js'\nimport { useTranslation } from '../../../providers/Translation/index.js'\n\nconst baseClass = 'upload-relationship-details'\n\ntype Props = {\n  readonly allowEdit?: boolean\n  readonly allowRemove?: boolean\n  readonly alt: string\n  readonly byteSize: number\n  readonly className?: string\n  readonly collectionSlug: string\n  readonly displayPreview?: boolean\n  readonly filename: string\n  readonly id?: number | string\n  readonly mimeType: string\n  readonly onRemove: () => void\n  readonly reloadDoc: ReloadDoc\n  readonly showCollectionSlug?: boolean\n  readonly src: string\n  readonly thumbnailSrc: string\n  readonly updatedAt?: string\n  readonly withMeta?: boolean\n  readonly x?: number\n  readonly y?: number\n}\nexport function RelationshipContent(props: Props) {\n  const {\n    id,\n    allowEdit,\n    allowRemove,\n    alt,\n    byteSize,\n    className,\n    collectionSlug,\n    displayPreview,\n    filename,\n    mimeType,\n    onRemove,\n    reloadDoc,\n    showCollectionSlug = false,\n    src,\n    thumbnailSrc,\n    updatedAt,\n    withMeta = true,\n    x,\n    y,\n  } = props\n\n  const { config } = useConfig()\n  const { i18n } = useTranslation()\n  const collectionConfig =\n    'collections' in config\n      ? config.collections.find((collection) => collection.slug === collectionSlug)\n      : undefined\n\n  const [DocumentDrawer, _, { openDrawer }] = useDocumentDrawer({\n    id: id ?? undefined,\n    collectionSlug,\n  })\n\n  const onSave = React.useCallback(\n    async ({ doc }: { doc: TypeWithID }) => reloadDoc(doc.id, collectionSlug),\n    [reloadDoc, collectionSlug],\n  )\n\n  function generateMetaText(mimeType: string, size: number): string {\n    const sections: string[] = []\n    if (size) {\n      sections.push(formatFilesize(size))\n    }\n\n    if (x && y) {\n      sections.push(`${x}x${y}`)\n    }\n\n    if (mimeType) {\n      sections.push(mimeType)\n    }\n\n    return sections.join(' â€” ')\n  }\n\n  const metaText = withMeta ? generateMetaText(mimeType, byteSize) : ''\n  const previewAllowed = displayPreview ?? collectionConfig?.upload?.displayPreview ?? true\n\n  return (\n    <div className={[baseClass, className].filter(Boolean).join(' ')}>\n      <div className={`${baseClass}__imageAndDetails`}>\n        {previewAllowed && (\n          <ThumbnailComponent\n            alt={alt}\n            className={`${baseClass}__thumbnail`}\n            filename={filename}\n            fileSrc={thumbnailSrc}\n            imageCacheTag={collectionConfig?.upload?.cacheTags && updatedAt}\n            size=\"small\"\n          />\n        )}\n        {showCollectionSlug && collectionConfig ? (\n          <Pill size=\"small\">{getTranslation(collectionConfig.labels.singular, i18n)}</Pill>\n        ) : null}\n        <div className={`${baseClass}__details`}>\n          <p className={`${baseClass}__filename`}>\n            {src ? (\n              <a href={src} target=\"_blank\">\n                {filename}\n              </a>\n            ) : (\n              filename\n            )}\n          </p>\n          {withMeta ? <p className={`${baseClass}__meta`}>{metaText}</p> : null}\n        </div>\n      </div>\n\n      {allowEdit !== false || allowRemove !== false ? (\n        <div className={`${baseClass}__actions`}>\n          {allowEdit !== false ? (\n            <Button\n              buttonStyle=\"icon-label\"\n              className={`${baseClass}__edit`}\n              icon=\"edit\"\n              iconStyle=\"none\"\n              onClick={openDrawer}\n            />\n          ) : null}\n          {allowRemove !== false ? (\n            <Button\n              buttonStyle=\"icon-label\"\n              className={`${baseClass}__remove`}\n              icon=\"x\"\n              iconStyle=\"none\"\n              onClick={() => onRemove()}\n            />\n          ) : null}\n          <DocumentDrawer onSave={onSave} />\n        </div>\n      ) : null}\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"index.js","names":["getBestFitFromSizes","isImage","React","RelationshipContent","UploadCard","baseClass","UploadComponentHasOne","props","className","displayPreview","fileDoc","onRemove","readonly","reloadDoc","serverURL","showCollectionSlug","relationTo","value","id","String","src","thumbnailSrc","url","URL","toString","thumbnailURL","mimeType","sizes","width","_jsx","filter","Boolean","join","allowEdit","allowRemove","alt","filename","byteSize","filesize","collectionSlug","updatedAt","x","y","height"],"sources":["../../../../src/fields/Upload/HasOne/index.tsx"],"sourcesContent":["'use client'\n\nimport type { JsonObject } from 'payload'\n\nimport { getBestFitFromSizes, isImage } from 'payload/shared'\nimport React from 'react'\n\nimport type { ReloadDoc } from '../types.js'\n\nimport './index.scss'\nimport { RelationshipContent } from '../RelationshipContent/index.js'\nimport { UploadCard } from '../UploadCard/index.js'\n\nconst baseClass = 'upload upload--has-one'\n\ntype Props = {\n  readonly className?: string\n  readonly displayPreview?: boolean\n  readonly fileDoc: {\n    relationTo: string\n    value: JsonObject\n  }\n  readonly onRemove?: () => void\n  readonly readonly?: boolean\n  readonly reloadDoc: ReloadDoc\n  readonly serverURL: string\n  readonly showCollectionSlug?: boolean\n}\n\nexport function UploadComponentHasOne(props: Props) {\n  const {\n    className,\n    displayPreview,\n    fileDoc,\n    onRemove,\n    readonly,\n    reloadDoc,\n    serverURL,\n    showCollectionSlug = false,\n  } = props\n  const { relationTo, value } = fileDoc\n  const id = String(value?.id)\n\n  let src: string\n  let thumbnailSrc: string\n\n  if (value.url) {\n    try {\n      src = new URL(value.url, serverURL).toString()\n    } catch {\n      src = `${serverURL}${value.url}`\n    }\n  }\n\n  if (value.thumbnailURL) {\n    try {\n      thumbnailSrc = new URL(value.thumbnailURL, serverURL).toString()\n    } catch {\n      thumbnailSrc = `${serverURL}${value.thumbnailURL}`\n    }\n  }\n\n  if (isImage(value.mimeType)) {\n    thumbnailSrc = getBestFitFromSizes({\n      sizes: value.sizes,\n      thumbnailURL: thumbnailSrc,\n      url: src,\n      width: value.width,\n    })\n  }\n\n  return (\n    <UploadCard className={[baseClass, className].filter(Boolean).join(' ')}>\n      <RelationshipContent\n        allowEdit={!readonly}\n        allowRemove={!readonly}\n        alt={(value?.alt || value?.filename) as string}\n        byteSize={value.filesize as number}\n        collectionSlug={relationTo}\n        displayPreview={displayPreview}\n        filename={value.filename as string}\n        id={id}\n        mimeType={value?.mimeType as string}\n        onRemove={onRemove}\n        reloadDoc={reloadDoc}\n        showCollectionSlug={showCollectionSlug}\n        src={src}\n        thumbnailSrc={thumbnailSrc}\n        updatedAt={value.updatedAt}\n        x={value?.width as number}\n        y={value?.height as number}\n      />\n    </UploadCard>\n  )\n}\n"],"mappings":"AAAA;;;AAIA,SAASA,mBAAmB,EAAEC,OAAO,QAAQ;AAC7C,OAAOC,KAAA,MAAW;AAIlB,OAAO;AACP,SAASC,mBAAmB,QAAQ;AACpC,SAASC,UAAU,QAAQ;AAE3B,MAAMC,SAAA,GAAY;AAgBlB,OAAO,SAASC,sBAAsBC,KAAY;EAChD,MAAM;IACJC,SAAS;IACTC,cAAc;IACdC,OAAO;IACPC,QAAQ;IACRC,QAAQ;IACRC,SAAS;IACTC,SAAS;IACTC,kBAAA,GAAqB;EAAK,CAC3B,GAAGR,KAAA;EACJ,MAAM;IAAES,UAAU;IAAEC;EAAK,CAAE,GAAGP,OAAA;EAC9B,MAAMQ,EAAA,GAAKC,MAAA,CAAOF,KAAA,EAAOC,EAAA;EAEzB,IAAIE,GAAA;EACJ,IAAIC,YAAA;EAEJ,IAAIJ,KAAA,CAAMK,GAAG,EAAE;IACb,IAAI;MACFF,GAAA,GAAM,IAAIG,GAAA,CAAIN,KAAA,CAAMK,GAAG,EAAER,SAAA,EAAWU,QAAQ;IAC9C,EAAE,MAAM;MACNJ,GAAA,GAAM,GAAGN,SAAA,GAAYG,KAAA,CAAMK,GAAG,EAAE;IAClC;EACF;EAEA,IAAIL,KAAA,CAAMQ,YAAY,EAAE;IACtB,IAAI;MACFJ,YAAA,GAAe,IAAIE,GAAA,CAAIN,KAAA,CAAMQ,YAAY,EAAEX,SAAA,EAAWU,QAAQ;IAChE,EAAE,MAAM;MACNH,YAAA,GAAe,GAAGP,SAAA,GAAYG,KAAA,CAAMQ,YAAY,EAAE;IACpD;EACF;EAEA,IAAIxB,OAAA,CAAQgB,KAAA,CAAMS,QAAQ,GAAG;IAC3BL,YAAA,GAAerB,mBAAA,CAAoB;MACjC2B,KAAA,EAAOV,KAAA,CAAMU,KAAK;MAClBF,YAAA,EAAcJ,YAAA;MACdC,GAAA,EAAKF,GAAA;MACLQ,KAAA,EAAOX,KAAA,CAAMW;IACf;EACF;EAEA,oBACEC,IAAA,CAACzB,UAAA;IAAWI,SAAA,EAAW,CAACH,SAAA,EAAWG,SAAA,CAAU,CAACsB,MAAM,CAACC,OAAA,EAASC,IAAI,CAAC;cACjE,aAAAH,IAAA,CAAC1B,mBAAA;MACC8B,SAAA,EAAW,CAACrB,QAAA;MACZsB,WAAA,EAAa,CAACtB,QAAA;MACduB,GAAA,EAAMlB,KAAA,EAAOkB,GAAA,IAAOlB,KAAA,EAAOmB,QAAA;MAC3BC,QAAA,EAAUpB,KAAA,CAAMqB,QAAQ;MACxBC,cAAA,EAAgBvB,UAAA;MAChBP,cAAA,EAAgBA,cAAA;MAChB2B,QAAA,EAAUnB,KAAA,CAAMmB,QAAQ;MACxBlB,EAAA,EAAIA,EAAA;MACJQ,QAAA,EAAUT,KAAA,EAAOS,QAAA;MACjBf,QAAA,EAAUA,QAAA;MACVE,SAAA,EAAWA,SAAA;MACXE,kBAAA,EAAoBA,kBAAA;MACpBK,GAAA,EAAKA,GAAA;MACLC,YAAA,EAAcA,YAAA;MACdmB,SAAA,EAAWvB,KAAA,CAAMuB,SAAS;MAC1BC,CAAA,EAAGxB,KAAA,EAAOW,KAAA;MACVc,CAAA,EAAGzB,KAAA,EAAO0B;;;AAIlB","ignoreList":[]}
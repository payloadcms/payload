{"version":3,"file":"index.js","names":["getTranslation","React","Fragment","useCallback","useId","useMemo","toast","Banner","Button","clipboardCopy","clipboardPaste","ClipboardAction","mergeFormStateFromClipboard","reduceFormStateByPath","DraggableSortableItem","DraggableSortable","ErrorPill","RenderCustomComponent","FieldDescription","FieldError","FieldLabel","useForm","useFormSubmitted","extractRowsAndCollapsedIDs","toggleAllRows","NullifyLocaleField","useField","withCondition","useConfig","useDocumentInfo","useLocale","useTranslation","scrollToID","mergeFieldStyles","fieldBaseClass","ArrayRow","baseClass","ArrayFieldComponent","props","field","name","type","admin","className","description","isSortable","fields","label","localized","maxRows","minRows","minRowsProp","required","forceRender","path","pathFromProps","permissions","readOnly","schemaPath","schemaPathFromProps","validate","setDocFieldPreferences","addFieldRow","dispatchFields","getFields","moveFieldRow","removeFieldRow","replaceState","setModified","submitted","code","locale","i18n","t","config","localization","editingDefaultLocale","fallback","defaultLocale","getLabels","p","labels","plural","singular","undefined","memoizedValidate","value","options","customComponents","AfterInput","BeforeInput","Description","Error","Label","disabled","errorPaths","rows","showError","valid","hasRows","potentiallyStalePath","componentId","scrollIdPrefix","addRow","rowIndex","setTimeout","duplicateRow","removeRow","moveRow","moveFromIndex","moveToIndex","toggleCollapseAll","collapsed","collapsedIDs","updatedRows","setCollapse","rowID","copyRow","formState","clipboardResult","getDataToCopy","error","success","pasteRow","pasteArgs","onPaste","dataFromClipboard","newState","schemaFields","pasteField","hasMaxRows","length","fieldErrorCount","fieldHasErrors","showRequired","showMinRows","styles","_jsxs","filter","Boolean","join","id","replace","style","_jsx","CustomComponent","Fallback","as","count","withMessage","onClick","allowCopy","allowPaste","fieldValue","ids","map","row","onDragEnd","rowData","i","isLoading","rowPath","rowErrorCount","errorPath","startsWith","draggableSortableItemProps","CustomRowLabel","RowLabel","errorCount","parentPath","rowCount","buttonStyle","icon","iconPosition","iconStyle","ArrayField"],"sources":["../../../src/fields/Array/index.tsx"],"sourcesContent":["'use client'\nimport type {\n  ArrayFieldClientComponent,\n  ArrayFieldClientProps,\n  ArrayField as ArrayFieldType,\n} from 'payload'\n\nimport { getTranslation } from '@payloadcms/translations'\nimport React, { Fragment, useCallback, useId, useMemo } from 'react'\nimport { toast } from 'sonner'\n\nimport type { ClipboardPasteData } from '../../elements/ClipboardAction/types.js'\n\nimport { Banner } from '../../elements/Banner/index.js'\nimport { Button } from '../../elements/Button/index.js'\nimport { clipboardCopy, clipboardPaste } from '../../elements/ClipboardAction/clipboardUtilities.js'\nimport { ClipboardAction } from '../../elements/ClipboardAction/index.js'\nimport {\n  mergeFormStateFromClipboard,\n  reduceFormStateByPath,\n} from '../../elements/ClipboardAction/mergeFormStateFromClipboard.js'\nimport { DraggableSortableItem } from '../../elements/DraggableSortable/DraggableSortableItem/index.js'\nimport { DraggableSortable } from '../../elements/DraggableSortable/index.js'\nimport { ErrorPill } from '../../elements/ErrorPill/index.js'\nimport { RenderCustomComponent } from '../../elements/RenderCustomComponent/index.js'\nimport { FieldDescription } from '../../fields/FieldDescription/index.js'\nimport { FieldError } from '../../fields/FieldError/index.js'\nimport { FieldLabel } from '../../fields/FieldLabel/index.js'\nimport { useForm, useFormSubmitted } from '../../forms/Form/context.js'\nimport { extractRowsAndCollapsedIDs, toggleAllRows } from '../../forms/Form/rowHelpers.js'\nimport { NullifyLocaleField } from '../../forms/NullifyField/index.js'\nimport { useField } from '../../forms/useField/index.js'\nimport { withCondition } from '../../forms/withCondition/index.js'\nimport { useConfig } from '../../providers/Config/index.js'\nimport { useDocumentInfo } from '../../providers/DocumentInfo/index.js'\nimport { useLocale } from '../../providers/Locale/index.js'\nimport { useTranslation } from '../../providers/Translation/index.js'\nimport { scrollToID } from '../../utilities/scrollToID.js'\nimport { mergeFieldStyles } from '../mergeFieldStyles.js'\nimport { fieldBaseClass } from '../shared/index.js'\nimport { ArrayRow } from './ArrayRow.js'\nimport './index.scss'\n\nconst baseClass = 'array-field'\n\nexport const ArrayFieldComponent: ArrayFieldClientComponent = (props) => {\n  const {\n    field,\n    field: {\n      name,\n      type,\n      admin: { className, description, isSortable = true } = {},\n      fields,\n      label,\n      localized,\n      maxRows,\n      minRows: minRowsProp,\n      required,\n    },\n    forceRender = false,\n    path: pathFromProps,\n    permissions,\n    readOnly,\n    schemaPath: schemaPathFromProps,\n    validate,\n  } = props\n\n  const schemaPath = schemaPathFromProps ?? name\n\n  const minRows = minRowsProp ?? (required ? 1 : 0)\n\n  const { setDocFieldPreferences } = useDocumentInfo()\n  const {\n    addFieldRow,\n    dispatchFields,\n    getFields,\n    moveFieldRow,\n    removeFieldRow,\n    replaceState,\n    setModified,\n  } = useForm()\n  const submitted = useFormSubmitted()\n  const { code: locale } = useLocale()\n  const { i18n, t } = useTranslation()\n\n  const {\n    config: { localization },\n  } = useConfig()\n\n  const editingDefaultLocale = (() => {\n    if (localization && localization.fallback) {\n      const defaultLocale = localization.defaultLocale\n      return locale === defaultLocale\n    }\n\n    return true\n  })()\n\n  // Handle labeling for Arrays, Global Arrays, and Blocks\n  const getLabels = (p: ArrayFieldClientProps): Partial<ArrayFieldType['labels']> => {\n    if ('labels' in p && p?.labels) {\n      return p.labels\n    }\n\n    if ('labels' in p.field && p.field.labels) {\n      return { plural: p.field.labels?.plural, singular: p.field.labels?.singular }\n    }\n\n    if ('label' in p.field && p.field.label) {\n      return { plural: undefined, singular: p.field.label }\n    }\n\n    return { plural: t('general:rows'), singular: t('general:row') }\n  }\n\n  const labels = getLabels(props)\n\n  const memoizedValidate = useCallback(\n    (value, options) => {\n      // alternative locales can be null\n      if (!editingDefaultLocale && value === null) {\n        return true\n      }\n\n      if (typeof validate === 'function') {\n        return validate(value, { ...options, maxRows, minRows, required })\n      }\n    },\n    [maxRows, minRows, required, validate, editingDefaultLocale],\n  )\n\n  const {\n    customComponents: { AfterInput, BeforeInput, Description, Error, Label } = {},\n    disabled,\n    errorPaths,\n    path,\n    rows = [],\n    showError,\n    valid,\n    value,\n  } = useField<number>({\n    hasRows: true,\n    potentiallyStalePath: pathFromProps,\n    validate: memoizedValidate,\n  })\n\n  const componentId = useId()\n  const scrollIdPrefix = useMemo(() => `scroll-${componentId}`, [componentId])\n\n  const addRow = useCallback(\n    (rowIndex: number) => {\n      addFieldRow({\n        path,\n        rowIndex,\n        schemaPath,\n      })\n\n      setTimeout(() => {\n        scrollToID(`${scrollIdPrefix}-row-${rowIndex}`)\n      }, 0)\n    },\n    [addFieldRow, path, schemaPath, scrollIdPrefix],\n  )\n\n  const duplicateRow = useCallback(\n    (rowIndex: number) => {\n      dispatchFields({ type: 'DUPLICATE_ROW', path, rowIndex })\n\n      setModified(true)\n\n      setTimeout(() => {\n        scrollToID(`${scrollIdPrefix}-row-${rowIndex}`)\n      }, 0)\n    },\n    [dispatchFields, path, scrollIdPrefix, setModified],\n  )\n\n  const removeRow = useCallback(\n    (rowIndex: number) => {\n      removeFieldRow({ path, rowIndex })\n    },\n    [removeFieldRow, path],\n  )\n\n  const moveRow = useCallback(\n    (moveFromIndex: number, moveToIndex: number) => {\n      moveFieldRow({\n        moveFromIndex,\n        moveToIndex,\n        path,\n      })\n    },\n    [path, moveFieldRow],\n  )\n\n  const toggleCollapseAll = useCallback(\n    (collapsed: boolean) => {\n      const { collapsedIDs, updatedRows } = toggleAllRows({\n        collapsed,\n        rows,\n      })\n      setDocFieldPreferences(path, { collapsed: collapsedIDs })\n      dispatchFields({ type: 'SET_ALL_ROWS_COLLAPSED', path, updatedRows })\n    },\n    [dispatchFields, path, rows, setDocFieldPreferences],\n  )\n\n  const setCollapse = useCallback(\n    (rowID: string, collapsed: boolean) => {\n      const { collapsedIDs, updatedRows } = extractRowsAndCollapsedIDs({\n        collapsed,\n        rowID,\n        rows,\n      })\n\n      dispatchFields({ type: 'SET_ROW_COLLAPSED', path, updatedRows })\n      setDocFieldPreferences(path, { collapsed: collapsedIDs })\n    },\n    [dispatchFields, path, rows, setDocFieldPreferences],\n  )\n\n  const copyRow = useCallback(\n    (rowIndex: number) => {\n      const formState = { ...getFields() }\n      const clipboardResult = clipboardCopy({\n        type,\n        fields,\n        getDataToCopy: () =>\n          reduceFormStateByPath({\n            formState,\n            path,\n            rowIndex,\n          }),\n        path,\n        rowIndex,\n        t,\n      })\n\n      if (typeof clipboardResult === 'string') {\n        toast.error(clipboardResult)\n      } else {\n        toast.success(t('general:copied'))\n      }\n    },\n    [fields, getFields, path, t, type],\n  )\n\n  const pasteRow = useCallback(\n    (rowIndex: number) => {\n      const formState = { ...getFields() }\n      const pasteArgs = {\n        onPaste: (dataFromClipboard: ClipboardPasteData) => {\n          const newState = mergeFormStateFromClipboard({\n            dataFromClipboard,\n            formState,\n            path,\n            rowIndex,\n          })\n          replaceState(newState)\n          setModified(true)\n        },\n        path,\n        schemaFields: fields,\n        t,\n      }\n\n      const clipboardResult = clipboardPaste(pasteArgs)\n\n      if (typeof clipboardResult === 'string') {\n        toast.error(clipboardResult)\n      }\n    },\n    [fields, getFields, path, replaceState, setModified, t],\n  )\n\n  const pasteField = useCallback(\n    (dataFromClipboard: ClipboardPasteData) => {\n      const formState = { ...getFields() }\n      const newState = mergeFormStateFromClipboard({\n        dataFromClipboard,\n        formState,\n        path,\n      })\n      replaceState(newState)\n      setModified(true)\n    },\n    [getFields, path, replaceState, setModified],\n  )\n\n  const getDataToCopy = useCallback(\n    () =>\n      reduceFormStateByPath({\n        formState: { ...getFields() },\n        path,\n      }),\n    [getFields, path],\n  )\n\n  const hasMaxRows = maxRows && rows.length >= maxRows\n\n  const fieldErrorCount = errorPaths.length\n  const fieldHasErrors = submitted && errorPaths.length > 0\n\n  const showRequired = (readOnly || disabled) && rows.length === 0\n  const showMinRows = (rows.length && rows.length < minRows) || (required && rows.length === 0)\n\n  const styles = useMemo(() => mergeFieldStyles(field), [field])\n\n  return (\n    <div\n      className={[\n        fieldBaseClass,\n        baseClass,\n        className,\n        fieldHasErrors ? `${baseClass}--has-error` : `${baseClass}--has-no-error`,\n      ]\n        .filter(Boolean)\n        .join(' ')}\n      id={`field-${path.replace(/\\./g, '__')}`}\n      style={styles}\n    >\n      {showError && (\n        <RenderCustomComponent\n          CustomComponent={Error}\n          Fallback={<FieldError path={path} showError={showError} />}\n        />\n      )}\n      <header className={`${baseClass}__header`}>\n        <div className={`${baseClass}__header-wrap`}>\n          <div className={`${baseClass}__header-content`}>\n            <h3 className={`${baseClass}__title`}>\n              <RenderCustomComponent\n                CustomComponent={Label}\n                Fallback={\n                  <FieldLabel\n                    as=\"span\"\n                    label={label}\n                    localized={localized}\n                    path={path}\n                    required={required}\n                  />\n                }\n              />\n            </h3>\n            {fieldHasErrors && fieldErrorCount > 0 && (\n              <ErrorPill count={fieldErrorCount} i18n={i18n} withMessage />\n            )}\n          </div>\n          <ul className={`${baseClass}__header-actions`}>\n            {rows?.length > 0 && (\n              <Fragment>\n                <li>\n                  <button\n                    className={`${baseClass}__header-action`}\n                    onClick={() => toggleCollapseAll(true)}\n                    type=\"button\"\n                  >\n                    {t('fields:collapseAll')}\n                  </button>\n                </li>\n                <li>\n                  <button\n                    className={`${baseClass}__header-action`}\n                    onClick={() => toggleCollapseAll(false)}\n                    type=\"button\"\n                  >\n                    {t('fields:showAll')}\n                  </button>\n                </li>\n              </Fragment>\n            )}\n            <li>\n              <ClipboardAction\n                allowCopy={rows?.length > 0}\n                allowPaste={!readOnly}\n                className={`${baseClass}__header-action`}\n                disabled={disabled}\n                fields={fields}\n                getDataToCopy={getDataToCopy}\n                onPaste={pasteField}\n                path={path}\n                type={type}\n              />\n            </li>\n          </ul>\n        </div>\n        <RenderCustomComponent\n          CustomComponent={Description}\n          Fallback={<FieldDescription description={description} path={path} />}\n        />\n      </header>\n      <NullifyLocaleField\n        fieldValue={value}\n        localized={localized}\n        path={path}\n        readOnly={readOnly}\n      />\n      {BeforeInput}\n      {(rows?.length > 0 || (!valid && (showRequired || showMinRows))) && (\n        <DraggableSortable\n          className={`${baseClass}__draggable-rows`}\n          ids={rows.map((row) => row.id)}\n          onDragEnd={({ moveFromIndex, moveToIndex }) => moveRow(moveFromIndex, moveToIndex)}\n        >\n          {rows.map((rowData, i) => {\n            const { id: rowID, isLoading } = rowData\n\n            const rowPath = `${path}.${i}`\n\n            const rowErrorCount = errorPaths?.filter((errorPath) =>\n              errorPath.startsWith(rowPath + '.'),\n            ).length\n\n            return (\n              <DraggableSortableItem\n                disabled={readOnly || disabled || !isSortable}\n                id={rowID}\n                key={rowID}\n              >\n                {(draggableSortableItemProps) => (\n                  <ArrayRow\n                    {...draggableSortableItemProps}\n                    addRow={addRow}\n                    copyRow={copyRow}\n                    CustomRowLabel={rows?.[i]?.customComponents?.RowLabel}\n                    duplicateRow={duplicateRow}\n                    errorCount={rowErrorCount}\n                    fields={fields}\n                    forceRender={forceRender}\n                    hasMaxRows={hasMaxRows}\n                    isLoading={isLoading}\n                    isSortable={isSortable}\n                    labels={labels}\n                    moveRow={moveRow}\n                    parentPath={path}\n                    pasteRow={pasteRow}\n                    path={rowPath}\n                    permissions={permissions}\n                    readOnly={readOnly || disabled}\n                    removeRow={removeRow}\n                    row={rowData}\n                    rowCount={rows?.length}\n                    rowIndex={i}\n                    schemaPath={schemaPath}\n                    scrollIdPrefix={scrollIdPrefix}\n                    setCollapse={setCollapse}\n                  />\n                )}\n              </DraggableSortableItem>\n            )\n          })}\n          {!valid && (\n            <React.Fragment>\n              {showRequired && (\n                <Banner>\n                  {t('validation:fieldHasNo', { label: getTranslation(labels.plural, i18n) })}\n                </Banner>\n              )}\n              {showMinRows && (\n                <Banner type=\"error\">\n                  {t('validation:requiresAtLeast', {\n                    count: minRows,\n                    label:\n                      getTranslation(minRows > 1 ? labels.plural : labels.singular, i18n) ||\n                      t(minRows > 1 ? 'general:rows' : 'general:row'),\n                  })}\n                </Banner>\n              )}\n            </React.Fragment>\n          )}\n        </DraggableSortable>\n      )}\n      {!hasMaxRows && !readOnly && (\n        <Button\n          buttonStyle=\"icon-label\"\n          className={`${baseClass}__add-row`}\n          disabled={disabled}\n          icon=\"plus\"\n          iconPosition=\"left\"\n          iconStyle=\"with-border\"\n          onClick={() => {\n            void addRow(value || 0)\n          }}\n        >\n          {t('fields:addLabel', { label: getTranslation(labels.singular, i18n) })}\n        </Button>\n      )}\n      {AfterInput}\n    </div>\n  )\n}\n\nexport const ArrayField = withCondition(ArrayFieldComponent)\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"Input.js","names":["dequal","formatAdminURL","wordBoundariesRegex","qs","React","useCallback","useEffect","useMemo","useReducer","useRef","useState","AddNewRelation","useDocumentDrawer","useListDrawer","ReactSelect","RenderCustomComponent","FieldDescription","FieldError","FieldLabel","useDebouncedCallback","useEffectEvent","useQueue","useAuth","useConfig","useDocumentEvents","useLocale","useTranslation","sanitizeFilterOptionsQuery","fieldBaseClass","createRelationMap","findOptionsByValue","optionsReducer","MultiValueLabel","SingleValue","baseClass","RelationshipInput","props","AfterInput","allowCreate","allowEdit","appearance","BeforeInput","className","description","Description","Error","filterOptions","formatDisplayedOptions","hasMany","initialValue","isSortable","label","Label","localized","maxResultsPerRequest","onChange","path","placeholder","readOnly","relationTo","required","showError","sortOptions","style","value","config","getEntityConfig","routes","api","serverURL","i18n","t","permissions","code","locale","currentlyOpenRelationship","setCurrentlyOpenRelationship","id","undefined","collectionSlug","hasReadPermission","lastFullyLoadedRelation","setLastFullyLoadedRelation","lastLoadedPage","setLastLoadedPage","errorLoading","setErrorLoading","search","setSearch","isLoading","setIsLoading","enableWordBoundarySearch","setEnableWordBoundarySearch","menuIsOpen","setMenuIsOpen","hasLoadedFirstPageRef","queueTask","options","dispatchOptions","valueRef","DocumentDrawer","drawerSlug","isDrawerOpen","openDrawer","listDrawerFilterOptions","newFilterOptions","valuesByRelation","reduce","acc","val","push","Array","isArray","forEach","relation","not_in","ListDrawer","closeDrawer","closeListDrawer","isListDrawerOpen","openListDrawer","collectionSlugs","onListSelect","doc","openDrawerWhenRelationChanges","updateResults","hasManyArg","lastFullyLoadedRelationArg","lastLoadedPageArg","onSuccess","searchArg","sort","valueArg","lastFullyLoadedRelationToUse","relations","relationsToFetch","slice","resultsFetched","relationMap","priorRelation","relationFilterOption","lastLoadedPageToUse","indexOf","Promise","resolve","collection","fieldToSearch","admin","useAsTitle","fieldToSort","defaultSort","query","depth","draft","limit","page","select","where","and","like","response","fetch","apiRoute","body","stringify","credentials","headers","language","method","ok","data","json","prevState","nextPage","docs","length","type","status","ids","updateSearch","updateResultsEffectEvent","handleInputChange","handleValueChange","Object","entries","idsToLoad","filter","find","optionGroup","option","fieldToSelect","in","mostRecentUpdate","handleDocumentUpdateEvent","docID","isMatchingUpdate","operation","currentValue","some","entitySlug","collectionConfig","valuesToSet","map","onDuplicate","args","concat","slug","onDelete","filterOption","item","searchFilter","r","breakApartThreshold","labelString","String","indexOfSpace","test","onDocumentOpen","openInNewTab","docUrl","adminRoute","window","open","current","exemptValues","prevValue","isFirstRenderRef","isIdOnly","idOnly","valueToRender","_jsxs","Boolean","join","replace","_jsx","CustomComponent","Fallback","backspaceRemovesValue","components","DropdownIndicator","customProps","disableKeyDown","disableMouseDown","disabled","getOptionValue","isMulti","isSearchable","selected","onInputChange","newSearch","onMenuClose","onMenuOpen","onMenuScrollToBottom","enableRowSelections","onSelect"],"sources":["../../../src/fields/Relationship/Input.tsx"],"sourcesContent":["'use client'\nimport type {\n  DocumentEvent,\n  FilterOptionsResult,\n  PaginatedDocs,\n  ValueWithRelation,\n  Where,\n} from 'payload'\n\nimport { dequal } from 'dequal/lite'\nimport { formatAdminURL, wordBoundariesRegex } from 'payload/shared'\nimport * as qs from 'qs-esm'\nimport React, { useCallback, useEffect, useMemo, useReducer, useRef, useState } from 'react'\n\nimport type { DocumentDrawerProps } from '../../elements/DocumentDrawer/types.js'\nimport type { ListDrawerProps } from '../../elements/ListDrawer/types.js'\nimport type { ReactSelectAdapterProps } from '../../elements/ReactSelect/types.js'\nimport type { HasManyValueUnion, Option, RelationshipInputProps, UpdateResults } from './types.js'\n\nimport { AddNewRelation } from '../../elements/AddNewRelation/index.js'\nimport { useDocumentDrawer } from '../../elements/DocumentDrawer/index.js'\nimport { useListDrawer } from '../../elements/ListDrawer/index.js'\nimport { ReactSelect } from '../../elements/ReactSelect/index.js'\nimport { RenderCustomComponent } from '../../elements/RenderCustomComponent/index.js'\nimport { FieldDescription } from '../../fields/FieldDescription/index.js'\nimport { FieldError } from '../../fields/FieldError/index.js'\nimport { FieldLabel } from '../../fields/FieldLabel/index.js'\nimport { useDebouncedCallback } from '../../hooks/useDebouncedCallback.js'\nimport { useEffectEvent } from '../../hooks/useEffectEvent.js'\nimport { useQueue } from '../../hooks/useQueue.js'\nimport { useAuth } from '../../providers/Auth/index.js'\nimport { useConfig } from '../../providers/Config/index.js'\nimport { useDocumentEvents } from '../../providers/DocumentEvents/index.js'\nimport { useLocale } from '../../providers/Locale/index.js'\nimport { useTranslation } from '../../providers/Translation/index.js'\nimport { sanitizeFilterOptionsQuery } from '../../utilities/sanitizeFilterOptionsQuery.js'\nimport { fieldBaseClass } from '../shared/index.js'\nimport { createRelationMap } from './createRelationMap.js'\nimport { findOptionsByValue } from './findOptionsByValue.js'\nimport { optionsReducer } from './optionsReducer.js'\nimport './index.scss'\nimport { MultiValueLabel } from './select-components/MultiValueLabel/index.js'\nimport { SingleValue } from './select-components/SingleValue/index.js'\n\nconst baseClass = 'relationship'\n\nexport const RelationshipInput: React.FC<RelationshipInputProps> = (props) => {\n  const {\n    AfterInput,\n    allowCreate = true,\n    allowEdit = true,\n    appearance = 'select',\n    BeforeInput,\n    className,\n    description,\n    Description,\n    Error,\n    filterOptions,\n    formatDisplayedOptions,\n    hasMany,\n    initialValue,\n    isSortable = true,\n    label,\n    Label,\n    localized,\n    maxResultsPerRequest = 10,\n    onChange,\n    path,\n    placeholder,\n    readOnly,\n    relationTo,\n    required,\n    showError,\n    sortOptions,\n    style,\n    value,\n  } = props\n\n  const { config, getEntityConfig } = useConfig()\n\n  const {\n    routes: { api },\n    serverURL,\n  } = config\n\n  const { i18n, t } = useTranslation()\n  const { permissions } = useAuth()\n  const { code: locale } = useLocale()\n\n  const [currentlyOpenRelationship, setCurrentlyOpenRelationship] = useState<\n    Parameters<ReactSelectAdapterProps['customProps']['onDocumentOpen']>[0]\n  >({\n    id: undefined,\n    collectionSlug: undefined,\n    hasReadPermission: false,\n  })\n\n  const [lastFullyLoadedRelation, setLastFullyLoadedRelation] = useState(-1)\n  const [lastLoadedPage, setLastLoadedPage] = useState<Record<string, number>>({})\n  const [errorLoading, setErrorLoading] = useState('')\n  const [search, setSearch] = useState('')\n  const [isLoading, setIsLoading] = useState(false)\n  const [enableWordBoundarySearch, setEnableWordBoundarySearch] = useState(false)\n  const [menuIsOpen, setMenuIsOpen] = useState(false)\n  const hasLoadedFirstPageRef = useRef(false)\n  const { queueTask } = useQueue()\n\n  const [options, dispatchOptions] = useReducer(optionsReducer, [])\n\n  const valueRef = useRef(value)\n\n  const [DocumentDrawer, , { drawerSlug, isDrawerOpen, openDrawer }] = useDocumentDrawer({\n    id: currentlyOpenRelationship.id,\n    collectionSlug: currentlyOpenRelationship.collectionSlug,\n  })\n\n  // Filter selected values from displaying in the list drawer\n  const listDrawerFilterOptions = useMemo<FilterOptionsResult>(() => {\n    let newFilterOptions = filterOptions\n\n    if (value) {\n      const valuesByRelation = (hasMany === false ? [value] : value).reduce((acc, val) => {\n        if (!acc[val.relationTo]) {\n          acc[val.relationTo] = []\n        }\n        acc[val.relationTo].push(val.value)\n        return acc\n      }, {})\n\n      ;(Array.isArray(relationTo) ? relationTo : [relationTo]).forEach((relation) => {\n        newFilterOptions = {\n          ...(newFilterOptions || {}),\n          [relation]: {\n            ...(typeof filterOptions?.[relation] === 'object' ? filterOptions[relation] : {}),\n            ...(valuesByRelation[relation]\n              ? {\n                  id: {\n                    not_in: valuesByRelation[relation],\n                  },\n                }\n              : {}),\n          },\n        }\n      })\n    }\n\n    return newFilterOptions\n  }, [filterOptions, value, hasMany, relationTo])\n\n  const [\n    ListDrawer,\n    ,\n    { closeDrawer: closeListDrawer, isDrawerOpen: isListDrawerOpen, openDrawer: openListDrawer },\n  ] = useListDrawer({\n    collectionSlugs: relationTo,\n    filterOptions: listDrawerFilterOptions,\n  })\n\n  const onListSelect = useCallback<NonNullable<ListDrawerProps['onSelect']>>(\n    ({ collectionSlug, doc }) => {\n      if (hasMany) {\n        onChange([\n          ...(Array.isArray(value) ? value : []),\n          {\n            relationTo: collectionSlug,\n            value: doc.id,\n          },\n        ])\n      } else if (hasMany === false) {\n        onChange({\n          relationTo: collectionSlug,\n          value: doc.id,\n        })\n      }\n\n      closeListDrawer()\n    },\n    [hasMany, onChange, closeListDrawer, value],\n  )\n\n  const openDrawerWhenRelationChanges = useRef(false)\n\n  const updateResults: UpdateResults = useCallback(\n    ({\n      filterOptions,\n      hasMany: hasManyArg,\n      lastFullyLoadedRelation: lastFullyLoadedRelationArg,\n      lastLoadedPage: lastLoadedPageArg,\n      onSuccess,\n      search: searchArg,\n      sort,\n      value: valueArg,\n    }) => {\n      if (!permissions) {\n        return\n      }\n      queueTask(async () => {\n        const lastFullyLoadedRelationToUse =\n          typeof lastFullyLoadedRelationArg !== 'undefined' ? lastFullyLoadedRelationArg : -1\n\n        const relations = Array.isArray(relationTo) ? relationTo : [relationTo]\n        const relationsToFetch =\n          lastFullyLoadedRelationToUse === -1\n            ? relations\n            : relations.slice(lastFullyLoadedRelationToUse + 1)\n\n        let resultsFetched = 0\n        const relationMap = createRelationMap(\n          hasManyArg === true\n            ? {\n                hasMany: true,\n                relationTo,\n                value: valueArg,\n              }\n            : {\n                hasMany: false,\n                relationTo,\n                value: valueArg,\n              },\n        )\n\n        if (!errorLoading) {\n          await relationsToFetch.reduce(async (priorRelation, relation) => {\n            const relationFilterOption = filterOptions?.[relation]\n\n            let lastLoadedPageToUse\n            if (search !== searchArg) {\n              lastLoadedPageToUse = 1\n            } else {\n              lastLoadedPageToUse = (lastLoadedPageArg[relation] || 0) + 1\n            }\n            await priorRelation\n\n            if (relationFilterOption === false) {\n              setLastFullyLoadedRelation(relations.indexOf(relation))\n              return Promise.resolve()\n            }\n\n            if (resultsFetched < 10) {\n              const collection = getEntityConfig({ collectionSlug: relation })\n              const fieldToSearch = collection?.admin?.useAsTitle || 'id'\n              let fieldToSort = collection?.defaultSort || 'id'\n              if (typeof sortOptions === 'string') {\n                fieldToSort = sortOptions\n              } else if (sortOptions?.[relation]) {\n                fieldToSort = sortOptions[relation]\n              }\n\n              const query: {\n                [key: string]: unknown\n                where: Where\n              } = {\n                depth: 0,\n                draft: true,\n                limit: maxResultsPerRequest,\n                locale,\n                page: lastLoadedPageToUse,\n                select: {\n                  [fieldToSearch]: true,\n                },\n                sort: fieldToSort,\n                where: {\n                  and: [\n                    {\n                      id: {\n                        not_in: relationMap[relation],\n                      },\n                    },\n                  ],\n                },\n              }\n\n              if (searchArg) {\n                query.where.and.push({\n                  [fieldToSearch]: {\n                    like: searchArg,\n                  },\n                })\n              }\n\n              if (relationFilterOption && typeof relationFilterOption !== 'boolean') {\n                query.where.and.push(relationFilterOption)\n              }\n\n              sanitizeFilterOptionsQuery(query.where)\n\n              const response = await fetch(\n                formatAdminURL({\n                  apiRoute: api,\n                  path: `/${relation}`,\n                }),\n                {\n                  body: qs.stringify(query),\n                  credentials: 'include',\n                  headers: {\n                    'Accept-Language': i18n.language,\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                    'X-Payload-HTTP-Method-Override': 'GET',\n                  },\n                  method: 'POST',\n                },\n              )\n\n              if (response.ok) {\n                const data: PaginatedDocs<unknown> = await response.json()\n                setLastLoadedPage((prevState) => {\n                  return {\n                    ...prevState,\n                    [relation]: lastLoadedPageToUse,\n                  }\n                })\n\n                if (!data.nextPage) {\n                  setLastFullyLoadedRelation(relations.indexOf(relation))\n                }\n\n                if (data.docs.length > 0) {\n                  resultsFetched += data.docs.length\n\n                  dispatchOptions({\n                    type: 'ADD',\n                    collection,\n                    config,\n                    docs: data.docs,\n                    i18n,\n                    sort,\n                  })\n                }\n              } else if (response.status === 403) {\n                setLastFullyLoadedRelation(relations.indexOf(relation))\n                dispatchOptions({\n                  type: 'ADD',\n                  collection,\n                  config,\n                  docs: [],\n                  i18n,\n                  ids: relationMap[relation],\n                  sort,\n                })\n              } else {\n                setErrorLoading(t('error:unspecific'))\n              }\n            }\n          }, Promise.resolve())\n\n          if (typeof onSuccess === 'function') {\n            onSuccess()\n          }\n        }\n      })\n    },\n    [\n      permissions,\n      queueTask,\n      relationTo,\n      errorLoading,\n      search,\n      getEntityConfig,\n      sortOptions,\n      maxResultsPerRequest,\n      locale,\n      api,\n      i18n,\n      config,\n      t,\n    ],\n  )\n\n  const updateSearch = useDebouncedCallback<{ search: string } & HasManyValueUnion>(\n    ({ hasMany: hasManyArg, search: searchArg, value }) => {\n      updateResultsEffectEvent({\n        filterOptions,\n        lastLoadedPage: {},\n        onSuccess: () => {\n          setIsLoading(false)\n        },\n        search: searchArg,\n        sort: true,\n        ...(hasManyArg === true\n          ? {\n              hasMany: hasManyArg,\n              value,\n            }\n          : {\n              hasMany: hasManyArg,\n              value,\n            }),\n      })\n      setSearch(searchArg)\n    },\n    300,\n  )\n\n  const handleInputChange = useCallback(\n    (options: { search: string } & HasManyValueUnion) => {\n      if (search !== options.search) {\n        setIsLoading(true)\n        setLastLoadedPage({})\n        updateSearch(options)\n      }\n    },\n    [search, updateSearch],\n  )\n\n  const handleValueChange = useEffectEvent(({ hasMany: hasManyArg, value }: HasManyValueUnion) => {\n    const relationMap = createRelationMap(\n      hasManyArg === true\n        ? {\n            hasMany: hasManyArg,\n            relationTo,\n            value,\n          }\n        : {\n            hasMany: hasManyArg,\n            relationTo,\n            value,\n          },\n    )\n\n    void Object.entries(relationMap).reduce(async (priorRelation, [relation, ids]) => {\n      await priorRelation\n\n      const idsToLoad = ids.filter((id) => {\n        return !options.find((optionGroup) =>\n          optionGroup?.options?.find(\n            (option) => option.value === id && option.relationTo === relation,\n          ),\n        )\n      })\n\n      if (idsToLoad.length > 0) {\n        const collection = getEntityConfig({ collectionSlug: relation })\n        const fieldToSelect = collection?.admin?.useAsTitle || 'id'\n\n        const query = {\n          depth: 0,\n          draft: true,\n          limit: idsToLoad.length,\n          locale,\n          select: {\n            [fieldToSelect]: true,\n          },\n          where: {\n            id: {\n              in: idsToLoad,\n            },\n          },\n        }\n\n        if (!errorLoading) {\n          const response = await fetch(\n            formatAdminURL({\n              apiRoute: api,\n              path: `/${relation}`,\n            }),\n            {\n              body: qs.stringify(query),\n              credentials: 'include',\n              headers: {\n                'Accept-Language': i18n.language,\n                'Content-Type': 'application/x-www-form-urlencoded',\n                'X-Payload-HTTP-Method-Override': 'GET',\n              },\n              method: 'POST',\n            },\n          )\n          let docs = []\n\n          if (response.ok) {\n            const data = await response.json()\n            docs = data.docs\n          }\n\n          dispatchOptions({\n            type: 'ADD',\n            collection,\n            config,\n            docs,\n            i18n,\n            ids: idsToLoad,\n            sort: true,\n          })\n        }\n      }\n    }, Promise.resolve())\n  })\n\n  const { mostRecentUpdate } = useDocumentEvents()\n\n  const handleDocumentUpdateEvent = useEffectEvent((mostRecentUpdate: DocumentEvent) => {\n    if (!value) {\n      return false\n    }\n\n    const docID = mostRecentUpdate.doc.id\n\n    let isMatchingUpdate = false\n    if (mostRecentUpdate.operation === 'update') {\n      if (hasMany === true) {\n        const currentValue = Array.isArray(value) ? value : [value]\n        isMatchingUpdate = currentValue.some((option) => {\n          return option.value === docID && option.relationTo === mostRecentUpdate.entitySlug\n        })\n      } else if (hasMany === false) {\n        isMatchingUpdate =\n          value?.value === docID && value?.relationTo === mostRecentUpdate.entitySlug\n      }\n    } else if (mostRecentUpdate.operation === 'create') {\n      // \"Create New\" drawer operations on the same level as this drawer should\n      // set the value to the newly created document.\n      // See test \"should create document within document drawer > has one\"\n      isMatchingUpdate = mostRecentUpdate.drawerSlug === drawerSlug\n    }\n\n    if (!isMatchingUpdate) {\n      return\n    }\n\n    const collectionConfig = getEntityConfig({ collectionSlug: mostRecentUpdate.entitySlug })\n\n    dispatchOptions({\n      type: 'UPDATE',\n      collection: collectionConfig,\n      config,\n      doc: mostRecentUpdate.doc,\n      i18n,\n    })\n\n    if (hasMany) {\n      const currentValue = value ? (Array.isArray(value) ? value : [value]) : []\n\n      const valuesToSet = currentValue.map((option: ValueWithRelation) => {\n        return {\n          relationTo: option.value === docID ? mostRecentUpdate.entitySlug : option.relationTo,\n          value: option.value,\n        }\n      })\n\n      onChange(valuesToSet)\n    } else if (hasMany === false) {\n      onChange({ relationTo: mostRecentUpdate.entitySlug, value: docID })\n    }\n  })\n\n  /**\n   * Listen to document update events. If you edit a related document from a drawer and save it, this event\n   * will be triggered. We then need up update the label of this relationship input, as the useAsLabel field could have changed.\n   *\n   * We listen to this event instead of using the onSave callback on the document drawer, as the onSave callback is not triggered\n   * when you save a document from a drawer opened by a *different* relationship (or any other) field.\n   */\n  useEffect(() => {\n    if (mostRecentUpdate) {\n      handleDocumentUpdateEvent(mostRecentUpdate)\n    }\n  }, [mostRecentUpdate])\n\n  const onDuplicate = useCallback<DocumentDrawerProps['onDuplicate']>(\n    (args) => {\n      dispatchOptions({\n        type: 'ADD',\n        collection: args.collectionConfig,\n        config,\n        docs: [args.doc],\n        i18n,\n        sort: true,\n      })\n\n      if (hasMany) {\n        onChange(\n          value\n            ? value.concat({\n                relationTo: args.collectionConfig.slug,\n                value: args.doc.id,\n              })\n            : null,\n        )\n      } else if (hasMany === false) {\n        onChange({\n          relationTo: args.collectionConfig.slug,\n          value: args.doc.id,\n        })\n      }\n    },\n    [i18n, config, hasMany, onChange, value],\n  )\n\n  const onDelete = useCallback<DocumentDrawerProps['onDelete']>(\n    (args) => {\n      dispatchOptions({\n        id: args.id,\n        type: 'REMOVE',\n        collection: args.collectionConfig,\n        config,\n        i18n,\n      })\n\n      if (hasMany) {\n        onChange(\n          value\n            ? value.filter((option) => {\n                return option.value !== args.id\n              })\n            : null,\n        )\n      } else {\n        onChange(null)\n      }\n\n      return\n    },\n    [i18n, config, hasMany, onChange, value],\n  )\n\n  const filterOption = useCallback((item: Option, searchFilter: string) => {\n    if (!searchFilter) {\n      return true\n    }\n    const r = wordBoundariesRegex(searchFilter || '')\n    // breaking the labels to search into smaller parts increases performance\n    const breakApartThreshold = 250\n    let labelString = String(item.label)\n    // strings less than breakApartThreshold length won't be chunked\n    while (labelString.length > breakApartThreshold) {\n      // slicing by the next space after the length of the search input prevents slicing the string up by partial words\n      const indexOfSpace = labelString.indexOf(' ', searchFilter.length)\n      if (\n        r.test(labelString.slice(0, indexOfSpace === -1 ? searchFilter.length : indexOfSpace + 1))\n      ) {\n        return true\n      }\n      labelString = labelString.slice(indexOfSpace === -1 ? searchFilter.length : indexOfSpace + 1)\n    }\n    return r.test(labelString.slice(-breakApartThreshold))\n  }, [])\n\n  const onDocumentOpen = useCallback<ReactSelectAdapterProps['customProps']['onDocumentOpen']>(\n    ({ id, collectionSlug, hasReadPermission, openInNewTab }) => {\n      if (openInNewTab) {\n        if (hasReadPermission && id && collectionSlug) {\n          const docUrl = formatAdminURL({\n            adminRoute: config.routes.admin,\n            path: `/collections/${collectionSlug}/${id}`,\n            serverURL,\n          })\n\n          window.open(docUrl, '_blank')\n        }\n      } else {\n        openDrawerWhenRelationChanges.current = true\n\n        setCurrentlyOpenRelationship({\n          id,\n          collectionSlug,\n          hasReadPermission,\n        })\n      }\n    },\n    [config.routes.admin, serverURL],\n  )\n\n  const updateResultsEffectEvent: UpdateResults = useEffectEvent((args) => {\n    return updateResults(args)\n  })\n\n  // When (`relationTo` || `filterOptions` || `locale`) changes, reset component\n  // Note - effect should not run on first run\n  useEffect(() => {\n    // If the menu is open while filterOptions changes\n    // due to latency of form state and fast clicking into this field,\n    // re-fetch options\n    if (hasLoadedFirstPageRef.current && menuIsOpen) {\n      setIsLoading(true)\n      void updateResultsEffectEvent({\n        filterOptions,\n        lastLoadedPage: {},\n        onSuccess: () => {\n          hasLoadedFirstPageRef.current = true\n          setIsLoading(false)\n        },\n        ...(hasMany === true\n          ? {\n              hasMany,\n              value: valueRef.current as ValueWithRelation[],\n            }\n          : {\n              hasMany,\n              value: valueRef.current as ValueWithRelation,\n            }),\n      })\n    }\n\n    // If the menu is not open, still reset the field state\n    // because we need to get new options next time the menu opens\n    dispatchOptions({\n      type: 'CLEAR',\n      exemptValues: valueRef.current,\n    })\n\n    setLastFullyLoadedRelation(-1)\n    setLastLoadedPage({})\n  }, [relationTo, filterOptions, locale, path, menuIsOpen, hasMany])\n\n  const prevValue = useRef(value)\n  const isFirstRenderRef = useRef(true)\n\n  // ///////////////////////////////////\n  // Ensure we have an option for each value\n  // ///////////////////////////////////\n  useEffect(() => {\n    if (isFirstRenderRef.current || !dequal(value, prevValue.current)) {\n      handleValueChange(hasMany === true ? { hasMany, value } : { hasMany, value })\n    }\n    isFirstRenderRef.current = false\n    prevValue.current = value\n  }, [value, hasMany])\n\n  // Determine if we should switch to word boundary search\n  useEffect(() => {\n    const relations = Array.isArray(relationTo) ? relationTo : [relationTo]\n    const isIdOnly = relations.reduce((idOnly, relation) => {\n      const collection = getEntityConfig({ collectionSlug: relation })\n      const fieldToSearch = collection?.admin?.useAsTitle || 'id'\n      return fieldToSearch === 'id' && idOnly\n    }, true)\n    setEnableWordBoundarySearch(!isIdOnly)\n  }, [relationTo, getEntityConfig])\n\n  useEffect(() => {\n    if (openDrawerWhenRelationChanges.current) {\n      openDrawer()\n      openDrawerWhenRelationChanges.current = false\n    }\n  }, [openDrawer, currentlyOpenRelationship])\n\n  useEffect(() => {\n    // needed to sync the ref value when other fields influence the value\n    // i.e. when a drawer is opened and the value is set\n    valueRef.current = value\n  }, [value])\n\n  const valueToRender = findOptionsByValue({ allowEdit, options, value })\n\n  if (!Array.isArray(valueToRender) && valueToRender?.value === 'null') {\n    valueToRender.value = null\n  }\n\n  return (\n    <div\n      className={[\n        fieldBaseClass,\n        baseClass,\n        className,\n        showError && 'error',\n        errorLoading && 'error-loading',\n        readOnly && `${baseClass}--read-only`,\n        !readOnly && allowCreate && `${baseClass}--allow-create`,\n      ]\n        .filter(Boolean)\n        .join(' ')}\n      id={`field-${path.replace(/\\./g, '__')}`}\n      style={style}\n    >\n      <RenderCustomComponent\n        CustomComponent={Label}\n        Fallback={\n          <FieldLabel label={label} localized={localized} path={path} required={required} />\n        }\n      />\n      <div className={`${fieldBaseClass}__wrap`}>\n        <RenderCustomComponent\n          CustomComponent={Error}\n          Fallback={<FieldError path={path} showError={showError} />}\n        />\n        {BeforeInput}\n        {errorLoading ? (\n          <div className={`${baseClass}__error-loading`}>{errorLoading}</div>\n        ) : (\n          <div className={`${baseClass}__wrap`}>\n            <ReactSelect\n              backspaceRemovesValue={!(isDrawerOpen || isListDrawerOpen)}\n              components={{\n                MultiValueLabel,\n                SingleValue,\n                ...(appearance !== 'select' && { DropdownIndicator: null }),\n              }}\n              customProps={{\n                disableKeyDown: isDrawerOpen || isListDrawerOpen,\n                disableMouseDown: isDrawerOpen || isListDrawerOpen,\n                onDocumentOpen,\n              }}\n              disabled={readOnly || isDrawerOpen || isListDrawerOpen}\n              filterOption={enableWordBoundarySearch ? filterOption : undefined}\n              getOptionValue={(option: ValueWithRelation) => {\n                if (!option) {\n                  return undefined\n                }\n                return hasMany && Array.isArray(relationTo)\n                  ? `${option.relationTo}_${option.value}`\n                  : (option.value as string)\n              }}\n              isLoading={appearance === 'select' && isLoading}\n              isMulti={hasMany}\n              isSearchable={appearance === 'select'}\n              isSortable={isSortable}\n              menuIsOpen={appearance === 'select' ? menuIsOpen : false}\n              onChange={\n                !readOnly\n                  ? (selected) => {\n                      if (hasMany) {\n                        if (selected === null) {\n                          valueRef.current = []\n                          onChange([])\n                        } else {\n                          valueRef.current = selected as ValueWithRelation[]\n                          onChange(selected as ValueWithRelation[])\n                        }\n                      } else if (hasMany === false) {\n                        if (selected === null) {\n                          valueRef.current = null\n                          onChange(null)\n                        } else {\n                          valueRef.current = selected as ValueWithRelation\n                          onChange(selected as ValueWithRelation)\n                        }\n                      }\n                    }\n                  : undefined\n              }\n              onInputChange={(newSearch) =>\n                handleInputChange({\n                  search: newSearch,\n                  ...(hasMany === true\n                    ? {\n                        hasMany,\n                        value,\n                      }\n                    : {\n                        hasMany,\n                        value,\n                      }),\n                })\n              }\n              onMenuClose={() => {\n                setMenuIsOpen(false)\n              }}\n              onMenuOpen={() => {\n                if (appearance === 'drawer') {\n                  openListDrawer()\n                } else if (appearance === 'select') {\n                  setMenuIsOpen(true)\n                  if (!hasLoadedFirstPageRef.current) {\n                    setIsLoading(true)\n                    updateResultsEffectEvent({\n                      filterOptions,\n                      lastLoadedPage: {},\n                      onSuccess: () => {\n                        hasLoadedFirstPageRef.current = true\n                        setIsLoading(false)\n                      },\n                      ...(hasMany === true\n                        ? {\n                            hasMany,\n                            value,\n                          }\n                        : {\n                            hasMany,\n                            value,\n                          }),\n                    })\n                  }\n                }\n              }}\n              onMenuScrollToBottom={() => {\n                setIsLoading(true)\n                updateResultsEffectEvent({\n                  filterOptions,\n                  lastFullyLoadedRelation,\n                  lastLoadedPage,\n                  onSuccess: () => {\n                    setIsLoading(false)\n                  },\n                  search,\n                  sort: false,\n                  ...(hasMany === true\n                    ? {\n                        hasMany,\n                        value: initialValue,\n                      }\n                    : {\n                        hasMany,\n                        value: initialValue,\n                      }),\n                })\n              }}\n              options={\n                typeof formatDisplayedOptions === 'function'\n                  ? formatDisplayedOptions(options)\n                  : options\n              }\n              placeholder={placeholder}\n              showError={showError}\n              value={valueToRender ?? null}\n            />\n            {!readOnly && allowCreate && (\n              <AddNewRelation\n                path={path}\n                relationTo={relationTo}\n                {...(hasMany === true\n                  ? {\n                      hasMany,\n                      onChange,\n                      value,\n                    }\n                  : {\n                      hasMany,\n                      onChange,\n                      value,\n                    })}\n              />\n            )}\n          </div>\n        )}\n        {AfterInput}\n        <RenderCustomComponent\n          CustomComponent={Description}\n          Fallback={<FieldDescription description={description} path={path} />}\n        />\n      </div>\n      {currentlyOpenRelationship.collectionSlug && currentlyOpenRelationship.hasReadPermission && (\n        <DocumentDrawer onDelete={onDelete} onDuplicate={onDuplicate} />\n      )}\n      {appearance === 'drawer' && !readOnly && (\n        <ListDrawer allowCreate={allowCreate} enableRowSelections={false} onSelect={onListSelect} />\n      )}\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]}
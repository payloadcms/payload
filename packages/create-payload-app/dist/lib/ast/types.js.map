{"version":3,"sources":["../../../src/lib/ast/types.ts"],"sourcesContent":["import type {\n  ArrayLiteralExpression,\n  CallExpression,\n  ImportDeclaration,\n  PropertyAssignment,\n  SourceFile,\n} from 'ts-morph'\n\n// Result types for import utility functions\nexport type ImportRemovalResult = {\n  removedIndex?: number\n  sourceFile: SourceFile\n}\n\nexport type NamedImportRemovalResult = {\n  fullyRemoved: boolean\n  index?: number\n  sourceFile: SourceFile\n}\n\nexport type ImportCleanupResult = {\n  kept: string[]\n  removed: string[]\n  sourceFile: SourceFile\n}\n\nexport type DetectionError = {\n  debugInfo?: Record<string, unknown>\n  technicalDetails: string\n  userMessage: string\n}\n\nexport type PayloadConfigStructures = {\n  buildConfigCall: CallExpression\n  dbProperty?: PropertyAssignment\n  importStatements: ImportDeclaration[]\n  pluginsArray?: ArrayLiteralExpression\n}\n\n/**\n * Detection result with edge case tracking and import source information\n */\nexport type DetectionResult = {\n  /** Edge case flags */\n  edgeCases?: {\n    /** Import uses an alias (e.g., import { buildConfig as bc }) */\n    hasImportAlias: boolean\n    /** Other Payload imports exist (e.g., CollectionConfig) */\n    hasOtherPayloadImports: boolean\n    /** Multiple buildConfig calls found in file */\n    multipleBuildConfigCalls: boolean\n    /** Needs manual intervention (can't be automatically handled) */\n    needsManualIntervention: boolean\n  }\n  error?: DetectionError\n  /** Import source tracking */\n  importSources?: {\n    /** Current database adapter import info */\n    dbAdapter?: {\n      hasOtherImports: boolean\n      importDeclaration: ImportDeclaration\n      packageName: string\n    }\n    /** Current storage adapter import info */\n    storageAdapters?: Array<{\n      hasOtherImports: boolean\n      importDeclaration: ImportDeclaration\n      packageName: string\n    }>\n  }\n  /** Source file reference */\n  sourceFile?: SourceFile\n  /** Detected structures */\n  structures?: PayloadConfigStructures\n  success: boolean\n}\n\n/**\n * Tracks a single modification made to the AST\n */\nexport type Modification = {\n  description: string\n  location?: {\n    column: number\n    line: number\n  }\n  type:\n    | 'function-renamed'\n    | 'import-added'\n    | 'import-modified'\n    | 'import-removed'\n    | 'property-added'\n    | 'property-removed'\n}\n\n/**\n * Result of transformation operations\n */\nexport type TransformationResult = {\n  error?: DetectionError\n  modifications: Modification[]\n  modified: boolean\n  success: boolean\n  warnings?: string[]\n}\n\n/**\n * Final result after writing to disk\n */\nexport type ModificationResult = {\n  error?: DetectionError\n  filePath: string\n  formatted?: boolean\n  modifications: Modification[]\n  success: boolean\n  warnings?: string[]\n}\nexport type DatabaseAdapter = (typeof ALL_DATABASE_ADAPTERS)[number]\n\nexport const ALL_DATABASE_ADAPTERS = [\n  'mongodb',\n  'postgres',\n  'sqlite',\n  'vercel-postgres',\n  'd1-sqlite',\n] as const\n\nexport const ALL_STORAGE_ADAPTERS = [\n  'azureStorage',\n  'gcsStorage',\n  'localDisk',\n  'r2Storage',\n  's3Storage',\n  'uploadthingStorage',\n  'vercelBlobStorage',\n] as const\n\nexport type StorageAdapter = (typeof ALL_STORAGE_ADAPTERS)[number]\n\nexport type TransformOptions = {\n  databaseAdapter?: {\n    envVarName?: string\n    type: DatabaseAdapter\n  }\n  removeSharp?: boolean\n  storageAdapter?: {\n    type: StorageAdapter\n  }\n}\n\nexport type WriteOptions = {\n  formatWithPrettier?: boolean\n  validateStructure?: boolean\n}\n\nexport type WriteResult = {\n  error?: DetectionError\n  success: boolean\n}\n\nexport type ConfigureOptions = {\n  db?: {\n    envVarName?: string\n    type: DatabaseAdapter\n  }\n  removeSharp?: boolean\n  storage?: StorageAdapter\n} & WriteOptions\n"],"names":["ALL_DATABASE_ADAPTERS","ALL_STORAGE_ADAPTERS"],"mappings":"AAuHA,OAAO,MAAMA,wBAAwB;IACnC;IACA;IACA;IACA;IACA;CACD,CAAS;AAEV,OAAO,MAAMC,uBAAuB;IAClC;IACA;IACA;IACA;IACA;IACA;IACA;CACD,CAAS"}
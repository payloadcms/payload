{"version":3,"sources":["../../src/utils/createApiKeyFields.ts"],"sourcesContent":["import type { Field } from 'payload'\n\nimport type { EntityConfig } from '../types.js'\n\nimport { adminEntitySettings } from './adminEntitySettings.js'\nimport { toCamelCase } from './camelCase.js'\nimport { getEnabledSlugs } from './getEnabledSlugs.js'\n/**\n * Creates MCP API key permission fields using collections or globals.\n * Generates collapsible field groups with checkboxes for each enabled operation.\n *\n * @param config - The collections or globals configuration object\n * @param configType - The type of configuration ('collection' or 'global')\n * @returns Array of fields for the MCP API Keys collection\n */\nexport const createApiKeyFields = ({\n  config,\n  configType,\n}: {\n  config: EntityConfig | undefined\n  configType: 'collection' | 'global'\n}): Field[] => {\n  const operations = adminEntitySettings[configType]\n  const enabledSlugs = getEnabledSlugs(config, configType)\n\n  return enabledSlugs.map((slug) => {\n    const entityConfig = config?.[slug]\n\n    const enabledOperations = operations.filter((operation) => {\n      // If fully enabled, all operations are available\n      if (entityConfig?.enabled === true) {\n        return true\n      }\n\n      // If partially enabled, check if this specific operation is enabled\n      const enabled = entityConfig?.enabled\n      if (typeof enabled !== 'boolean' && enabled) {\n        const operationEnabled = enabled[operation.name as keyof typeof enabled]\n        return typeof operationEnabled === 'boolean' && operationEnabled === true\n      }\n\n      return false\n    })\n\n    // Generate checkbox fields for each enabled operation\n    const operationFields = enabledOperations.map((operation) => ({\n      name: operation.name,\n      type: 'checkbox' as const,\n      admin: {\n        description: operation.description(slug),\n      },\n      defaultValue: false,\n      label: operation.label,\n    }))\n\n    return {\n      type: 'collapsible' as const,\n      admin: {\n        position: 'sidebar' as const,\n      },\n      fields: [\n        {\n          name: toCamelCase(slug),\n          type: 'group' as const,\n          fields: operationFields,\n          label: configType,\n        },\n      ],\n      label: `${slug.charAt(0).toUpperCase() + toCamelCase(slug).slice(1)}`,\n    }\n  })\n}\n"],"names":["adminEntitySettings","toCamelCase","getEnabledSlugs","createApiKeyFields","config","configType","operations","enabledSlugs","map","slug","entityConfig","enabledOperations","filter","operation","enabled","operationEnabled","name","operationFields","type","admin","description","defaultValue","label","position","fields","charAt","toUpperCase","slice"],"mappings":"AAIA,SAASA,mBAAmB,QAAQ,2BAA0B;AAC9D,SAASC,WAAW,QAAQ,iBAAgB;AAC5C,SAASC,eAAe,QAAQ,uBAAsB;AACtD;;;;;;;CAOC,GACD,OAAO,MAAMC,qBAAqB,CAAC,EACjCC,MAAM,EACNC,UAAU,EAIX;IACC,MAAMC,aAAaN,mBAAmB,CAACK,WAAW;IAClD,MAAME,eAAeL,gBAAgBE,QAAQC;IAE7C,OAAOE,aAAaC,GAAG,CAAC,CAACC;QACvB,MAAMC,eAAeN,QAAQ,CAACK,KAAK;QAEnC,MAAME,oBAAoBL,WAAWM,MAAM,CAAC,CAACC;YAC3C,iDAAiD;YACjD,IAAIH,cAAcI,YAAY,MAAM;gBAClC,OAAO;YACT;YAEA,oEAAoE;YACpE,MAAMA,UAAUJ,cAAcI;YAC9B,IAAI,OAAOA,YAAY,aAAaA,SAAS;gBAC3C,MAAMC,mBAAmBD,OAAO,CAACD,UAAUG,IAAI,CAAyB;gBACxE,OAAO,OAAOD,qBAAqB,aAAaA,qBAAqB;YACvE;YAEA,OAAO;QACT;QAEA,sDAAsD;QACtD,MAAME,kBAAkBN,kBAAkBH,GAAG,CAAC,CAACK,YAAe,CAAA;gBAC5DG,MAAMH,UAAUG,IAAI;gBACpBE,MAAM;gBACNC,OAAO;oBACLC,aAAaP,UAAUO,WAAW,CAACX;gBACrC;gBACAY,cAAc;gBACdC,OAAOT,UAAUS,KAAK;YACxB,CAAA;QAEA,OAAO;YACLJ,MAAM;YACNC,OAAO;gBACLI,UAAU;YACZ;YACAC,QAAQ;gBACN;oBACER,MAAMf,YAAYQ;oBAClBS,MAAM;oBACNM,QAAQP;oBACRK,OAAOjB;gBACT;aACD;YACDiB,OAAO,GAAGb,KAAKgB,MAAM,CAAC,GAAGC,WAAW,KAAKzB,YAAYQ,MAAMkB,KAAK,CAAC,IAAI;QACvE;IACF;AACF,EAAC"}
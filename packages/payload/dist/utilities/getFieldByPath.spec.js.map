{"version":3,"sources":["../../src/utilities/getFieldByPath.spec.ts"],"sourcesContent":["import { assert } from 'ts-essentials'\nimport { describe, it, expect } from 'vitest'\nimport { flattenAllFields } from './flattenAllFields.js'\nimport { getFieldByPath } from './getFieldByPath.js'\nimport type { FlattenedArrayField, FlattenedGroupField } from '../fields/config/types.js'\n\nconst fields = flattenAllFields({\n  fields: [\n    {\n      type: 'text',\n      name: 'text',\n    },\n    {\n      type: 'text',\n      name: 'textLocalized',\n      localized: true,\n    },\n    {\n      type: 'array',\n      name: 'array',\n      fields: [\n        {\n          name: 'text',\n          type: 'text',\n        },\n        {\n          name: 'textLocalized',\n          localized: true,\n          type: 'text',\n        },\n        {\n          name: 'group',\n          type: 'group',\n          fields: [\n            {\n              name: 'text',\n              type: 'text',\n            },\n          ],\n        },\n      ],\n    },\n    {\n      type: 'tabs',\n      tabs: [\n        {\n          name: 'tab',\n          fields: [\n            {\n              type: 'array',\n              name: 'localizedArray',\n              localized: true,\n              fields: [\n                {\n                  name: 'text',\n                  type: 'text',\n                },\n              ],\n            },\n          ],\n        },\n      ],\n    },\n    {\n      type: 'blocks',\n      name: 'blocks',\n      blocks: [\n        {\n          slug: 'block1',\n          fields: [\n            {\n              name: 'text1',\n              type: 'text',\n            },\n          ],\n        },\n        {\n          slug: 'block2',\n          fields: [\n            {\n              name: 'text2',\n              type: 'text',\n            },\n          ],\n        },\n      ],\n    },\n  ],\n})\n\ndescribe('getFieldByPath', () => {\n  it('asserts getFieldByPath', () => {\n    const assert_1 = getFieldByPath({ fields, path: 'text' })\n    assert(assert_1)\n    expect(assert_1.field).toBe(fields[0])\n    expect(assert_1.pathHasLocalized).toBe(false)\n\n    const assert_2 = getFieldByPath({ fields, path: 'textLocalized' })\n    assert(assert_2)\n    expect(assert_2.field).toBe(fields[1])\n    expect(assert_2.pathHasLocalized).toBe(true)\n    expect(assert_2.localizedPath).toBe('textLocalized.<locale>')\n\n    const arrayField = fields[2] as FlattenedArrayField\n    const assert_3 = getFieldByPath({ fields, path: 'array' })\n    assert(assert_3)\n    expect(assert_3.field).toBe(arrayField)\n    expect(assert_3.pathHasLocalized).toBe(false)\n\n    const assert_4 = getFieldByPath({ fields, path: 'array.text' })\n    assert(assert_4)\n    expect(assert_4.field).toBe(arrayField.flattenedFields[0])\n    expect(assert_4.pathHasLocalized).toBe(false)\n\n    const assert_5 = getFieldByPath({ fields, path: 'array.textLocalized' })\n    assert(assert_5)\n    expect(assert_5.field).toBe(arrayField.flattenedFields[1])\n    expect(assert_5.pathHasLocalized).toBe(true)\n    expect(assert_5.localizedPath).toBe('array.textLocalized.<locale>')\n\n    const groupWithinArray = arrayField.flattenedFields[2] as FlattenedGroupField\n    const assert_6 = getFieldByPath({ fields, path: 'array.group.text' })\n    assert(assert_6)\n    expect(assert_6.field).toBe(groupWithinArray.flattenedFields[0])\n    expect(assert_6.pathHasLocalized).toBe(false)\n\n    const assert_7 = getFieldByPath({ fields, path: 'tab.localizedArray.text' })\n    assert(assert_7)\n    expect(assert_7.field).toBe((fields[3] as any).flattenedFields[0].flattenedFields[0])\n    expect(assert_7.pathHasLocalized).toBe(true)\n    expect(assert_7.localizedPath).toBe('tab.localizedArray.<locale>.text')\n  })\n\n  it('gets field nested within block', () => {\n    const fieldInBlock = getFieldByPath({ fields, path: 'blocks.block2.text2' })\n    expect(fieldInBlock?.field).toBeDefined()\n\n    const sourceField = (fields[4] as any).blocks?.[1].flattenedFields?.[0]\n    expect(sourceField).toBeDefined()\n    expect(fieldInBlock?.field).toBe(sourceField)\n  })\n})\n"],"names":["assert","describe","it","expect","flattenAllFields","getFieldByPath","fields","type","name","localized","tabs","blocks","slug","assert_1","path","field","toBe","pathHasLocalized","assert_2","localizedPath","arrayField","assert_3","assert_4","flattenedFields","assert_5","groupWithinArray","assert_6","assert_7","fieldInBlock","toBeDefined","sourceField"],"mappings":"AAAA,SAASA,MAAM,QAAQ,gBAAe;AACtC,SAASC,QAAQ,EAAEC,EAAE,EAAEC,MAAM,QAAQ,SAAQ;AAC7C,SAASC,gBAAgB,QAAQ,wBAAuB;AACxD,SAASC,cAAc,QAAQ,sBAAqB;AAGpD,MAAMC,SAASF,iBAAiB;IAC9BE,QAAQ;QACN;YACEC,MAAM;YACNC,MAAM;QACR;QACA;YACED,MAAM;YACNC,MAAM;YACNC,WAAW;QACb;QACA;YACEF,MAAM;YACNC,MAAM;YACNF,QAAQ;gBACN;oBACEE,MAAM;oBACND,MAAM;gBACR;gBACA;oBACEC,MAAM;oBACNC,WAAW;oBACXF,MAAM;gBACR;gBACA;oBACEC,MAAM;oBACND,MAAM;oBACND,QAAQ;wBACN;4BACEE,MAAM;4BACND,MAAM;wBACR;qBACD;gBACH;aACD;QACH;QACA;YACEA,MAAM;YACNG,MAAM;gBACJ;oBACEF,MAAM;oBACNF,QAAQ;wBACN;4BACEC,MAAM;4BACNC,MAAM;4BACNC,WAAW;4BACXH,QAAQ;gCACN;oCACEE,MAAM;oCACND,MAAM;gCACR;6BACD;wBACH;qBACD;gBACH;aACD;QACH;QACA;YACEA,MAAM;YACNC,MAAM;YACNG,QAAQ;gBACN;oBACEC,MAAM;oBACNN,QAAQ;wBACN;4BACEE,MAAM;4BACND,MAAM;wBACR;qBACD;gBACH;gBACA;oBACEK,MAAM;oBACNN,QAAQ;wBACN;4BACEE,MAAM;4BACND,MAAM;wBACR;qBACD;gBACH;aACD;QACH;KACD;AACH;AAEAN,SAAS,kBAAkB;IACzBC,GAAG,0BAA0B;QAC3B,MAAMW,WAAWR,eAAe;YAAEC;YAAQQ,MAAM;QAAO;QACvDd,OAAOa;QACPV,OAAOU,SAASE,KAAK,EAAEC,IAAI,CAACV,MAAM,CAAC,EAAE;QACrCH,OAAOU,SAASI,gBAAgB,EAAED,IAAI,CAAC;QAEvC,MAAME,WAAWb,eAAe;YAAEC;YAAQQ,MAAM;QAAgB;QAChEd,OAAOkB;QACPf,OAAOe,SAASH,KAAK,EAAEC,IAAI,CAACV,MAAM,CAAC,EAAE;QACrCH,OAAOe,SAASD,gBAAgB,EAAED,IAAI,CAAC;QACvCb,OAAOe,SAASC,aAAa,EAAEH,IAAI,CAAC;QAEpC,MAAMI,aAAad,MAAM,CAAC,EAAE;QAC5B,MAAMe,WAAWhB,eAAe;YAAEC;YAAQQ,MAAM;QAAQ;QACxDd,OAAOqB;QACPlB,OAAOkB,SAASN,KAAK,EAAEC,IAAI,CAACI;QAC5BjB,OAAOkB,SAASJ,gBAAgB,EAAED,IAAI,CAAC;QAEvC,MAAMM,WAAWjB,eAAe;YAAEC;YAAQQ,MAAM;QAAa;QAC7Dd,OAAOsB;QACPnB,OAAOmB,SAASP,KAAK,EAAEC,IAAI,CAACI,WAAWG,eAAe,CAAC,EAAE;QACzDpB,OAAOmB,SAASL,gBAAgB,EAAED,IAAI,CAAC;QAEvC,MAAMQ,WAAWnB,eAAe;YAAEC;YAAQQ,MAAM;QAAsB;QACtEd,OAAOwB;QACPrB,OAAOqB,SAAST,KAAK,EAAEC,IAAI,CAACI,WAAWG,eAAe,CAAC,EAAE;QACzDpB,OAAOqB,SAASP,gBAAgB,EAAED,IAAI,CAAC;QACvCb,OAAOqB,SAASL,aAAa,EAAEH,IAAI,CAAC;QAEpC,MAAMS,mBAAmBL,WAAWG,eAAe,CAAC,EAAE;QACtD,MAAMG,WAAWrB,eAAe;YAAEC;YAAQQ,MAAM;QAAmB;QACnEd,OAAO0B;QACPvB,OAAOuB,SAASX,KAAK,EAAEC,IAAI,CAACS,iBAAiBF,eAAe,CAAC,EAAE;QAC/DpB,OAAOuB,SAAST,gBAAgB,EAAED,IAAI,CAAC;QAEvC,MAAMW,WAAWtB,eAAe;YAAEC;YAAQQ,MAAM;QAA0B;QAC1Ed,OAAO2B;QACPxB,OAAOwB,SAASZ,KAAK,EAAEC,IAAI,CAAC,AAACV,MAAM,CAAC,EAAE,CAASiB,eAAe,CAAC,EAAE,CAACA,eAAe,CAAC,EAAE;QACpFpB,OAAOwB,SAASV,gBAAgB,EAAED,IAAI,CAAC;QACvCb,OAAOwB,SAASR,aAAa,EAAEH,IAAI,CAAC;IACtC;IAEAd,GAAG,kCAAkC;QACnC,MAAM0B,eAAevB,eAAe;YAAEC;YAAQQ,MAAM;QAAsB;QAC1EX,OAAOyB,cAAcb,OAAOc,WAAW;QAEvC,MAAMC,cAAc,AAACxB,MAAM,CAAC,EAAE,CAASK,MAAM,EAAE,CAAC,EAAE,CAACY,iBAAiB,CAAC,EAAE;QACvEpB,OAAO2B,aAAaD,WAAW;QAC/B1B,OAAOyB,cAAcb,OAAOC,IAAI,CAACc;IACnC;AACF"}
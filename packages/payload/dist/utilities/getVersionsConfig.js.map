{"version":3,"sources":["../../src/utilities/getVersionsConfig.ts"],"sourcesContent":["import type { CollectionConfig } from '../collections/config/types.js'\nimport type { GlobalConfig } from '../globals/config/types.js'\nimport type { Autosave, SanitizedDrafts } from '../versions/types.js'\n\nimport { versionDefaults } from '../versions/defaults.js'\n\ntype EntityConfig = Pick<CollectionConfig | GlobalConfig, 'versions'>\n\n/**\n * Check if an entity has drafts enabled\n */\nexport const hasDraftsEnabled = (config: EntityConfig): boolean => {\n  return Boolean(config?.versions && typeof config.versions === 'object' && config.versions.drafts)\n}\n\n/**\n * Check if an entity has autosave enabled\n */\nexport const hasAutosaveEnabled = (\n  config: EntityConfig,\n): config is {\n  versions: {\n    drafts: { autosave: Autosave | false }\n  }\n} & EntityConfig => {\n  return Boolean(\n    config?.versions &&\n      typeof config.versions === 'object' &&\n      config.versions.drafts &&\n      typeof config.versions.drafts === 'object' &&\n      config.versions.drafts.autosave,\n  )\n}\n\n/**\n * Check if an entity has validate drafts enabled\n */\nexport const hasDraftValidationEnabled = (config: EntityConfig): boolean => {\n  return Boolean(\n    config?.versions &&\n      typeof config.versions === 'object' &&\n      config.versions.drafts &&\n      typeof config.versions.drafts === 'object' &&\n      config.versions.drafts.validate,\n  )\n}\n\nexport const hasScheduledPublishEnabled = (\n  config: EntityConfig,\n): config is {\n  versions: {\n    drafts: { schedulePublish: SanitizedDrafts['schedulePublish'] }\n  }\n} & EntityConfig => {\n  return Boolean(\n    config?.versions &&\n      typeof config.versions === 'object' &&\n      config.versions.drafts &&\n      typeof config.versions.drafts === 'object' &&\n      config.versions.drafts.schedulePublish,\n  )\n}\n\n/**\n * Get the maximum number of versions to keep for an entity\n * Returns maxPerDoc for collections or max for globals\n */\nexport const getVersionsMax = (config: EntityConfig): number => {\n  if (!config?.versions || typeof config.versions !== 'object') {\n    return 0\n  }\n  // Collections have maxPerDoc, globals have max\n  if ('maxPerDoc' in config.versions) {\n    return config.versions.maxPerDoc ?? 0\n  }\n  if ('max' in config.versions) {\n    return config.versions.max ?? 0\n  }\n  return 0\n}\n\nexport const getAutosaveInterval = (config: EntityConfig): number => {\n  let interval = versionDefaults.autosaveInterval\n  if (\n    config?.versions &&\n    typeof config.versions === 'object' &&\n    config.versions.drafts &&\n    typeof config.versions.drafts === 'object' &&\n    config.versions.drafts.autosave &&\n    typeof config.versions.drafts.autosave === 'object'\n  ) {\n    interval = config.versions.drafts.autosave.interval ?? versionDefaults.autosaveInterval\n  }\n  return interval\n}\n"],"names":["versionDefaults","hasDraftsEnabled","config","Boolean","versions","drafts","hasAutosaveEnabled","autosave","hasDraftValidationEnabled","validate","hasScheduledPublishEnabled","schedulePublish","getVersionsMax","maxPerDoc","max","getAutosaveInterval","interval","autosaveInterval"],"mappings":"AAIA,SAASA,eAAe,QAAQ,0BAAyB;AAIzD;;CAEC,GACD,OAAO,MAAMC,mBAAmB,CAACC;IAC/B,OAAOC,QAAQD,QAAQE,YAAY,OAAOF,OAAOE,QAAQ,KAAK,YAAYF,OAAOE,QAAQ,CAACC,MAAM;AAClG,EAAC;AAED;;CAEC,GACD,OAAO,MAAMC,qBAAqB,CAChCJ;IAMA,OAAOC,QACLD,QAAQE,YACN,OAAOF,OAAOE,QAAQ,KAAK,YAC3BF,OAAOE,QAAQ,CAACC,MAAM,IACtB,OAAOH,OAAOE,QAAQ,CAACC,MAAM,KAAK,YAClCH,OAAOE,QAAQ,CAACC,MAAM,CAACE,QAAQ;AAErC,EAAC;AAED;;CAEC,GACD,OAAO,MAAMC,4BAA4B,CAACN;IACxC,OAAOC,QACLD,QAAQE,YACN,OAAOF,OAAOE,QAAQ,KAAK,YAC3BF,OAAOE,QAAQ,CAACC,MAAM,IACtB,OAAOH,OAAOE,QAAQ,CAACC,MAAM,KAAK,YAClCH,OAAOE,QAAQ,CAACC,MAAM,CAACI,QAAQ;AAErC,EAAC;AAED,OAAO,MAAMC,6BAA6B,CACxCR;IAMA,OAAOC,QACLD,QAAQE,YACN,OAAOF,OAAOE,QAAQ,KAAK,YAC3BF,OAAOE,QAAQ,CAACC,MAAM,IACtB,OAAOH,OAAOE,QAAQ,CAACC,MAAM,KAAK,YAClCH,OAAOE,QAAQ,CAACC,MAAM,CAACM,eAAe;AAE5C,EAAC;AAED;;;CAGC,GACD,OAAO,MAAMC,iBAAiB,CAACV;IAC7B,IAAI,CAACA,QAAQE,YAAY,OAAOF,OAAOE,QAAQ,KAAK,UAAU;QAC5D,OAAO;IACT;IACA,+CAA+C;IAC/C,IAAI,eAAeF,OAAOE,QAAQ,EAAE;QAClC,OAAOF,OAAOE,QAAQ,CAACS,SAAS,IAAI;IACtC;IACA,IAAI,SAASX,OAAOE,QAAQ,EAAE;QAC5B,OAAOF,OAAOE,QAAQ,CAACU,GAAG,IAAI;IAChC;IACA,OAAO;AACT,EAAC;AAED,OAAO,MAAMC,sBAAsB,CAACb;IAClC,IAAIc,WAAWhB,gBAAgBiB,gBAAgB;IAC/C,IACEf,QAAQE,YACR,OAAOF,OAAOE,QAAQ,KAAK,YAC3BF,OAAOE,QAAQ,CAACC,MAAM,IACtB,OAAOH,OAAOE,QAAQ,CAACC,MAAM,KAAK,YAClCH,OAAOE,QAAQ,CAACC,MAAM,CAACE,QAAQ,IAC/B,OAAOL,OAAOE,QAAQ,CAACC,MAAM,CAACE,QAAQ,KAAK,UAC3C;QACAS,WAAWd,OAAOE,QAAQ,CAACC,MAAM,CAACE,QAAQ,CAACS,QAAQ,IAAIhB,gBAAgBiB,gBAAgB;IACzF;IACA,OAAOD;AACT,EAAC"}
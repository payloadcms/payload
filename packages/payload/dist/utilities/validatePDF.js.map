{"version":3,"sources":["../../src/utilities/validatePDF.ts"],"sourcesContent":["export function validatePDF(buffer: Buffer) {\n  // Check for PDF header\n  const header = buffer.subarray(0, 8).toString('latin1')\n  if (!header.startsWith('%PDF-')) {\n    return false\n  }\n\n  // Check for EOF marker and xref table\n  const endSize = Math.min(1024, buffer.length)\n  const end = buffer.subarray(buffer.length - endSize).toString('latin1')\n\n  if (!end.includes('%%EOF') || !end.includes('xref')) {\n    return false\n  }\n\n  return true\n}\n"],"names":["validatePDF","buffer","header","subarray","toString","startsWith","endSize","Math","min","length","end","includes"],"mappings":"AAAA,OAAO,SAASA,YAAYC,MAAc;IACxC,uBAAuB;IACvB,MAAMC,SAASD,OAAOE,QAAQ,CAAC,GAAG,GAAGC,QAAQ,CAAC;IAC9C,IAAI,CAACF,OAAOG,UAAU,CAAC,UAAU;QAC/B,OAAO;IACT;IAEA,sCAAsC;IACtC,MAAMC,UAAUC,KAAKC,GAAG,CAAC,MAAMP,OAAOQ,MAAM;IAC5C,MAAMC,MAAMT,OAAOE,QAAQ,CAACF,OAAOQ,MAAM,GAAGH,SAASF,QAAQ,CAAC;IAE9D,IAAI,CAACM,IAAIC,QAAQ,CAAC,YAAY,CAACD,IAAIC,QAAQ,CAAC,SAAS;QACnD,OAAO;IACT;IAEA,OAAO;AACT"}
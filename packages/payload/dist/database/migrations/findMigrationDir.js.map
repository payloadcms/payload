{"version":3,"sources":["../../../src/database/migrations/findMigrationDir.ts"],"sourcesContent":["import fs from 'fs'\nimport path from 'path'\n\n/**\n * Attempt to find migrations directory.\n *\n * Checks for the following directories in order:\n * - `migrationDir` argument from Payload config\n * - `src/migrations`\n * - `dist/migrations`\n * - `migrations`\n *\n * @param migrationDir\n * @default src/migrations`, if the src folder does not exists - migrations.\n * @returns\n */\nexport const findMigrationDir = (migrationDir?: string): string => {\n  const cwd = process.cwd()\n\n  const srcMigrationsDir = path.resolve(cwd, 'src/migrations')\n  const distMigrationsDir = path.resolve(cwd, 'dist/migrations')\n  const relativeMigrations = path.resolve(cwd, 'migrations')\n\n  // Use arg if provided\n  if (migrationDir) {\n    return migrationDir\n  }\n\n  // Check other common locations\n  if (fs.existsSync(srcMigrationsDir)) {\n    return srcMigrationsDir\n  }\n\n  if (fs.existsSync(distMigrationsDir)) {\n    return distMigrationsDir\n  }\n\n  if (fs.existsSync(relativeMigrations)) {\n    return relativeMigrations\n  }\n\n  if (fs.existsSync(path.resolve(cwd, 'src'))) {\n    return srcMigrationsDir\n  }\n\n  return relativeMigrations\n}\n"],"names":["fs","path","findMigrationDir","migrationDir","cwd","process","srcMigrationsDir","resolve","distMigrationsDir","relativeMigrations","existsSync"],"mappings":"AAAA,OAAOA,QAAQ,KAAI;AACnB,OAAOC,UAAU,OAAM;AAEvB;;;;;;;;;;;;CAYC,GACD,OAAO,MAAMC,mBAAmB,CAACC;IAC/B,MAAMC,MAAMC,QAAQD,GAAG;IAEvB,MAAME,mBAAmBL,KAAKM,OAAO,CAACH,KAAK;IAC3C,MAAMI,oBAAoBP,KAAKM,OAAO,CAACH,KAAK;IAC5C,MAAMK,qBAAqBR,KAAKM,OAAO,CAACH,KAAK;IAE7C,sBAAsB;IACtB,IAAID,cAAc;QAChB,OAAOA;IACT;IAEA,+BAA+B;IAC/B,IAAIH,GAAGU,UAAU,CAACJ,mBAAmB;QACnC,OAAOA;IACT;IAEA,IAAIN,GAAGU,UAAU,CAACF,oBAAoB;QACpC,OAAOA;IACT;IAEA,IAAIR,GAAGU,UAAU,CAACD,qBAAqB;QACrC,OAAOA;IACT;IAEA,IAAIT,GAAGU,UAAU,CAACT,KAAKM,OAAO,CAACH,KAAK,SAAS;QAC3C,OAAOE;IACT;IAEA,OAAOG;AACT,EAAC"}
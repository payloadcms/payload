{"version":3,"sources":["../../src/auth/cookies.spec.ts"],"sourcesContent":["import { describe, it, expect } from 'vitest'\nimport { parseCookies } from './cookies.js'\n\ndescribe('parseCookies', () => {\n  it('parses cookie attributes without values', () => {\n    const fakeHeaders = new Map()\n    fakeHeaders.set('Cookie', 'my_value=true; Secure; HttpOnly')\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.get('my_value')).toBe('true')\n    expect(parsed.get('Secure')).toBe('true')\n    expect(parsed.get('HttpOnly')).toBe('true')\n    expect(parsed.size).toBe(3)\n  })\n  it('strips whitespace', () => {\n    const fakeHeaders = new Map()\n    fakeHeaders.set('Cookie', 'my_value=true; ')\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.get('my_value')).toBe('true')\n    expect(parsed.size).toBe(1)\n  })\n\n  it('ensure invalid cookies are ignored', () => {\n    const fakeHeaders = new Map()\n    fakeHeaders.set('Cookie', 'my_value=true; invalid_cookie=%E0%A4%A')\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.get('my_value')).toBe('true')\n    expect(parsed.size).toBe(1)\n  })\n\n  it('ensure empty map is returned if there are no cookies', () => {\n    const fakeHeaders = new Map()\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.size).toBe(0)\n  })\n})\n"],"names":["describe","it","expect","parseCookies","fakeHeaders","Map","set","parsed","get","toBe","size"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,EAAE,EAAEC,MAAM,QAAQ,SAAQ;AAC7C,SAASC,YAAY,QAAQ,eAAc;AAE3CH,SAAS,gBAAgB;IACvBC,GAAG,2CAA2C;QAC5C,MAAMG,cAAc,IAAIC;QACxBD,YAAYE,GAAG,CAAC,UAAU;QAE1B,MAAMC,SAASJ,aAAaC;QAE5BF,OAAOK,OAAOC,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCP,OAAOK,OAAOC,GAAG,CAAC,WAAWC,IAAI,CAAC;QAClCP,OAAOK,OAAOC,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCP,OAAOK,OAAOG,IAAI,EAAED,IAAI,CAAC;IAC3B;IACAR,GAAG,qBAAqB;QACtB,MAAMG,cAAc,IAAIC;QACxBD,YAAYE,GAAG,CAAC,UAAU;QAE1B,MAAMC,SAASJ,aAAaC;QAE5BF,OAAOK,OAAOC,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCP,OAAOK,OAAOG,IAAI,EAAED,IAAI,CAAC;IAC3B;IAEAR,GAAG,sCAAsC;QACvC,MAAMG,cAAc,IAAIC;QACxBD,YAAYE,GAAG,CAAC,UAAU;QAE1B,MAAMC,SAASJ,aAAaC;QAE5BF,OAAOK,OAAOC,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCP,OAAOK,OAAOG,IAAI,EAAED,IAAI,CAAC;IAC3B;IAEAR,GAAG,wDAAwD;QACzD,MAAMG,cAAc,IAAIC;QAExB,MAAME,SAASJ,aAAaC;QAE5BF,OAAOK,OAAOG,IAAI,EAAED,IAAI,CAAC;IAC3B;AACF"}
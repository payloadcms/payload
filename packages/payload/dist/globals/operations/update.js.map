{"version":3,"sources":["../../../src/globals/operations/update.ts"],"sourcesContent":["import type { DeepPartial } from 'ts-essentials'\n\nimport type { GlobalSlug, JsonObject } from '../../index.js'\nimport type {\n  Operation,\n  PayloadRequest,\n  PopulateType,\n  SelectType,\n  TransformGlobalWithSelect,\n  Where,\n} from '../../types/index.js'\nimport type {\n  DataFromGlobalSlug,\n  SanitizedGlobalConfig,\n  SelectFromGlobalSlug,\n} from '../config/types.js'\n\nimport { executeAccess } from '../../auth/executeAccess.js'\nimport { afterChange } from '../../fields/hooks/afterChange/index.js'\nimport { afterRead } from '../../fields/hooks/afterRead/index.js'\nimport { beforeChange } from '../../fields/hooks/beforeChange/index.js'\nimport { beforeValidate } from '../../fields/hooks/beforeValidate/index.js'\nimport { deepCopyObjectSimple } from '../../index.js'\nimport { checkDocumentLockStatus } from '../../utilities/checkDocumentLockStatus.js'\nimport { commitTransaction } from '../../utilities/commitTransaction.js'\nimport { getSelectMode } from '../../utilities/getSelectMode.js'\nimport { hasDraftsEnabled, hasDraftValidationEnabled } from '../../utilities/getVersionsConfig.js'\nimport { initTransaction } from '../../utilities/initTransaction.js'\nimport { killTransaction } from '../../utilities/killTransaction.js'\nimport { sanitizeSelect } from '../../utilities/sanitizeSelect.js'\nimport { getLatestGlobalVersion } from '../../versions/getLatestGlobalVersion.js'\nimport { saveVersion } from '../../versions/saveVersion.js'\n\ntype Args<TSlug extends GlobalSlug> = {\n  autosave?: boolean\n  data: DeepPartial<Omit<DataFromGlobalSlug<TSlug>, 'id'>>\n  depth?: number\n  disableTransaction?: boolean\n  draft?: boolean\n  globalConfig: SanitizedGlobalConfig\n  overrideAccess?: boolean\n  overrideLock?: boolean\n  populate?: PopulateType\n  publishSpecificLocale?: string\n  req: PayloadRequest\n  select?: SelectType\n  showHiddenFields?: boolean\n  slug: string\n}\n\nexport const updateOperation = async <\n  TSlug extends GlobalSlug,\n  TSelect extends SelectFromGlobalSlug<TSlug>,\n>(\n  args: Args<TSlug>,\n): Promise<TransformGlobalWithSelect<TSlug, TSelect>> => {\n  if (args.publishSpecificLocale) {\n    args.req.locale = args.publishSpecificLocale\n  }\n\n  const {\n    slug,\n    autosave,\n    depth,\n    disableTransaction,\n    draft: draftArg,\n    globalConfig,\n    overrideAccess,\n    overrideLock,\n    populate,\n    publishSpecificLocale,\n    req: { fallbackLocale, locale, payload },\n    req,\n    select: incomingSelect,\n    showHiddenFields,\n  } = args\n\n  try {\n    const shouldCommit = !disableTransaction && (await initTransaction(req))\n\n    // /////////////////////////////////////\n    // beforeOperation - Global\n    // /////////////////////////////////////\n\n    if (globalConfig.hooks?.beforeOperation?.length) {\n      for (const hook of globalConfig.hooks.beforeOperation) {\n        args =\n          (await hook({\n            args,\n            context: args.req.context,\n            global: globalConfig,\n            operation: 'update',\n            req: args.req,\n          })) || args\n      }\n    }\n\n    let { data } = args\n\n    const isSavingDraft =\n      Boolean(draftArg && hasDraftsEnabled(globalConfig)) && data._status !== 'published'\n\n    // /////////////////////////////////////\n    // 1. Retrieve and execute access\n    // /////////////////////////////////////\n\n    const accessResults = !overrideAccess\n      ? await executeAccess(\n          {\n            data,\n            req,\n          },\n          globalConfig.access.update,\n        )\n      : true\n\n    // /////////////////////////////////////\n    // Retrieve document\n    // /////////////////////////////////////\n\n    const query: Where = overrideAccess ? undefined! : (accessResults as Where)\n\n    // /////////////////////////////////////\n    // 2. Retrieve document\n    // /////////////////////////////////////\n    const globalVersionResult = await getLatestGlobalVersion({\n      slug,\n      config: globalConfig,\n      locale: locale!,\n      payload,\n      req,\n      where: query,\n    })\n    const { global, globalExists } = globalVersionResult || {}\n\n    let globalJSON: JsonObject = {}\n\n    if (globalVersionResult && globalVersionResult.global) {\n      globalJSON = deepCopyObjectSimple(global)\n\n      if (globalJSON._id) {\n        delete globalJSON._id\n      }\n    }\n\n    const originalDoc = await afterRead({\n      collection: null,\n      context: req.context,\n      depth: 0,\n      doc: deepCopyObjectSimple(globalJSON),\n      draft: draftArg!,\n      fallbackLocale: fallbackLocale!,\n      global: globalConfig,\n      locale: locale!,\n      overrideAccess: true,\n      req,\n      showHiddenFields: showHiddenFields!,\n    })\n\n    // ///////////////////////////////////////////\n    // Handle potentially locked global documents\n    // ///////////////////////////////////////////\n\n    await checkDocumentLockStatus({\n      globalSlug: slug,\n      lockErrorMessage: `Global with slug \"${slug}\" is currently locked by another user and cannot be updated.`,\n      overrideLock,\n      req,\n    })\n\n    // /////////////////////////////////////\n    // beforeValidate - Fields\n    // /////////////////////////////////////\n\n    data = await beforeValidate({\n      collection: null,\n      context: req.context,\n      data,\n      doc: originalDoc,\n      global: globalConfig,\n      operation: 'update',\n      overrideAccess: overrideAccess!,\n      req,\n    })\n\n    // /////////////////////////////////////\n    // beforeValidate - Global\n    // /////////////////////////////////////\n\n    if (globalConfig.hooks?.beforeValidate?.length) {\n      for (const hook of globalConfig.hooks.beforeValidate) {\n        data =\n          (await hook({\n            context: req.context,\n            data,\n            global: globalConfig,\n            originalDoc,\n            req,\n          })) || data\n      }\n    }\n\n    // /////////////////////////////////////\n    // beforeChange - Global\n    // /////////////////////////////////////\n\n    if (globalConfig.hooks?.beforeChange?.length) {\n      for (const hook of globalConfig.hooks.beforeChange) {\n        data =\n          (await hook({\n            context: req.context,\n            data,\n            global: globalConfig,\n            originalDoc,\n            req,\n          })) || data\n      }\n    }\n\n    // /////////////////////////////////////\n    // beforeChange - Fields\n    // /////////////////////////////////////\n\n    const beforeChangeArgs = {\n      collection: null,\n      context: req.context,\n      data,\n      doc: originalDoc,\n      docWithLocales: globalJSON,\n      global: globalConfig,\n      operation: 'update' as Operation,\n      req,\n      skipValidation: isSavingDraft && !hasDraftValidationEnabled(globalConfig),\n    }\n\n    let result: JsonObject = await beforeChange(beforeChangeArgs)\n    let snapshotToSave: JsonObject | undefined\n\n    if (payload.config.localization && globalConfig.versions) {\n      if (publishSpecificLocale) {\n        snapshotToSave = deepCopyObjectSimple(result)\n\n        // the published data to save to the main document\n        result = await beforeChange({\n          ...beforeChangeArgs,\n          docWithLocales:\n            (\n              await getLatestGlobalVersion({\n                slug,\n                config: globalConfig,\n                payload,\n                published: true,\n                req,\n                where: query,\n              })\n            )?.global || {},\n        })\n      }\n    }\n\n    // /////////////////////////////////////\n    // Update\n    // /////////////////////////////////////\n\n    const select = sanitizeSelect({\n      fields: globalConfig.flattenedFields,\n      forceSelect: globalConfig.forceSelect,\n      select: incomingSelect,\n    })\n\n    if (!isSavingDraft) {\n      const now = new Date().toISOString()\n      // Ensure global has createdAt\n      if (!result.createdAt) {\n        result.createdAt = now\n      }\n\n      // Ensure updatedAt date is always updated\n      result.updatedAt = now\n\n      if (globalExists) {\n        result = await payload.db.updateGlobal({\n          slug,\n          data: result,\n          req,\n          select,\n        })\n      } else {\n        result = await payload.db.createGlobal({\n          slug,\n          data: result,\n          req,\n        })\n      }\n    }\n\n    // /////////////////////////////////////\n    // Create version\n    // /////////////////////////////////////\n    if (globalConfig.versions) {\n      const { globalType } = result\n      result = await saveVersion({\n        autosave,\n        docWithLocales: result,\n        draft: isSavingDraft,\n        global: globalConfig,\n        operation: 'update',\n        payload,\n        publishSpecificLocale,\n        req,\n        select,\n        snapshot: snapshotToSave,\n      })\n\n      result = {\n        ...result,\n        globalType,\n      }\n    }\n\n    // /////////////////////////////////////\n    // Execute globalType field if not selected\n    // /////////////////////////////////////\n    if (select && result.globalType) {\n      const selectMode = getSelectMode(select)\n      if (\n        (selectMode === 'include' && !select['globalType']) ||\n        (selectMode === 'exclude' && select['globalType'] === false)\n      ) {\n        delete result['globalType']\n      }\n    }\n\n    // /////////////////////////////////////\n    // afterRead - Fields\n    // /////////////////////////////////////\n\n    result = await afterRead({\n      collection: null,\n      context: req.context,\n      depth: depth!,\n      doc: result,\n      draft: draftArg!,\n      fallbackLocale: null,\n      global: globalConfig,\n      locale: locale!,\n      overrideAccess: overrideAccess!,\n      populate,\n      req,\n      select,\n      showHiddenFields: showHiddenFields!,\n    })\n\n    // /////////////////////////////////////\n    // afterRead - Global\n    // /////////////////////////////////////\n\n    if (globalConfig.hooks?.afterRead?.length) {\n      for (const hook of globalConfig.hooks.afterRead) {\n        result =\n          (await hook({\n            context: req.context,\n            doc: result,\n            global: globalConfig,\n            req,\n          })) || result\n      }\n    }\n\n    // /////////////////////////////////////\n    // afterChange - Fields\n    // /////////////////////////////////////\n\n    result = await afterChange({\n      collection: null,\n      context: req.context,\n      data,\n      doc: result,\n      global: globalConfig,\n      operation: 'update',\n      previousDoc: originalDoc,\n      req,\n    })\n\n    // /////////////////////////////////////\n    // afterChange - Global\n    // /////////////////////////////////////\n\n    if (globalConfig.hooks?.afterChange?.length) {\n      for (const hook of globalConfig.hooks.afterChange) {\n        result =\n          (await hook({\n            context: req.context,\n            data,\n            doc: result,\n            global: globalConfig,\n            previousDoc: originalDoc,\n            req,\n          })) || result\n      }\n    }\n\n    // /////////////////////////////////////\n    // Return results\n    // /////////////////////////////////////\n\n    if (shouldCommit) {\n      await commitTransaction(req)\n    }\n\n    return result as TransformGlobalWithSelect<TSlug, TSelect>\n  } catch (error: unknown) {\n    await killTransaction(req)\n    throw error\n  }\n}\n"],"names":["executeAccess","afterChange","afterRead","beforeChange","beforeValidate","deepCopyObjectSimple","checkDocumentLockStatus","commitTransaction","getSelectMode","hasDraftsEnabled","hasDraftValidationEnabled","initTransaction","killTransaction","sanitizeSelect","getLatestGlobalVersion","saveVersion","updateOperation","args","publishSpecificLocale","req","locale","slug","autosave","depth","disableTransaction","draft","draftArg","globalConfig","overrideAccess","overrideLock","populate","fallbackLocale","payload","select","incomingSelect","showHiddenFields","shouldCommit","hooks","beforeOperation","length","hook","context","global","operation","data","isSavingDraft","Boolean","_status","accessResults","access","update","query","undefined","globalVersionResult","config","where","globalExists","globalJSON","_id","originalDoc","collection","doc","globalSlug","lockErrorMessage","beforeChangeArgs","docWithLocales","skipValidation","result","snapshotToSave","localization","versions","published","fields","flattenedFields","forceSelect","now","Date","toISOString","createdAt","updatedAt","db","updateGlobal","createGlobal","globalType","snapshot","selectMode","previousDoc","error"],"mappings":"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"}
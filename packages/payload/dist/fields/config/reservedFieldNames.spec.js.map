{"version":3,"sources":["../../../src/fields/config/reservedFieldNames.spec.ts"],"sourcesContent":["import type { Config } from '../../config/types.js'\nimport type { CollectionConfig, Field } from '../../index.js'\n\nimport { ReservedFieldName } from '../../errors/index.js'\nimport { sanitizeCollection } from '../../collections/config/sanitize.js'\nimport { describe, it, expect } from 'vitest'\n\ndescribe('reservedFieldNames - collections -', () => {\n  const config = {\n    collections: [],\n    globals: [],\n  } as Partial<Config>\n\n  describe('uploads -', () => {\n    const collectionWithUploads: CollectionConfig = {\n      slug: 'collection-with-uploads',\n      fields: [],\n      upload: true,\n    }\n\n    it('should throw on file', async () => {\n      const fields: Field[] = [\n        {\n          name: 'file',\n          type: 'text',\n          label: 'some-collection',\n        },\n      ]\n\n      await expect(async () => {\n        await sanitizeCollection(\n          // @ts-expect-error\n          {\n            ...config,\n            collections: [\n              {\n                ...collectionWithUploads,\n                fields,\n              },\n            ],\n          },\n          {\n            ...collectionWithUploads,\n            fields,\n          },\n        )\n      }).rejects.toThrow(ReservedFieldName)\n    })\n\n    it('should not throw on a custom field', async () => {\n      const fields: Field[] = [\n        {\n          name: 'customField',\n          type: 'text',\n          label: 'some-collection',\n        },\n      ]\n\n      await expect(async () => {\n        await sanitizeCollection(\n          // @ts-expect-error\n          {\n            ...config,\n            collections: [\n              {\n                ...collectionWithUploads,\n                fields,\n              },\n            ],\n          },\n          {\n            ...collectionWithUploads,\n            fields,\n          },\n        )\n      }).not.toThrow()\n    })\n  })\n\n  describe('auth -', () => {\n    const collectionWithAuth: CollectionConfig = {\n      slug: 'collection-with-auth',\n      auth: {\n        loginWithUsername: true,\n        useAPIKey: true,\n        verify: true,\n      },\n      fields: [],\n    }\n\n    it('should throw on hash', async () => {\n      const fields: Field[] = [\n        {\n          name: 'hash',\n          type: 'text',\n          label: 'some-collection',\n        },\n      ]\n\n      await expect(async () => {\n        await sanitizeCollection(\n          // @ts-expect-error\n          {\n            ...config,\n            collections: [\n              {\n                ...collectionWithAuth,\n                fields,\n              },\n            ],\n          },\n          {\n            ...collectionWithAuth,\n            fields,\n          },\n        )\n      }).rejects.toThrow(ReservedFieldName)\n    })\n\n    it('should throw on salt', async () => {\n      const fields: Field[] = [\n        {\n          name: 'salt',\n          type: 'text',\n          label: 'some-collection',\n        },\n      ]\n\n      await expect(async () => {\n        await sanitizeCollection(\n          // @ts-expect-error\n          {\n            ...config,\n            collections: [\n              {\n                ...collectionWithAuth,\n                fields,\n              },\n            ],\n          },\n          {\n            ...collectionWithAuth,\n            fields,\n          },\n        )\n      }).rejects.toThrow(ReservedFieldName)\n    })\n\n    it('should not throw on a custom field', async () => {\n      const fields: Field[] = [\n        {\n          name: 'customField',\n          type: 'text',\n          label: 'some-collection',\n        },\n      ]\n\n      await expect(async () => {\n        await sanitizeCollection(\n          // @ts-expect-error\n          {\n            ...config,\n            collections: [\n              {\n                ...collectionWithAuth,\n                fields,\n              },\n            ],\n          },\n          {\n            ...collectionWithAuth,\n            fields,\n          },\n        )\n      }).not.toThrow()\n    })\n  })\n})\n"],"names":["ReservedFieldName","sanitizeCollection","describe","it","expect","config","collections","globals","collectionWithUploads","slug","fields","upload","name","type","label","rejects","toThrow","not","collectionWithAuth","auth","loginWithUsername","useAPIKey","verify"],"mappings":"AAGA,SAASA,iBAAiB,QAAQ,wBAAuB;AACzD,SAASC,kBAAkB,QAAQ,uCAAsC;AACzE,SAASC,QAAQ,EAAEC,EAAE,EAAEC,MAAM,QAAQ,SAAQ;AAE7CF,SAAS,sCAAsC;IAC7C,MAAMG,SAAS;QACbC,aAAa,EAAE;QACfC,SAAS,EAAE;IACb;IAEAL,SAAS,aAAa;QACpB,MAAMM,wBAA0C;YAC9CC,MAAM;YACNC,QAAQ,EAAE;YACVC,QAAQ;QACV;QAEAR,GAAG,wBAAwB;YACzB,MAAMO,SAAkB;gBACtB;oBACEE,MAAM;oBACNC,MAAM;oBACNC,OAAO;gBACT;aACD;YAED,MAAMV,OAAO;gBACX,MAAMH,mBACJ,mBAAmB;gBACnB;oBACE,GAAGI,MAAM;oBACTC,aAAa;wBACX;4BACE,GAAGE,qBAAqB;4BACxBE;wBACF;qBACD;gBACH,GACA;oBACE,GAAGF,qBAAqB;oBACxBE;gBACF;YAEJ,GAAGK,OAAO,CAACC,OAAO,CAAChB;QACrB;QAEAG,GAAG,sCAAsC;YACvC,MAAMO,SAAkB;gBACtB;oBACEE,MAAM;oBACNC,MAAM;oBACNC,OAAO;gBACT;aACD;YAED,MAAMV,OAAO;gBACX,MAAMH,mBACJ,mBAAmB;gBACnB;oBACE,GAAGI,MAAM;oBACTC,aAAa;wBACX;4BACE,GAAGE,qBAAqB;4BACxBE;wBACF;qBACD;gBACH,GACA;oBACE,GAAGF,qBAAqB;oBACxBE;gBACF;YAEJ,GAAGO,GAAG,CAACD,OAAO;QAChB;IACF;IAEAd,SAAS,UAAU;QACjB,MAAMgB,qBAAuC;YAC3CT,MAAM;YACNU,MAAM;gBACJC,mBAAmB;gBACnBC,WAAW;gBACXC,QAAQ;YACV;YACAZ,QAAQ,EAAE;QACZ;QAEAP,GAAG,wBAAwB;YACzB,MAAMO,SAAkB;gBACtB;oBACEE,MAAM;oBACNC,MAAM;oBACNC,OAAO;gBACT;aACD;YAED,MAAMV,OAAO;gBACX,MAAMH,mBACJ,mBAAmB;gBACnB;oBACE,GAAGI,MAAM;oBACTC,aAAa;wBACX;4BACE,GAAGY,kBAAkB;4BACrBR;wBACF;qBACD;gBACH,GACA;oBACE,GAAGQ,kBAAkB;oBACrBR;gBACF;YAEJ,GAAGK,OAAO,CAACC,OAAO,CAAChB;QACrB;QAEAG,GAAG,wBAAwB;YACzB,MAAMO,SAAkB;gBACtB;oBACEE,MAAM;oBACNC,MAAM;oBACNC,OAAO;gBACT;aACD;YAED,MAAMV,OAAO;gBACX,MAAMH,mBACJ,mBAAmB;gBACnB;oBACE,GAAGI,MAAM;oBACTC,aAAa;wBACX;4BACE,GAAGY,kBAAkB;4BACrBR;wBACF;qBACD;gBACH,GACA;oBACE,GAAGQ,kBAAkB;oBACrBR;gBACF;YAEJ,GAAGK,OAAO,CAACC,OAAO,CAAChB;QACrB;QAEAG,GAAG,sCAAsC;YACvC,MAAMO,SAAkB;gBACtB;oBACEE,MAAM;oBACNC,MAAM;oBACNC,OAAO;gBACT;aACD;YAED,MAAMV,OAAO;gBACX,MAAMH,mBACJ,mBAAmB;gBACnB;oBACE,GAAGI,MAAM;oBACTC,aAAa;wBACX;4BACE,GAAGY,kBAAkB;4BACrBR;wBACF;qBACD;gBACH,GACA;oBACE,GAAGQ,kBAAkB;oBACrBR;gBACF;YAEJ,GAAGO,GAAG,CAACD,OAAO;QAChB;IACF;AACF"}
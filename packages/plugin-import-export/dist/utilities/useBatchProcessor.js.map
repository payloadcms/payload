{"version":3,"sources":["../../src/utilities/useBatchProcessor.ts"],"sourcesContent":["/**\n * Generic batch processing utilities for import/export operations.\n * This module provides reusable types and helper functions for processing\n * items in batches with error handling and result aggregation.\n */\n\n/**\n * Core batch processing options\n */\nexport interface BatchProcessorOptions {\n  batchSize?: number\n}\n\n/**\n * Generic error type for batch operations\n */\nexport interface BatchError<TItem = unknown> {\n  error: string\n  item: TItem\n  itemIndex: number\n  type: 'custom' | 'database' | 'duplicate' | 'notFound' | 'unknown' | 'validation'\n}\n\n/**\n * Generic success result for a single item\n */\nexport interface BatchItemResult<TItem = unknown, TResult = unknown> {\n  index: number\n  item: TItem\n  operation?: string\n  result: TResult\n}\n\n/**\n * Result from processing a single batch\n */\nexport interface BatchResult<TItem = unknown, TResult = unknown> {\n  failed: Array<BatchError<TItem>>\n  successful: Array<BatchItemResult<TItem, TResult>>\n}\n\n/**\n * Final aggregated result from processing all batches\n */\nexport interface ProcessResult<TItem = unknown> {\n  errors: Array<{ error: string; index: number; item: TItem }>\n  processedCount: number\n  total: number\n}\n\n/**\n * Split an array of items into batches of a specified size.\n *\n * @param items - The array of items to split into batches\n * @param batchSize - The maximum number of items per batch\n * @returns An array of batches, where each batch is an array of items\n *\n * @example\n * ```ts\n * const items = [1, 2, 3, 4, 5];\n * const batches = createBatches(items, 2);\n * // Result: [[1, 2], [3, 4], [5]]\n * ```\n */\nexport function createBatches<T>(items: T[], batchSize: number): T[][] {\n  const batches: T[][] = []\n  for (let i = 0; i < items.length; i += batchSize) {\n    batches.push(items.slice(i, i + batchSize))\n  }\n  return batches\n}\n\n/**\n * Extract a human-readable error message from an unknown error value.\n *\n * @param error - The error value to extract a message from\n * @returns A string representation of the error message\n *\n * @example\n * ```ts\n * extractErrorMessage(new Error('Something went wrong'));\n * // Result: 'Something went wrong'\n *\n * extractErrorMessage({ message: 'Custom error' });\n * // Result: 'Custom error'\n *\n * extractErrorMessage('String error');\n * // Result: 'String error'\n * ```\n */\nexport function extractErrorMessage(error: unknown): string {\n  if (error instanceof Error) {\n    return error.message\n  }\n\n  if (error && typeof error === 'object' && 'message' in error) {\n    return String(error.message)\n  }\n\n  return String(error)\n}\n\n/**\n * Categorize an error based on its message content.\n * This helps provide more specific error types for better error handling.\n *\n * @param error - The error to categorize\n * @returns The categorized error type\n *\n * @example\n * ```ts\n * categorizeError(new Error('Validation failed'));\n * // Result: 'validation'\n *\n * categorizeError(new Error('Document not found'));\n * // Result: 'notFound'\n *\n * categorizeError(new Error('Duplicate key error'));\n * // Result: 'duplicate'\n * ```\n */\nexport function categorizeError(error: unknown): BatchError['type'] {\n  const message = extractErrorMessage(error).toLowerCase()\n\n  if (message.includes('validation')) {\n    return 'validation'\n  }\n\n  if (message.includes('not found')) {\n    return 'notFound'\n  }\n\n  if (message.includes('duplicate') || message.includes('unique')) {\n    return 'duplicate'\n  }\n\n  if (message.includes('database') || message.includes('transaction')) {\n    return 'database'\n  }\n\n  return 'unknown'\n}\n"],"names":["createBatches","items","batchSize","batches","i","length","push","slice","extractErrorMessage","error","Error","message","String","categorizeError","toLowerCase","includes"],"mappings":"AAAA;;;;CAIC,GAED;;CAEC,GA0CD;;;;;;;;;;;;;CAaC,GACD,OAAO,SAASA,cAAiBC,KAAU,EAAEC,SAAiB;IAC5D,MAAMC,UAAiB,EAAE;IACzB,IAAK,IAAIC,IAAI,GAAGA,IAAIH,MAAMI,MAAM,EAAED,KAAKF,UAAW;QAChDC,QAAQG,IAAI,CAACL,MAAMM,KAAK,CAACH,GAAGA,IAAIF;IAClC;IACA,OAAOC;AACT;AAEA;;;;;;;;;;;;;;;;;CAiBC,GACD,OAAO,SAASK,oBAAoBC,KAAc;IAChD,IAAIA,iBAAiBC,OAAO;QAC1B,OAAOD,MAAME,OAAO;IACtB;IAEA,IAAIF,SAAS,OAAOA,UAAU,YAAY,aAAaA,OAAO;QAC5D,OAAOG,OAAOH,MAAME,OAAO;IAC7B;IAEA,OAAOC,OAAOH;AAChB;AAEA;;;;;;;;;;;;;;;;;;CAkBC,GACD,OAAO,SAASI,gBAAgBJ,KAAc;IAC5C,MAAME,UAAUH,oBAAoBC,OAAOK,WAAW;IAEtD,IAAIH,QAAQI,QAAQ,CAAC,eAAe;QAClC,OAAO;IACT;IAEA,IAAIJ,QAAQI,QAAQ,CAAC,cAAc;QACjC,OAAO;IACT;IAEA,IAAIJ,QAAQI,QAAQ,CAAC,gBAAgBJ,QAAQI,QAAQ,CAAC,WAAW;QAC/D,OAAO;IACT;IAEA,IAAIJ,QAAQI,QAAQ,CAAC,eAAeJ,QAAQI,QAAQ,CAAC,gBAAgB;QACnE,OAAO;IACT;IAEA,OAAO;AACT"}
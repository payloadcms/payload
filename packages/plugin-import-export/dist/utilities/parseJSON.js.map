{"version":3,"sources":["../../src/utilities/parseJSON.ts"],"sourcesContent":["import type { PayloadRequest } from 'payload'\n\nimport { APIError } from 'payload'\n\nexport type ParseJSONArgs = {\n  data: Buffer | string\n  req: PayloadRequest\n}\n\n/**\n * Parses JSON data into an array of record objects.\n * Validates that the input is an array of documents.\n */\nexport const parseJSON = ({ data, req }: ParseJSONArgs): Record<string, unknown>[] => {\n  try {\n    const content = typeof data === 'string' ? data : data.toString('utf-8')\n    const parsed = JSON.parse(content)\n\n    if (!Array.isArray(parsed)) {\n      throw new APIError('JSON import data must be an array of documents')\n    }\n\n    return parsed\n  } catch (err) {\n    req.payload.logger.error({ err, msg: 'Error parsing JSON' })\n    if (err instanceof APIError) {\n      throw err\n    }\n    throw new APIError('Invalid JSON format')\n  }\n}\n"],"names":["APIError","parseJSON","data","req","content","toString","parsed","JSON","parse","Array","isArray","err","payload","logger","error","msg"],"mappings":"AAEA,SAASA,QAAQ,QAAQ,UAAS;AAOlC;;;CAGC,GACD,OAAO,MAAMC,YAAY,CAAC,EAAEC,IAAI,EAAEC,GAAG,EAAiB;IACpD,IAAI;QACF,MAAMC,UAAU,OAAOF,SAAS,WAAWA,OAAOA,KAAKG,QAAQ,CAAC;QAChE,MAAMC,SAASC,KAAKC,KAAK,CAACJ;QAE1B,IAAI,CAACK,MAAMC,OAAO,CAACJ,SAAS;YAC1B,MAAM,IAAIN,SAAS;QACrB;QAEA,OAAOM;IACT,EAAE,OAAOK,KAAK;QACZR,IAAIS,OAAO,CAACC,MAAM,CAACC,KAAK,CAAC;YAAEH;YAAKI,KAAK;QAAqB;QAC1D,IAAIJ,eAAeX,UAAU;YAC3B,MAAMW;QACR;QACA,MAAM,IAAIX,SAAS;IACrB;AACF,EAAC"}
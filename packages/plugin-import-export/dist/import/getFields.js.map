{"version":3,"sources":["../../src/import/getFields.ts"],"sourcesContent":["import type { Config, Field } from 'payload'\n\ntype GetFieldsOptions = {\n  collectionSlugs?: string[]\n}\n\nexport const getFields = (config: Config, options?: GetFieldsOptions): Field[] => {\n  const collectionOptions =\n    options?.collectionSlugs || config.collections?.map(({ slug }) => slug) || []\n\n  return [\n    {\n      name: 'collectionSlug',\n      type: 'select',\n      options: collectionOptions,\n      required: true,\n\n      admin: {\n        components: {\n          Field: '@payloadcms/plugin-import-export/rsc#ImportCollectionField',\n        },\n      },\n      // @ts-expect-error - this is not correctly typed in plugins right now\n      label: ({ t }) => t('plugin-import-export:field-collectionSlug-label'),\n      validate: (value: any) => {\n        if (!value) {\n          return 'Collection is required'\n        }\n        return true\n      },\n    },\n    {\n      name: 'importMode',\n      type: 'select',\n      // @ts-expect-error - this is not correctly typed in plugins right now\n      label: ({ t }) => t('plugin-import-export:field-importMode-label'),\n      options: [\n        {\n          // @ts-expect-error - this is not correctly typed in plugins right now\n          label: ({ t }) => t('plugin-import-export:field-importMode-create-label'),\n          value: 'create',\n        },\n        {\n          // @ts-expect-error - this is not correctly typed in plugins right now\n          label: ({ t }) => t('plugin-import-export:field-importMode-update-label'),\n          value: 'update',\n        },\n        {\n          // @ts-expect-error - this is not correctly typed in plugins right now\n          label: ({ t }) => t('plugin-import-export:field-importMode-upsert-label'),\n          value: 'upsert',\n        },\n      ],\n    },\n    {\n      name: 'matchField',\n      type: 'text',\n      admin: {\n        condition: (_, siblingData) => siblingData?.importMode !== 'create',\n        // @ts-expect-error - this is not correctly typed in plugins right now\n        description: ({ t }) => t('plugin-import-export:field-matchField-description'),\n      },\n      defaultValue: 'id',\n      // @ts-expect-error - this is not correctly typed in plugins right now\n      label: ({ t }) => t('plugin-import-export:field-matchField-label'),\n    },\n    {\n      name: 'status',\n      type: 'select',\n      admin: {\n        readOnly: true,\n      },\n      defaultValue: 'pending',\n      // @ts-expect-error - this is not correctly typed in plugins right now\n      label: ({ t }) => t('plugin-import-export:field-status-label'),\n      options: [\n        {\n          label: 'Pending',\n          value: 'pending',\n        },\n        {\n          label: 'Completed',\n          value: 'completed',\n        },\n        {\n          label: 'Partial',\n          value: 'partial',\n        },\n        {\n          label: 'Failed',\n          value: 'failed',\n        },\n      ],\n    },\n    {\n      name: 'summary',\n      type: 'group',\n      admin: {\n        condition: (data) =>\n          data?.status === 'completed' || data?.status === 'partial' || data?.status === 'failed',\n      },\n      fields: [\n        {\n          name: 'imported',\n          type: 'number',\n          admin: {\n            readOnly: true,\n          },\n          label: 'Imported',\n        },\n        {\n          name: 'updated',\n          type: 'number',\n          admin: {\n            readOnly: true,\n          },\n          label: 'Updated',\n        },\n        {\n          name: 'total',\n          type: 'number',\n          admin: {\n            readOnly: true,\n          },\n          label: 'Total',\n        },\n        {\n          name: 'issues',\n          type: 'number',\n          admin: {\n            readOnly: true,\n          },\n          label: 'Issues',\n        },\n        {\n          name: 'issueDetails',\n          type: 'json',\n          admin: {\n            condition: (_, siblingData) => siblingData?.issues > 0,\n            readOnly: true,\n          },\n          label: 'Issue Details',\n        },\n      ],\n      // @ts-expect-error - this is not correctly typed in plugins right now\n      label: ({ t }) => t('plugin-import-export:field-summary-label'),\n    },\n    {\n      name: 'preview',\n      type: 'ui',\n      admin: {\n        components: {\n          Field: '@payloadcms/plugin-import-export/rsc#ImportPreview',\n        },\n      },\n    },\n  ]\n}\n"],"names":["getFields","config","options","collectionOptions","collectionSlugs","collections","map","slug","name","type","required","admin","components","Field","label","t","validate","value","condition","_","siblingData","importMode","description","defaultValue","readOnly","data","status","fields","issues"],"mappings":"AAMA,OAAO,MAAMA,YAAY,CAACC,QAAgBC;IACxC,MAAMC,oBACJD,SAASE,mBAAmBH,OAAOI,WAAW,EAAEC,IAAI,CAAC,EAAEC,IAAI,EAAE,GAAKA,SAAS,EAAE;IAE/E,OAAO;QACL;YACEC,MAAM;YACNC,MAAM;YACNP,SAASC;YACTO,UAAU;YAEVC,OAAO;gBACLC,YAAY;oBACVC,OAAO;gBACT;YACF;YACA,sEAAsE;YACtEC,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;YACpBC,UAAU,CAACC;gBACT,IAAI,CAACA,OAAO;oBACV,OAAO;gBACT;gBACA,OAAO;YACT;QACF;QACA;YACET,MAAM;YACNC,MAAM;YACN,sEAAsE;YACtEK,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;YACpBb,SAAS;gBACP;oBACE,sEAAsE;oBACtEY,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;oBACpBE,OAAO;gBACT;gBACA;oBACE,sEAAsE;oBACtEH,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;oBACpBE,OAAO;gBACT;gBACA;oBACE,sEAAsE;oBACtEH,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;oBACpBE,OAAO;gBACT;aACD;QACH;QACA;YACET,MAAM;YACNC,MAAM;YACNE,OAAO;gBACLO,WAAW,CAACC,GAAGC,cAAgBA,aAAaC,eAAe;gBAC3D,sEAAsE;gBACtEC,aAAa,CAAC,EAAEP,CAAC,EAAE,GAAKA,EAAE;YAC5B;YACAQ,cAAc;YACd,sEAAsE;YACtET,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;QACtB;QACA;YACEP,MAAM;YACNC,MAAM;YACNE,OAAO;gBACLa,UAAU;YACZ;YACAD,cAAc;YACd,sEAAsE;YACtET,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;YACpBb,SAAS;gBACP;oBACEY,OAAO;oBACPG,OAAO;gBACT;gBACA;oBACEH,OAAO;oBACPG,OAAO;gBACT;gBACA;oBACEH,OAAO;oBACPG,OAAO;gBACT;gBACA;oBACEH,OAAO;oBACPG,OAAO;gBACT;aACD;QACH;QACA;YACET,MAAM;YACNC,MAAM;YACNE,OAAO;gBACLO,WAAW,CAACO,OACVA,MAAMC,WAAW,eAAeD,MAAMC,WAAW,aAAaD,MAAMC,WAAW;YACnF;YACAC,QAAQ;gBACN;oBACEnB,MAAM;oBACNC,MAAM;oBACNE,OAAO;wBACLa,UAAU;oBACZ;oBACAV,OAAO;gBACT;gBACA;oBACEN,MAAM;oBACNC,MAAM;oBACNE,OAAO;wBACLa,UAAU;oBACZ;oBACAV,OAAO;gBACT;gBACA;oBACEN,MAAM;oBACNC,MAAM;oBACNE,OAAO;wBACLa,UAAU;oBACZ;oBACAV,OAAO;gBACT;gBACA;oBACEN,MAAM;oBACNC,MAAM;oBACNE,OAAO;wBACLa,UAAU;oBACZ;oBACAV,OAAO;gBACT;gBACA;oBACEN,MAAM;oBACNC,MAAM;oBACNE,OAAO;wBACLO,WAAW,CAACC,GAAGC,cAAgBA,aAAaQ,SAAS;wBACrDJ,UAAU;oBACZ;oBACAV,OAAO;gBACT;aACD;YACD,sEAAsE;YACtEA,OAAO,CAAC,EAAEC,CAAC,EAAE,GAAKA,EAAE;QACtB;QACA;YACEP,MAAM;YACNC,MAAM;YACNE,OAAO;gBACLC,YAAY;oBACVC,OAAO;gBACT;YACF;QACF;KACD;AACH,EAAC"}
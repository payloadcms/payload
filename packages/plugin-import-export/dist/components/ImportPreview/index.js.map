{"version":3,"sources":["../../../src/components/ImportPreview/index.tsx"],"sourcesContent":["'use client'\nimport type { Column } from '@payloadcms/ui'\nimport type { ClientField, ConditionalDateProps, PaginatedDocs } from 'payload'\n\nimport { getTranslation } from '@payloadcms/translations'\nimport {\n  Pagination,\n  PerPage,\n  Table,\n  Translation,\n  useConfig,\n  useDebouncedEffect,\n  useDocumentInfo,\n  useField,\n  useFormFields,\n  useTranslation,\n} from '@payloadcms/ui'\nimport { formatDocTitle } from '@payloadcms/ui/shared'\nimport { fieldAffectsData } from 'payload/shared'\nimport React, { useState, useTransition } from 'react'\n\nimport type {\n  PluginImportExportTranslationKeys,\n  PluginImportExportTranslations,\n} from '../../translations/index.js'\nimport type { ImportPreviewResponse } from '../../types.js'\n\nimport { DEFAULT_PREVIEW_LIMIT, PREVIEW_LIMIT_OPTIONS } from '../../constants.js'\nimport './index.scss'\n\nconst baseClass = 'import-preview'\n\nexport const ImportPreview: React.FC = () => {\n  const [isPending, startTransition] = useTransition()\n  const {\n    config,\n    config: { routes },\n  } = useConfig()\n  const { collectionSlug } = useDocumentInfo()\n  const { i18n, t } = useTranslation<\n    PluginImportExportTranslations,\n    PluginImportExportTranslationKeys\n  >()\n\n  const { value: targetCollectionSlug } = useField<string>({ path: 'collectionSlug' })\n  const { value: importMode } = useField<string>({ path: 'importMode' })\n  const { value: matchField } = useField<string>({ path: 'matchField' })\n  const { value: filename } = useField<string>({ path: 'filename' })\n  const { value: url } = useField<string>({ path: 'url' })\n  const { value: mimeType } = useField<string>({ path: 'mimeType' })\n  const { value: status } = useField<string>({ path: 'status' })\n  const { value: summary } = useField<any>({ path: 'summary' })\n\n  // Access the file field directly from form fields\n  const fileField = useFormFields(([fields]) => fields?.file || null)\n\n  const [dataToRender, setDataToRender] = useState<Record<string, unknown>[]>([])\n  const [columns, setColumns] = useState<Column[]>([])\n  const [totalDocs, setTotalDocs] = useState<number>(0)\n  const [error, setError] = useState<null | string>(null)\n\n  // Preview pagination state\n  const [previewPage, setPreviewPage] = useState(1)\n  const [previewLimit, setPreviewLimit] = useState(DEFAULT_PREVIEW_LIMIT)\n  const [paginationData, setPaginationData] = useState<null | Pick<\n    PaginatedDocs,\n    'hasNextPage' | 'hasPrevPage' | 'limit' | 'nextPage' | 'page' | 'prevPage' | 'totalPages'\n  >>(null)\n\n  const collectionConfig = React.useMemo(\n    () => config.collections.find((c) => c.slug === targetCollectionSlug),\n    [targetCollectionSlug, config.collections],\n  )\n\n  useDebouncedEffect(\n    () => {\n      if (!collectionSlug || !targetCollectionSlug) {\n        return\n      }\n\n      if (!targetCollectionSlug || (!url && !fileField?.value)) {\n        setDataToRender([])\n        setColumns([])\n        setTotalDocs(0)\n        setPaginationData(null)\n        return\n      }\n\n      if (!collectionConfig) {\n        setDataToRender([])\n        setColumns([])\n        setTotalDocs(0)\n        setPaginationData(null)\n        return\n      }\n\n      const abortController = new AbortController()\n\n      const processFileData = async () => {\n        setError(null)\n\n        try {\n          // Determine format from file\n          let format: 'csv' | 'json' = 'json'\n          if (fileField?.value && fileField.value instanceof File) {\n            const file = fileField.value\n            format = file.type === 'text/csv' || file.name?.endsWith('.csv') ? 'csv' : 'json'\n          } else if (mimeType === 'text/csv' || filename?.endsWith('.csv')) {\n            format = 'csv'\n          }\n\n          // Get file data as base64\n          let fileData: string | undefined\n\n          if (fileField?.value && fileField.value instanceof File) {\n            // File is being uploaded, read its contents\n            const arrayBuffer = await fileField.value.arrayBuffer()\n            const base64 = Buffer.from(arrayBuffer).toString('base64')\n            fileData = base64\n          } else if (url) {\n            // File has been saved, fetch from URL\n            const response = await fetch(url, { signal: abortController.signal })\n            if (!response.ok) {\n              throw new Error('Failed to fetch file')\n            }\n            const arrayBuffer = await response.arrayBuffer()\n            const base64 = Buffer.from(arrayBuffer).toString('base64')\n            fileData = base64\n          }\n\n          if (!fileData) {\n            setDataToRender([])\n            setColumns([])\n            setTotalDocs(0)\n            setPaginationData(null)\n            return\n          }\n\n          // Fetch transformed data from the server\n          const res = await fetch(`${routes.api}/${collectionSlug}/preview-data`, {\n            body: JSON.stringify({\n              collectionSlug: targetCollectionSlug,\n              fileData,\n              format,\n              previewLimit,\n              previewPage,\n            }),\n            credentials: 'include',\n            headers: { 'Content-Type': 'application/json' },\n            method: 'POST',\n            signal: abortController.signal,\n          })\n\n          if (!res.ok) {\n            throw new Error('Failed to process file')\n          }\n\n          const {\n            docs,\n            hasNextPage,\n            hasPrevPage,\n            limit: responseLimit,\n            page: responsePage,\n            totalDocs: serverTotalDocs,\n            totalPages,\n          }: ImportPreviewResponse = await res.json()\n\n          setTotalDocs(serverTotalDocs)\n          setPaginationData({\n            hasNextPage,\n            hasPrevPage,\n            limit: responseLimit,\n            nextPage: responsePage + 1,\n            page: responsePage,\n            prevPage: responsePage - 1,\n            totalPages,\n          })\n\n          if (!Array.isArray(docs) || docs.length === 0) {\n            setDataToRender([])\n            setColumns([])\n            return\n          }\n\n          // Build columns from collection fields without traverseFields\n          const buildColumnsFromFields = (\n            fields: ClientField[],\n            parentPath = '',\n            parentLabel = '',\n          ): Column[] => {\n            const cols: Column[] = []\n\n            fields.forEach((field) => {\n              if (!fieldAffectsData(field) || field.admin?.disabled) {\n                return\n              }\n\n              // Build the field path\n              const fieldPath = parentPath ? `${parentPath}.${field.name}` : field.name\n\n              // Get the field label\n              let label = field.name\n              if ('label' in field && field.label) {\n                label = getTranslation(field.label, i18n)\n              }\n\n              // Add parent label prefix if in a group\n              if (parentLabel) {\n                label = `${parentLabel} > ${label}`\n              }\n\n              // Skip if this field doesn't exist in any document\n              const hasData = docs.some((doc) => {\n                const value = getValueAtPath(doc, fieldPath)\n                return value !== undefined && value !== null\n              })\n\n              if (!hasData && field.type !== 'relationship') {\n                return\n              }\n\n              cols.push({\n                accessor: fieldPath,\n                active: true,\n                field,\n                Heading: label,\n                renderedCells: docs.map((doc) => {\n                  const value = getValueAtPath(doc, fieldPath)\n\n                  if (value === undefined || value === null) {\n                    return null\n                  }\n\n                  // Format based on field type\n                  if (field.type === 'relationship' || field.type === 'upload') {\n                    // Handle relationships\n                    if (typeof value === 'object' && !Array.isArray(value)) {\n                      // Single relationship\n                      const relationTo = Array.isArray(field.relationTo)\n                        ? (value as any).relationTo\n                        : field.relationTo\n\n                      const relatedConfig = config.collections.find((c) => c.slug === relationTo)\n                      if (relatedConfig && relatedConfig.admin?.useAsTitle) {\n                        const titleValue = (value as any)[relatedConfig.admin.useAsTitle]\n                        if (titleValue) {\n                          return formatDocTitle({\n                            collectionConfig: relatedConfig,\n                            data: value as any,\n                            dateFormat: config.admin.dateFormat,\n                            i18n,\n                          })\n                        }\n                      }\n\n                      // Fallback to ID\n                      const id = (value as any).id || value\n                      return `${getTranslation(relatedConfig?.labels?.singular || relationTo, i18n)}: ${id}`\n                    } else if (Array.isArray(value)) {\n                      // Multiple relationships\n                      return value\n                        .map((item) => {\n                          if (typeof item === 'object') {\n                            const relationTo = Array.isArray(field.relationTo)\n                              ? item.relationTo\n                              : field.relationTo\n                            const relatedConfig = config.collections.find(\n                              (c) => c.slug === relationTo,\n                            )\n\n                            if (relatedConfig && relatedConfig.admin?.useAsTitle) {\n                              const titleValue = item[relatedConfig.admin.useAsTitle]\n                              if (titleValue) {\n                                return formatDocTitle({\n                                  collectionConfig: relatedConfig,\n                                  data: item,\n                                  dateFormat: config.admin.dateFormat,\n                                  i18n,\n                                })\n                              }\n                            }\n\n                            return item.id || item\n                          }\n                          return item\n                        })\n                        .join(', ')\n                    }\n\n                    // Just an ID\n                    return String(value)\n                  } else if (field.type === 'date') {\n                    // Format dates\n                    const dateFormat =\n                      (field.admin &&\n                        'date' in field.admin &&\n                        (field.admin.date as ConditionalDateProps)?.displayFormat) ||\n                      config.admin.dateFormat\n\n                    return new Date(value as string).toLocaleString(i18n.language, {\n                      dateStyle: 'medium',\n                      timeStyle: 'short',\n                    })\n                  } else if (field.type === 'checkbox') {\n                    return value ? '✓' : '✗'\n                  } else if (field.type === 'select' || field.type === 'radio') {\n                    // Show the label for select/radio options\n                    const option = field.options?.find((opt) => {\n                      if (typeof opt === 'string') {\n                        return opt === value\n                      }\n                      return opt.value === value\n                    })\n\n                    if (option && typeof option === 'object') {\n                      return getTranslation(option.label, i18n)\n                    }\n                    return String(value)\n                  } else if (field.type === 'number') {\n                    return String(value)\n                  } else if (Array.isArray(value)) {\n                    // Handle arrays\n                    if (field.type === 'blocks') {\n                      return value.map((block: any) => `${block.blockType || 'Block'}`).join(', ')\n                    }\n                    return `[${value.length} items]`\n                  } else if (typeof value === 'object') {\n                    // Handle objects\n                    if (field.type === 'group') {\n                      return '{...}'\n                    }\n                    return JSON.stringify(value)\n                  }\n\n                  return String(value)\n                }),\n              })\n\n              // For groups, add nested fields with parent label\n              if (field.type === 'group' && 'fields' in field) {\n                const groupLabel =\n                  'label' in field && field.label ? getTranslation(field.label, i18n) : field.name\n\n                const nestedCols = buildColumnsFromFields(\n                  field.fields,\n                  fieldPath,\n                  parentLabel ? `${parentLabel} > ${groupLabel}` : groupLabel,\n                )\n                cols.push(...nestedCols)\n              }\n\n              // For tabs, process the fields within\n              if ('tabs' in field && Array.isArray(field.tabs)) {\n                field.tabs.forEach((tab) => {\n                  if ('name' in tab && tab.name) {\n                    // Named tab\n                    const tabPath = parentPath ? `${parentPath}.${tab.name}` : tab.name\n                    const tabLabel =\n                      'label' in tab && tab.label ? getTranslation(tab.label, i18n) : tab.name\n\n                    const tabCols = buildColumnsFromFields(\n                      tab.fields,\n                      tabPath,\n                      parentLabel ? `${parentLabel} > ${tabLabel}` : tabLabel,\n                    )\n                    cols.push(...tabCols)\n                  } else {\n                    // Unnamed tab - fields go directly under parent\n                    const tabLabel =\n                      'label' in tab && tab.label ? getTranslation(tab.label, i18n) : ''\n\n                    const tabCols = buildColumnsFromFields(\n                      tab.fields,\n                      parentPath,\n                      tabLabel && typeof tabLabel === 'string' && parentLabel\n                        ? `${parentLabel} > ${tabLabel}`\n                        : typeof tabLabel === 'string'\n                          ? tabLabel\n                          : parentLabel,\n                    )\n                    cols.push(...tabCols)\n                  }\n                })\n              }\n            })\n\n            return cols\n          }\n\n          // Add default meta fields at the end\n          const fieldColumns = buildColumnsFromFields(collectionConfig.fields)\n          const metaFields = ['id', 'createdAt', 'updatedAt', '_status']\n\n          metaFields.forEach((metaField) => {\n            const hasData = docs.some((doc) => doc[metaField] !== undefined)\n            if (!hasData) {\n              return\n            }\n\n            fieldColumns.push({\n              accessor: metaField,\n              active: true,\n              field: { name: metaField } as ClientField,\n              Heading: getTranslation(metaField, i18n),\n              renderedCells: docs.map((doc) => {\n                const value = doc[metaField]\n                if (value === undefined || value === null) {\n                  return null\n                }\n\n                if (metaField === 'createdAt' || metaField === 'updatedAt') {\n                  return new Date(value as string).toLocaleString(i18n.language, {\n                    dateStyle: 'medium',\n                    timeStyle: 'short',\n                  })\n                }\n\n                return String(value)\n              }),\n            })\n          })\n\n          setColumns(fieldColumns)\n          setDataToRender(docs)\n        } catch (err) {\n          console.error('Error processing file data:', err)\n          setError(err instanceof Error ? err.message : 'Failed to load preview')\n          setDataToRender([])\n          setColumns([])\n          setTotalDocs(0)\n          setPaginationData(null)\n        }\n      }\n\n      startTransition(async () => await processFileData())\n\n      return () => {\n        if (!abortController.signal.aborted) {\n          abortController.abort('Component unmounted')\n        }\n      }\n    },\n    [\n      collectionSlug,\n      targetCollectionSlug,\n      url,\n      filename,\n      mimeType,\n      fileField?.value,\n      collectionConfig,\n      config,\n      i18n,\n      previewLimit,\n      previewPage,\n      routes.api,\n    ],\n    500,\n  )\n\n  // If import has been processed, show results instead of preview\n  if (status !== 'pending' && summary) {\n    return (\n      <div className={baseClass}>\n        <div className={`${baseClass}__header`}>\n          <h3>\n            {/* @ts-expect-error - translations are not typed in plugins */}\n            <Translation i18nKey=\"plugin-import-export:importResults\" t={t} />\n          </h3>\n        </div>\n        <div className={`${baseClass}__results`}>\n          <p>\n            <strong>Status:</strong> {status}\n          </p>\n          <p>\n            <strong>Imported:</strong> {summary.imported || 0}\n          </p>\n          <p>\n            <strong>Updated:</strong> {summary.updated || 0}\n          </p>\n          <p>\n            <strong>Total:</strong> {summary.total || 0}\n          </p>\n          {summary.issues > 0 && (\n            <p>\n              <strong>Issues:</strong> {summary.issues}\n            </p>\n          )}\n          {summary.issueDetails && summary.issueDetails.length > 0 && (\n            <div style={{ marginTop: '1rem' }}>\n              <strong>Issue Details:</strong>\n              <ul style={{ marginTop: '0.5rem' }}>\n                {summary.issueDetails.slice(0, 10).map((issue: any, index: number) => (\n                  <li key={index}>\n                    Row {issue.row}: {issue.error}\n                  </li>\n                ))}\n                {summary.issueDetails.length > 10 && (\n                  <li>... and {summary.issueDetails.length - 10} more issues</li>\n                )}\n              </ul>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  if (!targetCollectionSlug) {\n    return (\n      <div className={baseClass}>\n        <p style={{ opacity: 0.6 }}>\n          {/* @ts-expect-error - translations are not typed in plugins */}\n          <Translation i18nKey=\"plugin-import-export:collectionRequired\" t={t} />\n        </p>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className={baseClass}>\n        <p style={{ color: 'red' }}>\n          <Translation i18nKey=\"general:error\" t={t} />: {error}\n        </p>\n      </div>\n    )\n  }\n\n  if (!url && !fileField?.value) {\n    return (\n      <div className={baseClass}>\n        <p style={{ opacity: 0.6 }}>\n          {/* @ts-expect-error - translations are not typed in plugins */}\n          <Translation i18nKey=\"plugin-import-export:uploadFileToSeePreview\" t={t} />\n        </p>\n      </div>\n    )\n  }\n\n  const handlePageChange = (page: number) => {\n    setPreviewPage(page)\n  }\n\n  const handlePerPageChange = (newLimit: number) => {\n    setPreviewLimit(newLimit)\n    setPreviewPage(1)\n  }\n\n  return (\n    <div className={baseClass}>\n      <div className={`${baseClass}__header`}>\n        <h3>\n          <Translation i18nKey=\"version:preview\" t={t} />\n        </h3>\n        {totalDocs > 0 && !isPending && (\n          <div className={`${baseClass}__info`}>\n            <span className={`${baseClass}__import-count`}>\n              <Translation\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-expect-error\n                i18nKey=\"plugin-import-export:documentsToImport\"\n                t={t}\n                variables={{\n                  count: totalDocs,\n                }}\n              />\n            </span>\n            {' | '}\n            {/* @ts-expect-error - translations are not typed in plugins */}\n            <Translation i18nKey=\"plugin-import-export:mode\" t={t} />: {importMode || 'create'}\n            {importMode !== 'create' && (\n              <>\n                {' | '}\n                {/* @ts-expect-error - translations are not typed in plugins */}\n                <Translation i18nKey=\"plugin-import-export:matchBy\" t={t} />: {matchField || 'id'}\n              </>\n            )}\n          </div>\n        )}\n      </div>\n      {isPending && !dataToRender.length && (\n        <div className={`${baseClass}__loading`}>\n          <Translation i18nKey=\"general:loading\" t={t} />\n        </div>\n      )}\n      {dataToRender.length > 0 && <Table columns={columns} data={dataToRender} />}\n      {!isPending && dataToRender.length === 0 && targetCollectionSlug && (\n        <p>\n          {/* @ts-expect-error - translations are not typed in plugins */}\n          <Translation i18nKey=\"plugin-import-export:noDataToPreview\" t={t} />\n        </p>\n      )}\n      {paginationData && totalDocs > 0 && (\n        <div className={`${baseClass}__pagination`}>\n          {paginationData.totalPages > 1 && (\n            <Pagination\n              hasNextPage={paginationData.hasNextPage}\n              hasPrevPage={paginationData.hasPrevPage}\n              nextPage={paginationData.nextPage ?? undefined}\n              numberOfNeighbors={1}\n              onChange={handlePageChange}\n              page={paginationData.page}\n              prevPage={paginationData.prevPage ?? undefined}\n              totalPages={paginationData.totalPages}\n            />\n          )}\n          <span className={`${baseClass}__page-info`}>\n            <Translation\n              // @ts-expect-error - plugin translations not typed\n              i18nKey=\"plugin-import-export:previewPageInfo\"\n              t={t}\n              variables={{\n                end: Math.min((paginationData.page ?? 1) * previewLimit, totalDocs),\n                start: ((paginationData.page ?? 1) - 1) * previewLimit + 1,\n                total: totalDocs,\n              }}\n            />\n          </span>\n          <PerPage\n            handleChange={handlePerPageChange}\n            limit={previewLimit}\n            limits={PREVIEW_LIMIT_OPTIONS}\n          />\n        </div>\n      )}\n    </div>\n  )\n}\n\n// Helper function to get nested values\nconst getValueAtPath = (obj: Record<string, unknown>, path: string): unknown => {\n  const segments = path.split('.')\n  let current: any = obj\n\n  for (const segment of segments) {\n    if (current === null || current === undefined) {\n      return undefined\n    }\n    current = current[segment]\n  }\n\n  return current\n}\n"],"names":["getTranslation","Pagination","PerPage","Table","Translation","useConfig","useDebouncedEffect","useDocumentInfo","useField","useFormFields","useTranslation","formatDocTitle","fieldAffectsData","React","useState","useTransition","DEFAULT_PREVIEW_LIMIT","PREVIEW_LIMIT_OPTIONS","baseClass","ImportPreview","isPending","startTransition","config","routes","collectionSlug","i18n","t","value","targetCollectionSlug","path","importMode","matchField","filename","url","mimeType","status","summary","fileField","fields","file","dataToRender","setDataToRender","columns","setColumns","totalDocs","setTotalDocs","error","setError","previewPage","setPreviewPage","previewLimit","setPreviewLimit","paginationData","setPaginationData","collectionConfig","useMemo","collections","find","c","slug","abortController","AbortController","processFileData","format","File","type","name","endsWith","fileData","arrayBuffer","base64","Buffer","from","toString","response","fetch","signal","ok","Error","res","api","body","JSON","stringify","credentials","headers","method","docs","hasNextPage","hasPrevPage","limit","responseLimit","page","responsePage","serverTotalDocs","totalPages","json","nextPage","prevPage","Array","isArray","length","buildColumnsFromFields","parentPath","parentLabel","cols","forEach","field","admin","disabled","fieldPath","label","hasData","some","doc","getValueAtPath","undefined","push","accessor","active","Heading","renderedCells","map","relationTo","relatedConfig","useAsTitle","titleValue","data","dateFormat","id","labels","singular","item","join","String","date","displayFormat","Date","toLocaleString","language","dateStyle","timeStyle","option","options","opt","block","blockType","groupLabel","nestedCols","tabs","tab","tabPath","tabLabel","tabCols","fieldColumns","metaFields","metaField","err","console","message","aborted","abort","div","className","h3","i18nKey","p","strong","imported","updated","total","issues","issueDetails","style","marginTop","ul","slice","issue","index","li","row","opacity","color","handlePageChange","handlePerPageChange","newLimit","span","variables","count","numberOfNeighbors","onChange","end","Math","min","start","handleChange","limits","obj","segments","split","current","segment"],"mappings":"AAAA;;AAIA,SAASA,cAAc,QAAQ,2BAA0B;AACzD,SACEC,UAAU,EACVC,OAAO,EACPC,KAAK,EACLC,WAAW,EACXC,SAAS,EACTC,kBAAkB,EAClBC,eAAe,EACfC,QAAQ,EACRC,aAAa,EACbC,cAAc,QACT,iBAAgB;AACvB,SAASC,cAAc,QAAQ,wBAAuB;AACtD,SAASC,gBAAgB,QAAQ,iBAAgB;AACjD,OAAOC,SAASC,QAAQ,EAAEC,aAAa,QAAQ,QAAO;AAQtD,SAASC,qBAAqB,EAAEC,qBAAqB,QAAQ,qBAAoB;AACjF,OAAO,eAAc;AAErB,MAAMC,YAAY;AAElB,OAAO,MAAMC,gBAA0B;IACrC,MAAM,CAACC,WAAWC,gBAAgB,GAAGN;IACrC,MAAM,EACJO,MAAM,EACNA,QAAQ,EAAEC,MAAM,EAAE,EACnB,GAAGlB;IACJ,MAAM,EAAEmB,cAAc,EAAE,GAAGjB;IAC3B,MAAM,EAAEkB,IAAI,EAAEC,CAAC,EAAE,GAAGhB;IAKpB,MAAM,EAAEiB,OAAOC,oBAAoB,EAAE,GAAGpB,SAAiB;QAAEqB,MAAM;IAAiB;IAClF,MAAM,EAAEF,OAAOG,UAAU,EAAE,GAAGtB,SAAiB;QAAEqB,MAAM;IAAa;IACpE,MAAM,EAAEF,OAAOI,UAAU,EAAE,GAAGvB,SAAiB;QAAEqB,MAAM;IAAa;IACpE,MAAM,EAAEF,OAAOK,QAAQ,EAAE,GAAGxB,SAAiB;QAAEqB,MAAM;IAAW;IAChE,MAAM,EAAEF,OAAOM,GAAG,EAAE,GAAGzB,SAAiB;QAAEqB,MAAM;IAAM;IACtD,MAAM,EAAEF,OAAOO,QAAQ,EAAE,GAAG1B,SAAiB;QAAEqB,MAAM;IAAW;IAChE,MAAM,EAAEF,OAAOQ,MAAM,EAAE,GAAG3B,SAAiB;QAAEqB,MAAM;IAAS;IAC5D,MAAM,EAAEF,OAAOS,OAAO,EAAE,GAAG5B,SAAc;QAAEqB,MAAM;IAAU;IAE3D,kDAAkD;IAClD,MAAMQ,YAAY5B,cAAc,CAAC,CAAC6B,OAAO,GAAKA,QAAQC,QAAQ;IAE9D,MAAM,CAACC,cAAcC,gBAAgB,GAAG3B,SAAoC,EAAE;IAC9E,MAAM,CAAC4B,SAASC,WAAW,GAAG7B,SAAmB,EAAE;IACnD,MAAM,CAAC8B,WAAWC,aAAa,GAAG/B,SAAiB;IACnD,MAAM,CAACgC,OAAOC,SAAS,GAAGjC,SAAwB;IAElD,2BAA2B;IAC3B,MAAM,CAACkC,aAAaC,eAAe,GAAGnC,SAAS;IAC/C,MAAM,CAACoC,cAAcC,gBAAgB,GAAGrC,SAASE;IACjD,MAAM,CAACoC,gBAAgBC,kBAAkB,GAAGvC,SAGzC;IAEH,MAAMwC,mBAAmBzC,MAAM0C,OAAO,CACpC,IAAMjC,OAAOkC,WAAW,CAACC,IAAI,CAAC,CAACC,IAAMA,EAAEC,IAAI,KAAK/B,uBAChD;QAACA;QAAsBN,OAAOkC,WAAW;KAAC;IAG5ClD,mBACE;QACE,IAAI,CAACkB,kBAAkB,CAACI,sBAAsB;YAC5C;QACF;QAEA,IAAI,CAACA,wBAAyB,CAACK,OAAO,CAACI,WAAWV,OAAQ;YACxDc,gBAAgB,EAAE;YAClBE,WAAW,EAAE;YACbE,aAAa;YACbQ,kBAAkB;YAClB;QACF;QAEA,IAAI,CAACC,kBAAkB;YACrBb,gBAAgB,EAAE;YAClBE,WAAW,EAAE;YACbE,aAAa;YACbQ,kBAAkB;YAClB;QACF;QAEA,MAAMO,kBAAkB,IAAIC;QAE5B,MAAMC,kBAAkB;YACtBf,SAAS;YAET,IAAI;gBACF,6BAA6B;gBAC7B,IAAIgB,SAAyB;gBAC7B,IAAI1B,WAAWV,SAASU,UAAUV,KAAK,YAAYqC,MAAM;oBACvD,MAAMzB,OAAOF,UAAUV,KAAK;oBAC5BoC,SAASxB,KAAK0B,IAAI,KAAK,cAAc1B,KAAK2B,IAAI,EAAEC,SAAS,UAAU,QAAQ;gBAC7E,OAAO,IAAIjC,aAAa,cAAcF,UAAUmC,SAAS,SAAS;oBAChEJ,SAAS;gBACX;gBAEA,0BAA0B;gBAC1B,IAAIK;gBAEJ,IAAI/B,WAAWV,SAASU,UAAUV,KAAK,YAAYqC,MAAM;oBACvD,4CAA4C;oBAC5C,MAAMK,cAAc,MAAMhC,UAAUV,KAAK,CAAC0C,WAAW;oBACrD,MAAMC,SAASC,OAAOC,IAAI,CAACH,aAAaI,QAAQ,CAAC;oBACjDL,WAAWE;gBACb,OAAO,IAAIrC,KAAK;oBACd,sCAAsC;oBACtC,MAAMyC,WAAW,MAAMC,MAAM1C,KAAK;wBAAE2C,QAAQhB,gBAAgBgB,MAAM;oBAAC;oBACnE,IAAI,CAACF,SAASG,EAAE,EAAE;wBAChB,MAAM,IAAIC,MAAM;oBAClB;oBACA,MAAMT,cAAc,MAAMK,SAASL,WAAW;oBAC9C,MAAMC,SAASC,OAAOC,IAAI,CAACH,aAAaI,QAAQ,CAAC;oBACjDL,WAAWE;gBACb;gBAEA,IAAI,CAACF,UAAU;oBACb3B,gBAAgB,EAAE;oBAClBE,WAAW,EAAE;oBACbE,aAAa;oBACbQ,kBAAkB;oBAClB;gBACF;gBAEA,yCAAyC;gBACzC,MAAM0B,MAAM,MAAMJ,MAAM,GAAGpD,OAAOyD,GAAG,CAAC,CAAC,EAAExD,eAAe,aAAa,CAAC,EAAE;oBACtEyD,MAAMC,KAAKC,SAAS,CAAC;wBACnB3D,gBAAgBI;wBAChBwC;wBACAL;wBACAb;wBACAF;oBACF;oBACAoC,aAAa;oBACbC,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9CC,QAAQ;oBACRV,QAAQhB,gBAAgBgB,MAAM;gBAChC;gBAEA,IAAI,CAACG,IAAIF,EAAE,EAAE;oBACX,MAAM,IAAIC,MAAM;gBAClB;gBAEA,MAAM,EACJS,IAAI,EACJC,WAAW,EACXC,WAAW,EACXC,OAAOC,aAAa,EACpBC,MAAMC,YAAY,EAClBjD,WAAWkD,eAAe,EAC1BC,UAAU,EACX,GAA0B,MAAMhB,IAAIiB,IAAI;gBAEzCnD,aAAaiD;gBACbzC,kBAAkB;oBAChBmC;oBACAC;oBACAC,OAAOC;oBACPM,UAAUJ,eAAe;oBACzBD,MAAMC;oBACNK,UAAUL,eAAe;oBACzBE;gBACF;gBAEA,IAAI,CAACI,MAAMC,OAAO,CAACb,SAASA,KAAKc,MAAM,KAAK,GAAG;oBAC7C5D,gBAAgB,EAAE;oBAClBE,WAAW,EAAE;oBACb;gBACF;gBAEA,8DAA8D;gBAC9D,MAAM2D,yBAAyB,CAC7BhE,QACAiE,aAAa,EAAE,EACfC,cAAc,EAAE;oBAEhB,MAAMC,OAAiB,EAAE;oBAEzBnE,OAAOoE,OAAO,CAAC,CAACC;wBACd,IAAI,CAAC/F,iBAAiB+F,UAAUA,MAAMC,KAAK,EAAEC,UAAU;4BACrD;wBACF;wBAEA,uBAAuB;wBACvB,MAAMC,YAAYP,aAAa,GAAGA,WAAW,CAAC,EAAEI,MAAMzC,IAAI,EAAE,GAAGyC,MAAMzC,IAAI;wBAEzE,sBAAsB;wBACtB,IAAI6C,QAAQJ,MAAMzC,IAAI;wBACtB,IAAI,WAAWyC,SAASA,MAAMI,KAAK,EAAE;4BACnCA,QAAQ/G,eAAe2G,MAAMI,KAAK,EAAEtF;wBACtC;wBAEA,wCAAwC;wBACxC,IAAI+E,aAAa;4BACfO,QAAQ,GAAGP,YAAY,GAAG,EAAEO,OAAO;wBACrC;wBAEA,mDAAmD;wBACnD,MAAMC,UAAUzB,KAAK0B,IAAI,CAAC,CAACC;4BACzB,MAAMvF,QAAQwF,eAAeD,KAAKJ;4BAClC,OAAOnF,UAAUyF,aAAazF,UAAU;wBAC1C;wBAEA,IAAI,CAACqF,WAAWL,MAAM1C,IAAI,KAAK,gBAAgB;4BAC7C;wBACF;wBAEAwC,KAAKY,IAAI,CAAC;4BACRC,UAAUR;4BACVS,QAAQ;4BACRZ;4BACAa,SAAST;4BACTU,eAAelC,KAAKmC,GAAG,CAAC,CAACR;gCACvB,MAAMvF,QAAQwF,eAAeD,KAAKJ;gCAElC,IAAInF,UAAUyF,aAAazF,UAAU,MAAM;oCACzC,OAAO;gCACT;gCAEA,6BAA6B;gCAC7B,IAAIgF,MAAM1C,IAAI,KAAK,kBAAkB0C,MAAM1C,IAAI,KAAK,UAAU;oCAC5D,uBAAuB;oCACvB,IAAI,OAAOtC,UAAU,YAAY,CAACwE,MAAMC,OAAO,CAACzE,QAAQ;wCACtD,sBAAsB;wCACtB,MAAMgG,aAAaxB,MAAMC,OAAO,CAACO,MAAMgB,UAAU,IAC7C,AAAChG,MAAcgG,UAAU,GACzBhB,MAAMgB,UAAU;wCAEpB,MAAMC,gBAAgBtG,OAAOkC,WAAW,CAACC,IAAI,CAAC,CAACC,IAAMA,EAAEC,IAAI,KAAKgE;wCAChE,IAAIC,iBAAiBA,cAAchB,KAAK,EAAEiB,YAAY;4CACpD,MAAMC,aAAa,AAACnG,KAAa,CAACiG,cAAchB,KAAK,CAACiB,UAAU,CAAC;4CACjE,IAAIC,YAAY;gDACd,OAAOnH,eAAe;oDACpB2C,kBAAkBsE;oDAClBG,MAAMpG;oDACNqG,YAAY1G,OAAOsF,KAAK,CAACoB,UAAU;oDACnCvG;gDACF;4CACF;wCACF;wCAEA,iBAAiB;wCACjB,MAAMwG,KAAK,AAACtG,MAAcsG,EAAE,IAAItG;wCAChC,OAAO,GAAG3B,eAAe4H,eAAeM,QAAQC,YAAYR,YAAYlG,MAAM,EAAE,EAAEwG,IAAI;oCACxF,OAAO,IAAI9B,MAAMC,OAAO,CAACzE,QAAQ;wCAC/B,yBAAyB;wCACzB,OAAOA,MACJ+F,GAAG,CAAC,CAACU;4CACJ,IAAI,OAAOA,SAAS,UAAU;gDAC5B,MAAMT,aAAaxB,MAAMC,OAAO,CAACO,MAAMgB,UAAU,IAC7CS,KAAKT,UAAU,GACfhB,MAAMgB,UAAU;gDACpB,MAAMC,gBAAgBtG,OAAOkC,WAAW,CAACC,IAAI,CAC3C,CAACC,IAAMA,EAAEC,IAAI,KAAKgE;gDAGpB,IAAIC,iBAAiBA,cAAchB,KAAK,EAAEiB,YAAY;oDACpD,MAAMC,aAAaM,IAAI,CAACR,cAAchB,KAAK,CAACiB,UAAU,CAAC;oDACvD,IAAIC,YAAY;wDACd,OAAOnH,eAAe;4DACpB2C,kBAAkBsE;4DAClBG,MAAMK;4DACNJ,YAAY1G,OAAOsF,KAAK,CAACoB,UAAU;4DACnCvG;wDACF;oDACF;gDACF;gDAEA,OAAO2G,KAAKH,EAAE,IAAIG;4CACpB;4CACA,OAAOA;wCACT,GACCC,IAAI,CAAC;oCACV;oCAEA,aAAa;oCACb,OAAOC,OAAO3G;gCAChB,OAAO,IAAIgF,MAAM1C,IAAI,KAAK,QAAQ;oCAChC,eAAe;oCACf,MAAM+D,aACJ,AAACrB,MAAMC,KAAK,IACV,UAAUD,MAAMC,KAAK,IACpBD,MAAMC,KAAK,CAAC2B,IAAI,EAA2BC,iBAC9ClH,OAAOsF,KAAK,CAACoB,UAAU;oCAEzB,OAAO,IAAIS,KAAK9G,OAAiB+G,cAAc,CAACjH,KAAKkH,QAAQ,EAAE;wCAC7DC,WAAW;wCACXC,WAAW;oCACb;gCACF,OAAO,IAAIlC,MAAM1C,IAAI,KAAK,YAAY;oCACpC,OAAOtC,QAAQ,MAAM;gCACvB,OAAO,IAAIgF,MAAM1C,IAAI,KAAK,YAAY0C,MAAM1C,IAAI,KAAK,SAAS;oCAC5D,0CAA0C;oCAC1C,MAAM6E,SAASnC,MAAMoC,OAAO,EAAEtF,KAAK,CAACuF;wCAClC,IAAI,OAAOA,QAAQ,UAAU;4CAC3B,OAAOA,QAAQrH;wCACjB;wCACA,OAAOqH,IAAIrH,KAAK,KAAKA;oCACvB;oCAEA,IAAImH,UAAU,OAAOA,WAAW,UAAU;wCACxC,OAAO9I,eAAe8I,OAAO/B,KAAK,EAAEtF;oCACtC;oCACA,OAAO6G,OAAO3G;gCAChB,OAAO,IAAIgF,MAAM1C,IAAI,KAAK,UAAU;oCAClC,OAAOqE,OAAO3G;gCAChB,OAAO,IAAIwE,MAAMC,OAAO,CAACzE,QAAQ;oCAC/B,gBAAgB;oCAChB,IAAIgF,MAAM1C,IAAI,KAAK,UAAU;wCAC3B,OAAOtC,MAAM+F,GAAG,CAAC,CAACuB,QAAe,GAAGA,MAAMC,SAAS,IAAI,SAAS,EAAEb,IAAI,CAAC;oCACzE;oCACA,OAAO,CAAC,CAAC,EAAE1G,MAAM0E,MAAM,CAAC,OAAO,CAAC;gCAClC,OAAO,IAAI,OAAO1E,UAAU,UAAU;oCACpC,iBAAiB;oCACjB,IAAIgF,MAAM1C,IAAI,KAAK,SAAS;wCAC1B,OAAO;oCACT;oCACA,OAAOiB,KAAKC,SAAS,CAACxD;gCACxB;gCAEA,OAAO2G,OAAO3G;4BAChB;wBACF;wBAEA,kDAAkD;wBAClD,IAAIgF,MAAM1C,IAAI,KAAK,WAAW,YAAY0C,OAAO;4BAC/C,MAAMwC,aACJ,WAAWxC,SAASA,MAAMI,KAAK,GAAG/G,eAAe2G,MAAMI,KAAK,EAAEtF,QAAQkF,MAAMzC,IAAI;4BAElF,MAAMkF,aAAa9C,uBACjBK,MAAMrE,MAAM,EACZwE,WACAN,cAAc,GAAGA,YAAY,GAAG,EAAE2C,YAAY,GAAGA;4BAEnD1C,KAAKY,IAAI,IAAI+B;wBACf;wBAEA,sCAAsC;wBACtC,IAAI,UAAUzC,SAASR,MAAMC,OAAO,CAACO,MAAM0C,IAAI,GAAG;4BAChD1C,MAAM0C,IAAI,CAAC3C,OAAO,CAAC,CAAC4C;gCAClB,IAAI,UAAUA,OAAOA,IAAIpF,IAAI,EAAE;oCAC7B,YAAY;oCACZ,MAAMqF,UAAUhD,aAAa,GAAGA,WAAW,CAAC,EAAE+C,IAAIpF,IAAI,EAAE,GAAGoF,IAAIpF,IAAI;oCACnE,MAAMsF,WACJ,WAAWF,OAAOA,IAAIvC,KAAK,GAAG/G,eAAesJ,IAAIvC,KAAK,EAAEtF,QAAQ6H,IAAIpF,IAAI;oCAE1E,MAAMuF,UAAUnD,uBACdgD,IAAIhH,MAAM,EACViH,SACA/C,cAAc,GAAGA,YAAY,GAAG,EAAEgD,UAAU,GAAGA;oCAEjD/C,KAAKY,IAAI,IAAIoC;gCACf,OAAO;oCACL,gDAAgD;oCAChD,MAAMD,WACJ,WAAWF,OAAOA,IAAIvC,KAAK,GAAG/G,eAAesJ,IAAIvC,KAAK,EAAEtF,QAAQ;oCAElE,MAAMgI,UAAUnD,uBACdgD,IAAIhH,MAAM,EACViE,YACAiD,YAAY,OAAOA,aAAa,YAAYhD,cACxC,GAAGA,YAAY,GAAG,EAAEgD,UAAU,GAC9B,OAAOA,aAAa,WAClBA,WACAhD;oCAERC,KAAKY,IAAI,IAAIoC;gCACf;4BACF;wBACF;oBACF;oBAEA,OAAOhD;gBACT;gBAEA,qCAAqC;gBACrC,MAAMiD,eAAepD,uBAAuBhD,iBAAiBhB,MAAM;gBACnE,MAAMqH,aAAa;oBAAC;oBAAM;oBAAa;oBAAa;iBAAU;gBAE9DA,WAAWjD,OAAO,CAAC,CAACkD;oBAClB,MAAM5C,UAAUzB,KAAK0B,IAAI,CAAC,CAACC,MAAQA,GAAG,CAAC0C,UAAU,KAAKxC;oBACtD,IAAI,CAACJ,SAAS;wBACZ;oBACF;oBAEA0C,aAAarC,IAAI,CAAC;wBAChBC,UAAUsC;wBACVrC,QAAQ;wBACRZ,OAAO;4BAAEzC,MAAM0F;wBAAU;wBACzBpC,SAASxH,eAAe4J,WAAWnI;wBACnCgG,eAAelC,KAAKmC,GAAG,CAAC,CAACR;4BACvB,MAAMvF,QAAQuF,GAAG,CAAC0C,UAAU;4BAC5B,IAAIjI,UAAUyF,aAAazF,UAAU,MAAM;gCACzC,OAAO;4BACT;4BAEA,IAAIiI,cAAc,eAAeA,cAAc,aAAa;gCAC1D,OAAO,IAAInB,KAAK9G,OAAiB+G,cAAc,CAACjH,KAAKkH,QAAQ,EAAE;oCAC7DC,WAAW;oCACXC,WAAW;gCACb;4BACF;4BAEA,OAAOP,OAAO3G;wBAChB;oBACF;gBACF;gBAEAgB,WAAW+G;gBACXjH,gBAAgB8C;YAClB,EAAE,OAAOsE,KAAK;gBACZC,QAAQhH,KAAK,CAAC,+BAA+B+G;gBAC7C9G,SAAS8G,eAAe/E,QAAQ+E,IAAIE,OAAO,GAAG;gBAC9CtH,gBAAgB,EAAE;gBAClBE,WAAW,EAAE;gBACbE,aAAa;gBACbQ,kBAAkB;YACpB;QACF;QAEAhC,gBAAgB,UAAY,MAAMyC;QAElC,OAAO;YACL,IAAI,CAACF,gBAAgBgB,MAAM,CAACoF,OAAO,EAAE;gBACnCpG,gBAAgBqG,KAAK,CAAC;YACxB;QACF;IACF,GACA;QACEzI;QACAI;QACAK;QACAD;QACAE;QACAG,WAAWV;QACX2B;QACAhC;QACAG;QACAyB;QACAF;QACAzB,OAAOyD,GAAG;KACX,EACD;IAGF,gEAAgE;IAChE,IAAI7C,WAAW,aAAaC,SAAS;QACnC,qBACE,MAAC8H;YAAIC,WAAWjJ;;8BACd,KAACgJ;oBAAIC,WAAW,GAAGjJ,UAAU,QAAQ,CAAC;8BACpC,cAAA,KAACkJ;kCAEC,cAAA,KAAChK;4BAAYiK,SAAQ;4BAAqC3I,GAAGA;;;;8BAGjE,MAACwI;oBAAIC,WAAW,GAAGjJ,UAAU,SAAS,CAAC;;sCACrC,MAACoJ;;8CACC,KAACC;8CAAO;;gCAAgB;gCAAEpI;;;sCAE5B,MAACmI;;8CACC,KAACC;8CAAO;;gCAAkB;gCAAEnI,QAAQoI,QAAQ,IAAI;;;sCAElD,MAACF;;8CACC,KAACC;8CAAO;;gCAAiB;gCAAEnI,QAAQqI,OAAO,IAAI;;;sCAEhD,MAACH;;8CACC,KAACC;8CAAO;;gCAAe;gCAAEnI,QAAQsI,KAAK,IAAI;;;wBAE3CtI,QAAQuI,MAAM,GAAG,mBAChB,MAACL;;8CACC,KAACC;8CAAO;;gCAAgB;gCAAEnI,QAAQuI,MAAM;;;wBAG3CvI,QAAQwI,YAAY,IAAIxI,QAAQwI,YAAY,CAACvE,MAAM,GAAG,mBACrD,MAAC6D;4BAAIW,OAAO;gCAAEC,WAAW;4BAAO;;8CAC9B,KAACP;8CAAO;;8CACR,MAACQ;oCAAGF,OAAO;wCAAEC,WAAW;oCAAS;;wCAC9B1I,QAAQwI,YAAY,CAACI,KAAK,CAAC,GAAG,IAAItD,GAAG,CAAC,CAACuD,OAAYC,sBAClD,MAACC;;oDAAe;oDACTF,MAAMG,GAAG;oDAAC;oDAAGH,MAAMnI,KAAK;;+CADtBoI;wCAIV9I,QAAQwI,YAAY,CAACvE,MAAM,GAAG,oBAC7B,MAAC8E;;gDAAG;gDAAS/I,QAAQwI,YAAY,CAACvE,MAAM,GAAG;gDAAG;;;;;;;;;;;IAQ9D;IAEA,IAAI,CAACzE,sBAAsB;QACzB,qBACE,KAACsI;YAAIC,WAAWjJ;sBACd,cAAA,KAACoJ;gBAAEO,OAAO;oBAAEQ,SAAS;gBAAI;0BAEvB,cAAA,KAACjL;oBAAYiK,SAAQ;oBAA0C3I,GAAGA;;;;IAI1E;IAEA,IAAIoB,OAAO;QACT,qBACE,KAACoH;YAAIC,WAAWjJ;sBACd,cAAA,MAACoJ;gBAAEO,OAAO;oBAAES,OAAO;gBAAM;;kCACvB,KAAClL;wBAAYiK,SAAQ;wBAAgB3I,GAAGA;;oBAAK;oBAAGoB;;;;IAIxD;IAEA,IAAI,CAACb,OAAO,CAACI,WAAWV,OAAO;QAC7B,qBACE,KAACuI;YAAIC,WAAWjJ;sBACd,cAAA,KAACoJ;gBAAEO,OAAO;oBAAEQ,SAAS;gBAAI;0BAEvB,cAAA,KAACjL;oBAAYiK,SAAQ;oBAA8C3I,GAAGA;;;;IAI9E;IAEA,MAAM6J,mBAAmB,CAAC3F;QACxB3C,eAAe2C;IACjB;IAEA,MAAM4F,sBAAsB,CAACC;QAC3BtI,gBAAgBsI;QAChBxI,eAAe;IACjB;IAEA,qBACE,MAACiH;QAAIC,WAAWjJ;;0BACd,MAACgJ;gBAAIC,WAAW,GAAGjJ,UAAU,QAAQ,CAAC;;kCACpC,KAACkJ;kCACC,cAAA,KAAChK;4BAAYiK,SAAQ;4BAAkB3I,GAAGA;;;oBAE3CkB,YAAY,KAAK,CAACxB,2BACjB,MAAC8I;wBAAIC,WAAW,GAAGjJ,UAAU,MAAM,CAAC;;0CAClC,KAACwK;gCAAKvB,WAAW,GAAGjJ,UAAU,cAAc,CAAC;0CAC3C,cAAA,KAACd;oCACC,6DAA6D;oCAC7D,mBAAmB;oCACnBiK,SAAQ;oCACR3I,GAAGA;oCACHiK,WAAW;wCACTC,OAAOhJ;oCACT;;;4BAGH;0CAED,KAACxC;gCAAYiK,SAAQ;gCAA4B3I,GAAGA;;4BAAK;4BAAGI,cAAc;4BACzEA,eAAe,0BACd;;oCACG;kDAED,KAAC1B;wCAAYiK,SAAQ;wCAA+B3I,GAAGA;;oCAAK;oCAAGK,cAAc;;;;;;;YAMtFX,aAAa,CAACoB,aAAa6D,MAAM,kBAChC,KAAC6D;gBAAIC,WAAW,GAAGjJ,UAAU,SAAS,CAAC;0BACrC,cAAA,KAACd;oBAAYiK,SAAQ;oBAAkB3I,GAAGA;;;YAG7Cc,aAAa6D,MAAM,GAAG,mBAAK,KAAClG;gBAAMuC,SAASA;gBAASqF,MAAMvF;;YAC1D,CAACpB,aAAaoB,aAAa6D,MAAM,KAAK,KAAKzE,sCAC1C,KAAC0I;0BAEC,cAAA,KAAClK;oBAAYiK,SAAQ;oBAAuC3I,GAAGA;;;YAGlE0B,kBAAkBR,YAAY,mBAC7B,MAACsH;gBAAIC,WAAW,GAAGjJ,UAAU,YAAY,CAAC;;oBACvCkC,eAAe2C,UAAU,GAAG,mBAC3B,KAAC9F;wBACCuF,aAAapC,eAAeoC,WAAW;wBACvCC,aAAarC,eAAeqC,WAAW;wBACvCQ,UAAU7C,eAAe6C,QAAQ,IAAImB;wBACrCyE,mBAAmB;wBACnBC,UAAUP;wBACV3F,MAAMxC,eAAewC,IAAI;wBACzBM,UAAU9C,eAAe8C,QAAQ,IAAIkB;wBACrCrB,YAAY3C,eAAe2C,UAAU;;kCAGzC,KAAC2F;wBAAKvB,WAAW,GAAGjJ,UAAU,WAAW,CAAC;kCACxC,cAAA,KAACd;4BACC,mDAAmD;4BACnDiK,SAAQ;4BACR3I,GAAGA;4BACHiK,WAAW;gCACTI,KAAKC,KAAKC,GAAG,CAAC,AAAC7I,CAAAA,eAAewC,IAAI,IAAI,CAAA,IAAK1C,cAAcN;gCACzDsJ,OAAO,AAAC,CAAA,AAAC9I,CAAAA,eAAewC,IAAI,IAAI,CAAA,IAAK,CAAA,IAAK1C,eAAe;gCACzDwH,OAAO9H;4BACT;;;kCAGJ,KAAC1C;wBACCiM,cAAcX;wBACd9F,OAAOxC;wBACPkJ,QAAQnL;;;;;;AAMpB,EAAC;AAED,uCAAuC;AACvC,MAAMkG,iBAAiB,CAACkF,KAA8BxK;IACpD,MAAMyK,WAAWzK,KAAK0K,KAAK,CAAC;IAC5B,IAAIC,UAAeH;IAEnB,KAAK,MAAMI,WAAWH,SAAU;QAC9B,IAAIE,YAAY,QAAQA,YAAYpF,WAAW;YAC7C,OAAOA;QACT;QACAoF,UAAUA,OAAO,CAACC,QAAQ;IAC5B;IAEA,OAAOD;AACT"}
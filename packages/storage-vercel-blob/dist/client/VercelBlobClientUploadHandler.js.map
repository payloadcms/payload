{"version":3,"sources":["../../src/client/VercelBlobClientUploadHandler.ts"],"sourcesContent":["'use client'\nimport { createClientUploadHandler } from '@payloadcms/plugin-cloud-storage/client'\nimport { upload } from '@vercel/blob/client'\nimport { formatAdminURL } from 'payload/shared'\n\nexport type VercelBlobClientUploadHandlerExtra = {\n  addRandomSuffix: boolean\n  baseURL: string\n  prefix: string\n}\n\nexport const VercelBlobClientUploadHandler =\n  createClientUploadHandler<VercelBlobClientUploadHandlerExtra>({\n    handler: async ({\n      apiRoute,\n      collectionSlug,\n      extra: { addRandomSuffix, baseURL, prefix = '' },\n      file,\n      serverHandlerPath,\n      serverURL,\n      updateFilename,\n    }) => {\n      const endpointRoute = formatAdminURL({\n        apiRoute,\n        path: serverHandlerPath,\n        serverURL,\n      })\n      const result = await upload(`${prefix}${file.name}`, file, {\n        access: 'public',\n        clientPayload: collectionSlug,\n        contentType: file.type,\n        handleUploadUrl: endpointRoute,\n      })\n\n      // Update filename with suffix from returned url\n      if (addRandomSuffix) {\n        updateFilename(result.url.replace(`${baseURL}/`, ''))\n      }\n\n      return { prefix }\n    },\n  })\n"],"names":["createClientUploadHandler","upload","formatAdminURL","VercelBlobClientUploadHandler","handler","apiRoute","collectionSlug","extra","addRandomSuffix","baseURL","prefix","file","serverHandlerPath","serverURL","updateFilename","endpointRoute","path","result","name","access","clientPayload","contentType","type","handleUploadUrl","url","replace"],"mappings":"AAAA;AACA,SAASA,yBAAyB,QAAQ,0CAAyC;AACnF,SAASC,MAAM,QAAQ,sBAAqB;AAC5C,SAASC,cAAc,QAAQ,iBAAgB;AAQ/C,OAAO,MAAMC,gCACXH,0BAA8D;IAC5DI,SAAS,OAAO,EACdC,QAAQ,EACRC,cAAc,EACdC,OAAO,EAAEC,eAAe,EAAEC,OAAO,EAAEC,SAAS,EAAE,EAAE,EAChDC,IAAI,EACJC,iBAAiB,EACjBC,SAAS,EACTC,cAAc,EACf;QACC,MAAMC,gBAAgBb,eAAe;YACnCG;YACAW,MAAMJ;YACNC;QACF;QACA,MAAMI,SAAS,MAAMhB,OAAO,GAAGS,SAASC,KAAKO,IAAI,EAAE,EAAEP,MAAM;YACzDQ,QAAQ;YACRC,eAAed;YACfe,aAAaV,KAAKW,IAAI;YACtBC,iBAAiBR;QACnB;QAEA,gDAAgD;QAChD,IAAIP,iBAAiB;YACnBM,eAAeG,OAAOO,GAAG,CAACC,OAAO,CAAC,GAAGhB,QAAQ,CAAC,CAAC,EAAE;QACnD;QAEA,OAAO;YAAEC;QAAO;IAClB;AACF,GAAE"}
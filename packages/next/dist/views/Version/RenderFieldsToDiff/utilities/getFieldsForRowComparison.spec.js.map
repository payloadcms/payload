{"version":3,"file":"getFieldsForRowComparison.spec.js","names":["describe","it","expect","getFieldsForRowComparison","arrayFields","name","type","field","fields","valueToRow","valueFromRow","row","baseVersionField","path","schemaPath","config","toEqual","blockAFields","blocks","slug","blockType"],"sources":["../../../../../src/views/Version/RenderFieldsToDiff/utilities/getFieldsForRowComparison.spec.ts"],"sourcesContent":["import type { ArrayFieldClient, BlocksFieldClient, ClientField } from 'payload'\nimport { describe, it, expect } from 'vitest'\n\nimport { getFieldsForRowComparison } from './getFieldsForRowComparison'\n\ndescribe('getFieldsForRowComparison', () => {\n  describe('array fields', () => {\n    it('should return fields from array field', () => {\n      const arrayFields: ClientField[] = [\n        { name: 'title', type: 'text' },\n        { name: 'description', type: 'textarea' },\n      ]\n\n      const field: ArrayFieldClient = {\n        type: 'array',\n        name: 'items',\n        fields: arrayFields,\n      }\n\n      const { fields } = getFieldsForRowComparison({\n        field,\n        valueToRow: {},\n        valueFromRow: {},\n        row: 0,\n        baseVersionField: { fields: [], path: 'items', schemaPath: 'items', type: 'array' },\n        config: {} as any,\n      })\n\n      expect(fields).toEqual(arrayFields)\n    })\n  })\n\n  describe('blocks fields', () => {\n    it('should return combined fields when block types match', () => {\n      const blockAFields: ClientField[] = [\n        { name: 'a', type: 'text' },\n        { name: 'b', type: 'text' },\n      ]\n\n      const field: BlocksFieldClient = {\n        type: 'blocks',\n        name: 'myBlocks',\n        blocks: [\n          {\n            slug: 'blockA',\n            fields: blockAFields,\n          },\n        ],\n      }\n\n      const valueToRow = { blockType: 'blockA' }\n      const valueFromRow = { blockType: 'blockA' }\n\n      const { fields } = getFieldsForRowComparison({\n        field,\n        valueToRow,\n        valueFromRow,\n        row: 0,\n        baseVersionField: { fields: [], path: 'myBlocks', schemaPath: 'myBlocks', type: 'blocks' },\n        config: {} as any,\n      })\n\n      expect(fields).toEqual(blockAFields)\n    })\n\n    it('should return unique combined fields when block types differ', () => {\n      const field: BlocksFieldClient = {\n        type: 'blocks',\n        name: 'myBlocks',\n        blocks: [\n          {\n            slug: 'blockA',\n            fields: [\n              { name: 'a', type: 'text' },\n              { name: 'b', type: 'text' },\n            ],\n          },\n          {\n            slug: 'blockB',\n            fields: [\n              { name: 'b', type: 'text' },\n              { name: 'c', type: 'text' },\n            ],\n          },\n        ],\n      }\n\n      const valueToRow = { blockType: 'blockA' }\n      const valueFromRow = { blockType: 'blockB' }\n\n      const { fields } = getFieldsForRowComparison({\n        field,\n        valueToRow,\n        valueFromRow,\n        row: 0,\n        baseVersionField: { fields: [], path: 'myBlocks', schemaPath: 'myBlocks', type: 'blocks' },\n        config: {} as any,\n      })\n\n      // Should contain all unique fields from both blocks\n      expect(fields).toEqual([\n        { name: 'a', type: 'text' },\n        { name: 'b', type: 'text' },\n        { name: 'c', type: 'text' },\n      ])\n    })\n  })\n})\n"],"mappings":"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","ignoreList":[]}
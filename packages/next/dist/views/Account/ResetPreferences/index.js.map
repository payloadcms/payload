{"version":3,"file":"index.js","names":["c","_c","Button","ConfirmationModal","toast","useConfig","useModal","useTranslation","formatAdminURL","qs","Fragment","useCallback","confirmResetModalSlug","ResetPreferences","t0","$","user","openModal","t","config","t1","routes","t2","api","apiRoute","t3","stringifiedQuery","stringify","depth","where","id","equals","addQueryPrefix","res","fetch","path","credentials","headers","method","json","message","ok","success","error","t4","_err","handleResetPreferences","t5","_jsxs","children","_jsx","buttonStyle","onClick","body","confirmingLabel","heading","modalSlug","onConfirm"],"sources":["../../../../src/views/Account/ResetPreferences/index.tsx"],"sourcesContent":["'use client'\nimport type { TypedUser } from 'payload'\n\nimport {\n  Button,\n  ConfirmationModal,\n  toast,\n  useConfig,\n  useModal,\n  useTranslation,\n} from '@payloadcms/ui'\nimport { formatAdminURL } from 'payload/shared'\nimport * as qs from 'qs-esm'\nimport { Fragment, useCallback } from 'react'\n\nconst confirmResetModalSlug = 'confirm-reset-modal'\n\nexport const ResetPreferences: React.FC<{\n  readonly user?: TypedUser\n}> = ({ user }) => {\n  const { openModal } = useModal()\n  const { t } = useTranslation()\n  const {\n    config: {\n      routes: { api: apiRoute },\n    },\n  } = useConfig()\n\n  const handleResetPreferences = useCallback(async () => {\n    if (!user) {\n      return\n    }\n\n    const stringifiedQuery = qs.stringify(\n      {\n        depth: 0,\n        where: {\n          user: {\n            id: {\n              equals: user.id,\n            },\n          },\n        },\n      },\n      { addQueryPrefix: true },\n    )\n\n    try {\n      const res = await fetch(\n        formatAdminURL({\n          apiRoute,\n          path: `/payload-preferences${stringifiedQuery}`,\n        }),\n        {\n          credentials: 'include',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          method: 'DELETE',\n        },\n      )\n\n      const json = await res.json()\n      const message = json.message\n\n      if (res.ok) {\n        toast.success(message)\n      } else {\n        toast.error(message)\n      }\n    } catch (_err) {\n      // swallow error\n    }\n  }, [apiRoute, user])\n\n  return (\n    <Fragment>\n      <div>\n        <Button buttonStyle=\"secondary\" onClick={() => openModal(confirmResetModalSlug)}>\n          {t('general:resetPreferences')}\n        </Button>\n      </div>\n      <ConfirmationModal\n        body={t('general:resetPreferencesDescription')}\n        confirmingLabel={t('general:resettingPreferences')}\n        heading={t('general:resetPreferences')}\n        modalSlug={confirmResetModalSlug}\n        onConfirm={handleResetPreferences}\n      />\n    </Fragment>\n  )\n}\n"],"mappings":"AAAA;;AAAA,SAAAA,CAAA,IAAAC,EAAA;;AAGA,SACEC,MAAM,EACNC,iBAAiB,EACjBC,KAAK,EACLC,SAAS,EACTC,QAAQ,EACRC,cAAc,QACT;AACP,SAASC,cAAc,QAAQ;AAC/B,YAAYC,EAAA,MAAQ;AACpB,SAASC,QAAQ,EAAEC,WAAW,QAAQ;AAEtC,MAAMC,qBAAA,GAAwB;AAE9B,OAAO,MAAMC,gBAAA,GAERC,EAAA;EAAA,MAAAC,CAAA,GAAAd,EAAA;EAAC;IAAAe;EAAA,IAAAF,EAAQ;EACZ;IAAAG;EAAA,IAAsBX,QAAA;EACtB;IAAAY;EAAA,IAAcX,cAAA;EACd;IAAAY,MAAA,EAAAC;EAAA,IAIIf,SAAA;EAHM;IAAAgB,MAAA,EAAAC;EAAA,IAAAF,EAEP;EADS;IAAAG,GAAA,EAAAC;EAAA,IAAAF,EAAiB;EAAA,IAAAG,EAAA;EAAA,IAAAV,CAAA,QAAAS,QAAA,IAAAT,CAAA,QAAAC,IAAA;IAIcS,EAAA,SAAAA,CAAA;MAAA,KACpCT,IAAA;QAAA;MAAA;MAIL,MAAAU,gBAAA,GAAyBjB,EAAA,CAAAkB,SAAA;QAAAC,KAAA;QAAAC,KAAA;UAAAb,IAAA;YAAAc,EAAA;cAAAC,MAAA,EAMPf,IAAA,CAAAc;YAAA;UAAA;QAAA;MAAA;QAAAE,cAAA;MAAA,CAKO;MAAA;MAAA;QAIvB,MAAAC,GAAA,SAAkBC,KAAA,CAChB1B,cAAA;UAAAgB,QAAA;UAAAW,IAAA,EAEQ,uBAAuBT,gBAAA;QAAkB,CACjD;UAAAU,WAAA,EAEe;UAAAC,OAAA;YAAA,gBAEK;UAAA;UAAAC,MAAA,EAEV;QAAA,CACV;QAGF,MAAAC,IAAA,SAAmBN,GAAA,CAAAM,IAAA,CAAQ;QAC3B,MAAAC,OAAA,GAAgBD,IAAA,CAAAC,OAAA;QAAY,IAExBP,GAAA,CAAAQ,EAAA;UACFrC,KAAA,CAAAsC,OAAA,CAAcF,OAAA;QAAA;UAEdpC,KAAA,CAAAuC,KAAA,CAAYH,OAAA;QAAA;MAAA,SAAAI,EAAA;QAEPC,KAAA,CAAAA,IAAA,CAAAA,CAAA,CAAAA,EAAA;MAAA;IAAA;IAGX9B,CAAA,MAAAS,QAAA;IAAAT,CAAA,MAAAC,IAAA;IAAAD,CAAA,MAAAU,EAAA;EAAA;IAAAA,EAAA,GAAAV,CAAA;EAAA;EA7CA,MAAA+B,sBAAA,GAA+BrB,EA6CZ;EAAA,IAAAmB,EAAA;EAAA,IAAA7B,CAAA,QAAAE,SAAA;IAK4B2B,EAAA,GAAAA,CAAA,KAAM3B,SAAA,CAAAL,qBAAU;IAAAG,CAAA,MAAAE,SAAA;IAAAF,CAAA,MAAA6B,EAAA;EAAA;IAAAA,EAAA,GAAA7B,CAAA;EAAA;EAAA,IAAAgC,EAAA;EAAA,IAAAhC,CAAA,QAAA+B,sBAAA,IAAA/B,CAAA,QAAAG,CAAA,IAAAH,CAAA,QAAA6B,EAAA;IAF7DG,EAAA,GAAAC,KAAA,CAAAtC,QAAA;MAAAuC,QAAA,GACEC,IAAA,CAAC;QAAAD,QAAA,EACCC,IAAA,CAAAhD,MAAA;UAAAiD,WAAA,EAAoB;UAAAC,OAAA,EAAqBR,EAAgB;UAAAK,QAAA,EACtD/B,CAAA,CAAE;QAAA,C;UAGPgC,IAAA,CAAA/C,iBAAA;QAAAkD,IAAA,EACQnC,CAAA,CAAE;QAAAoC,eAAA,EACSpC,CAAA,CAAE;QAAAqC,OAAA,EACVrC,CAAA,CAAE;QAAAsC,SAAA,EAAA5C,qBAAA;QAAA6C,SAAA,EAEAX;MAAA,C;;;;;;;;;SAXfC,E;CAeJ","ignoreList":[]}
"use client";import{a as ge,c as dt,d as mt,e as pt}from"./chunk-2S5Q7QYO.js";import{a as Je}from"./chunk-DBWINSQN.js";import{a as ft,b as ze}from"./chunk-QJ5EETIB.js";import{a as he}from"./chunk-INBEEENE.js";import{a as xc}from"./chunk-F26IQ5RE.js";import{b as Jt,c as zt,d as le,e as Xt,f as Cc,g as bc,i as kc,k as _c,l as Tc}from"./chunk-AFXLIYGL.js";import{a as gc,b as H}from"./chunk-BZZVLW4U.js";function Z(t){return{items:t,key:"basic",label:({i18n:e})=>e.t("lexical:general:slashMenuBasicGroupLabel")}}import{c as Lc}from"react/compiler-runtime";import{useLexicalComposerContext as yc}from"@lexical/react/LexicalComposerContext";import{$isDecoratorBlockNode as xe}from"@lexical/react/LexicalDecoratorBlockNode";import{$findMatchingParent as Rc}from"@lexical/utils";import{$getSelection as Ic,$isElementNode as ce,$isNodeSelection as vc,$isRangeSelection as ht,COMMAND_PRIORITY_LOW as Mc,FORMAT_ELEMENT_COMMAND as gt}from"lexical";import{useEffect as Dc}from"react";import{jsx as Po,jsxs as wc}from"react/jsx-runtime";import"react";var ln=()=>wc("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Po("path",{d:"M2.5 5H17.5",stroke:"currentColor",strokeWidth:"1.5"}),Po("path",{d:"M2.5 10H17.5",stroke:"currentColor",strokeWidth:"1.5"}),Po("path",{d:"M5 15H15",stroke:"currentColor",strokeWidth:"1.5"})]});import{jsx as Bo,jsxs as Ec}from"react/jsx-runtime";import"react";var sn=()=>Ec("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Bo("path",{d:"M2.5 5H17.5",stroke:"currentColor",strokeWidth:"1.5"}),Bo("path",{d:"M2.5 10H17.5",stroke:"currentColor",strokeWidth:"1.5"}),Bo("path",{d:"M2.5 15H17.5",stroke:"currentColor",strokeWidth:"1.5"})]});import{jsx as jo,jsxs as Sc}from"react/jsx-runtime";import"react";var Zt=()=>Sc("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[jo("path",{d:"M2.5 5H17.5",stroke:"currentColor",strokeWidth:"1.5"}),jo("path",{d:"M2.5 10H17.5",stroke:"currentColor",strokeWidth:"1.5"}),jo("path",{d:"M2.5 15H12.5",stroke:"currentColor",strokeWidth:"1.5"})]});import{jsx as Ho,jsxs as Nc}from"react/jsx-runtime";import"react";var an=()=>Nc("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Ho("path",{d:"M2.5 5H17.5",stroke:"currentColor",strokeWidth:"1.5"}),Ho("path",{d:"M2.5 10H17.5",stroke:"currentColor",strokeWidth:"1.5"}),Ho("path",{d:"M7.5 15H17.5",stroke:"currentColor",strokeWidth:"1.5"})]});var $=t=>o=>{let r={clientFeatureProps:o};if(typeof t=="function")r.feature=({config:n,featureClientImportMap:l,featureClientSchemaMap:s,featureProviderMap:i,field:d,resolvedFeatures:c,schemaPath:u,unSanitizedEditorConfig:a})=>{let m=t({config:n,featureClientImportMap:l,featureClientSchemaMap:s,featureProviderMap:i,field:d,props:o,resolvedFeatures:c,schemaPath:u,unSanitizedEditorConfig:a});return m.sanitizedClientFeatureProps===null&&(m.sanitizedClientFeatureProps=o),m};else{let n={...t};n.sanitizedClientFeatureProps=o,r.feature=n}return r};var cn=t=>({type:"dropdown",ChildComponent:Zt,items:t,key:"align",order:30});var Ie=t=>ce(t)?t.getFormatType():t.__format,un=[cn([{ChildComponent:Zt,isActive:({selection:t})=>{if(!ht(t))return!1;for(let e of t.getNodes()){if((ce(e)||xe(e))&&Ie(e)==="left")continue;let o=e.getParent();if(!((ce(o)||xe(o))&&Ie(o)==="left"))return!1}return!0},key:"alignLeft",label:({i18n:t})=>t.t("lexical:align:alignLeftLabel"),onSelect:({editor:t})=>{t.dispatchCommand(gt,"left")},order:1},{ChildComponent:ln,isActive:({selection:t})=>{if(!ht(t))return!1;for(let e of t.getNodes()){if((ce(e)||xe(e))&&Ie(e)==="center")continue;let o=e.getParent();if(!((ce(o)||xe(o))&&Ie(o)==="center"))return!1}return!0},key:"alignCenter",label:({i18n:t})=>t.t("lexical:align:alignCenterLabel"),onSelect:({editor:t})=>{t.dispatchCommand(gt,"center")},order:2},{ChildComponent:an,isActive:({selection:t})=>{if(!ht(t))return!1;for(let e of t.getNodes()){if((ce(e)||xe(e))&&Ie(e)==="right")continue;let o=e.getParent();if(!((ce(o)||xe(o))&&Ie(o)==="right"))return!1}return!0},key:"alignRight",label:({i18n:t})=>t.t("lexical:align:alignRightLabel"),onSelect:({editor:t})=>{t.dispatchCommand(gt,"right")},order:3},{ChildComponent:sn,isActive:({selection:t})=>{if(!ht(t))return!1;for(let e of t.getNodes()){if((ce(e)||xe(e))&&Ie(e)==="justify")continue;let o=e.getParent();if(!((ce(o)||xe(o))&&Ie(o)==="justify"))return!1}return!0},key:"alignJustify",label:({i18n:t})=>t.t("lexical:align:alignJustifyLabel"),onSelect:({editor:t})=>{t.dispatchCommand(gt,"justify")},order:4}])],$c=()=>{let t=Lc(3),[e]=yc(),o,r;return t[0]!==e?(o=()=>e.registerCommand(gt,Fc,Mc),r=[e],t[0]=e,t[1]=o,t[2]=r):(o=t[1],r=t[2]),Dc(o,r),null},Ac=$({plugins:[{Component:$c,position:"normal"}],toolbarFixed:{groups:un},toolbarInline:{groups:un}});function Oc(t){return(ce(t)||xe(t))&&!t.isInline()}function Fc(t){let e=Ic();if(!ht(e)&&!vc(e))return!1;let o=e.getNodes();for(let r of o){let n=Rc(r,Oc);n!==null&&n.setFormat(t)}return!0}import{$createQuoteNode as xn,$isQuoteNode as hn,QuoteNode as jc}from"@lexical/rich-text";import{$setBlocksType as Cn}from"@lexical/selection";import{$getSelection as bn,$isRangeSelection as Hc}from"lexical";import{jsx as dn}from"react/jsx-runtime";import"react";var Uo=()=>dn("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:dn("path",{d:"M13.5353 10.5725C13.5353 9.47709 11.0456 9.99991 11.0456 7.85883C11.0456 6.46464 12.1162 5.61816 13.361 5.61816C14.805 5.61816 16 6.86298 16 8.92937C16 11.2945 14.4564 13.7841 11.1203 14.3816L10.8216 13.1368C12.888 12.4895 13.5353 11.4937 13.5353 10.5725ZM6.71369 10.5725C6.71369 9.47709 4.22407 9.99991 4.22407 7.85883C4.22407 6.46464 5.29461 5.61816 6.53942 5.61816C7.9834 5.61816 9.17842 6.86298 9.17842 8.92937C9.17842 11.2945 7.63485 13.7841 4.29876 14.3816L4 13.1368C6.06639 12.4895 6.71369 11.4937 6.71369 10.5725Z",fill:"currentColor"})});import{jsx as mn}from"react/jsx-runtime";import"react";var xt=()=>mn("svg",{"aria-hidden":"true",className:"icon",fill:"currentColor",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:mn("path",{d:"M11.708 14.5H7.79785V13.9414H8.01367C9.00391 13.9414 9.15625 13.9033 9.15625 13.6113V6.70508H8.07715C6.82031 6.70508 6.73145 7.08594 6.28711 8.67285H5.80469L5.91895 6.12109H13.5869L13.7012 8.67285H13.2188C12.7744 7.08594 12.6855 6.70508 11.4287 6.70508H10.3496V13.6113C10.3496 13.9033 10.502 13.9414 11.4922 13.9414H11.708V14.5Z",fill:"currentColor"})});var te=t=>({type:"dropdown",ChildComponent:xt,items:t,key:"text",order:25});import{$createQuoteNode as Pc,$isQuoteNode as pn,QuoteNode as Bc}from"@lexical/rich-text";var fn={type:"element",dependencies:[Bc],export:(t,e)=>{if(!pn(t))return null;let o=e(t).split(`
`),r=[];for(let n of o)r.push("> "+n);return r.join(`
`)},regExp:/^>\s/,replace:(t,e,o,r)=>{if(r){let l=t.getPreviousSibling();if(pn(l)){l.splice(l.getChildrenSize(),0,[...e]),l.select(0,0),t.remove();return}}let n=Pc();n.append(...e),t.replace(n),n.select(0,0)}};var gn=[te([{ChildComponent:Uo,isActive:({selection:t})=>{if(!Hc(t))return!1;for(let e of t.getNodes())if(!hn(e)&&!hn(e.getParent()))return!1;return!0},key:"blockquote",label:({i18n:t})=>t.t("lexical:blockquote:label"),onSelect:({editor:t})=>{t.update(()=>{let e=bn();Cn(e,()=>xn())})},order:20}])],Uc=$({markdownTransformers:[fn],nodes:[jc],slashMenu:{groups:[Z([{Icon:Uo,key:"blockquote",keywords:["quote","blockquote"],label:({i18n:t})=>t.t("lexical:blockquote:label"),onSelect:({editor:t})=>{t.update(()=>{let e=bn();Cn(e,()=>xn())})}}])]},toolbarFixed:{groups:gn},toolbarInline:{groups:gn}});import{getTranslation as io}from"@payloadcms/translations";import{jsx as Wo,jsxs as Wc}from"react/jsx-runtime";import"react";var Yt=()=>Wc("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Wo("rect",{height:"4",rx:"0.5",stroke:"currentColor",width:"4",x:"8",y:"5"}),Wo("rect",{height:"4",rx:"0.5",stroke:"currentColor",width:"4",x:"5",y:"11"}),Wo("rect",{height:"4",rx:"0.5",stroke:"currentColor",width:"4",x:"11",y:"11"})]});import{jsx as kn}from"react/jsx-runtime";import"react";var qt=()=>kn("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:kn("path",{clipRule:"evenodd",d:"M5.33333 6.5C5.11232 6.5 4.90036 6.5878 4.74408 6.74408C4.5878 6.90036 4.5 7.11232 4.5 7.33333V12.1667C4.5 12.3877 4.5878 12.5996 4.74408 12.7559C4.90036 12.9122 5.11232 13 5.33333 13H14.6667C14.8877 13 15.0996 12.9122 15.2559 12.7559C15.4122 12.5996 15.5 12.3877 15.5 12.1667V11.6667C15.5 11.3905 15.7239 11.1667 16 11.1667C16.2761 11.1667 16.5 11.3905 16.5 11.6667V12.1667C16.5 12.6529 16.3068 13.1192 15.963 13.463C15.6192 13.8068 15.1529 14 14.6667 14H5.33333C4.8471 14 4.38079 13.8068 4.03697 13.463C3.69315 13.1192 3.5 12.6529 3.5 12.1667V7.33333C3.5 6.8471 3.69315 6.38079 4.03697 6.03697C4.38079 5.69315 4.8471 5.5 5.33333 5.5H10.3333C10.6095 5.5 10.8333 5.72386 10.8333 6C10.8333 6.27614 10.6095 6.5 10.3333 6.5H5.33333ZM13 6.5C12.7239 6.5 12.5 6.27614 12.5 6C12.5 5.72386 12.7239 5.5 13 5.5H16C16.2761 5.5 16.5 5.72386 16.5 6V9C16.5 9.27614 16.2761 9.5 16 9.5C15.7239 9.5 15.5 9.27614 15.5 9V7.20711L13.3536 9.35355C13.1583 9.54882 12.8417 9.54882 12.6464 9.35355C12.4512 9.15829 12.4512 8.84171 12.6464 8.64645L14.7929 6.5H13ZM6.16699 8.33325C6.16699 8.05711 6.39085 7.83325 6.66699 7.83325H11.0003C11.2765 7.83325 11.5003 8.05711 11.5003 8.33325C11.5003 8.60939 11.2765 8.83325 11.0003 8.83325H6.66699C6.39085 8.83325 6.16699 8.60939 6.16699 8.33325ZM6.16699 10.9999C6.16699 10.7238 6.39085 10.4999 6.66699 10.4999H13.3337C13.6098 10.4999 13.8337 10.7238 13.8337 10.9999C13.8337 11.2761 13.6098 11.4999 13.3337 11.4999H6.66699C6.39085 11.4999 6.16699 11.2761 6.16699 10.9999Z",fill:"currentColor",fillRule:"evenodd"})});import{jsx as Gc}from"react/jsx-runtime";import"react";function Qt(t,e){return t?()=>Gc("img",{alt:e??"Block Image",className:"lexical-block-custom-image",src:t,style:{maxHeight:20,maxWidth:20}}):Yt}import{$parseSerializedNode as vn}from"lexical";import{JSOX as Go}from"jsox";function eo({propsString:t}){let e={},o="",r=!0;for(let n=0;n<t.length;n++){let l=t[n];if(r)l==="="||l===" "?o&&(l===" "?(e[o]=!0,o=""):r=!1):o+=l;else{let s=Vc(t,n);e[o]=s.value,n=s.newIndex,o="",r=!0}}return o&&(e[o]=!0),e}function Vc(t,e){let o=t[e];return o==='"'?_n(t,e):o==="'"?_n(t,e,!0):o==="{"?Jc(t,e):o==="["?Kc(t,e):Xc(t,e)}function Kc(t,e){let o=1,r="",n=e+1;for(;n<t.length&&o>0;)t[n]==="["?o++:t[n]==="]"&&o--,o>0&&(r+=t[n]),n++;return{newIndex:n,value:Go.parse(`[${r}]`)}}function _n(t,e,o=!1){let r="",n=e+1;for(;n<t.length&&(t[n]!==(o?"'":'"')||t[n-1]==="\\");)r+=t[n],n++;return{newIndex:n,value:r}}function Jc(t,e){let o=1,r="",n=e+1;for(;n<t.length&&o>0;)t[n]==="{"?o++:t[n]==="}"&&o--,o>0&&(r+=t[n]),n++;return{newIndex:n,value:zc(r)}}function zc(t){return t[0]!=="{"?Go.parse(t):Go.parse(t.replace(/(\w+):/g,'"$1":'))}function Xc(t,e){let o="",r=e;for(;r<t.length&&t[r]!==" ";)o+=t[r],r++;return{newIndex:r-1,value:o}}function Ct({props:t}){let e=[];for(let[o,r]of Object.entries(t))typeof r=="string"?e.push(`${o}="${Zc(r)}"`):typeof r=="number"?e.push(`${o}={${r}}`):typeof r=="boolean"?r&&e.push(`${o}`):r!==null&&typeof r=="object"&&(Array.isArray(r)?e.push(`${o}={[${r.map(n=>JSON.stringify(n,Tn)).join(", ")}]}`):e.push(`${o}={${JSON.stringify(r,Tn)}}`));return e.join(" ")}function Zc(t){return t.replace(/"/g,"&quot;")}function Tn(t,e){return typeof e=="string"?e.replace(/'/g,"\\'"):e}function to({isEndOptional:t,lines:e,regexpEndRegex:o,startLineIndex:r,startMatch:n,trimChildren:l}){let s="",i="",d=e.slice(r),c=!1,u=0,a=0,m=null,p=!1,f=0,h=d[0].slice(0,n.index),x=0,w=r;e:for(let[N,_]of d.entries()){let C=l?_.trim():_,g=0;if(l)for(let k=0;k<_.length&&_[k]===" ";k++)g++;let b=0;for(N===0&&(b=(n.index??0)+n[0].length-g);b<C.length;){let k=C[b],y=C[b+1];if(c){if(k==="`"&&f++,f%2===0)if(k==="<"&&y==="/"){if(u--,u<0){i[i.length-1]===`
`&&(i=i.slice(0,-1)),w=N;for(let R=b;R<C.length;R++)if(C[R]===">"){x=R+1;break}break e}}else if(k==="/"&&y===">"){if(u--,u<0){i[i.length-1]===`
`&&(i=i.slice(0,-1)),w=N,x=b+2;break e}}else k==="<"&&y!=="/"&&u++;i+=k}else{if(k==="{"&&!m?a++:k==="}"&&!m?a--:(k==='"'||k==="'")&&!m?m=k:k===m&&(m=null),k==="/"&&y===">"&&a===0&&!m){p=!0,w=N,x=b+2;break e}else if(k===">"&&a===0&&!m){c=!0,b++;continue}s+=k}b++}if(c?i?.length>0&&N>0&&(i+=`
`):s+=`
`,o&&u<0){let k=C.match(o);if(k?.index!==void 0){w=N,x=k.index+k[0].length-1;break}}if(N===d.length-1&&!t&&!p)throw new Error("End match not found for lines "+e.join(`
`)+`

. Start match: `+JSON.stringify(n))}return{afterEndLine:d[w].trim().slice(x),beforeStartLine:h,content:i,endLineIndex:r+w,endlineLastCharIndex:x,propsString:s}}import{jsx as Ru}from"react/jsx-runtime";import Iu from"bson-objectid";import{$applyNodeReplacement as vu}from"lexical";import"react";import{DecoratorBlockNode as Yc}from"@lexical/react/LexicalDecoratorBlockNode.js";import{addClassNamesToElement as qc}from"@lexical/utils";import Qc from"bson-objectid";import{$applyNodeReplacement as eu}from"lexical";var bt=class extends Yc{__cacheBuster;__fields;constructor({cacheBuster:e,fields:o,format:r,key:n}){super(r,n),this.__fields=o,this.__cacheBuster=e||0}static clone(e){return new this({cacheBuster:e.__cacheBuster,fields:e.__fields,format:e.__format,key:e.__key})}static getType(){return"block"}static importDOM(){return{}}static importJSON(e){e.version===1&&(e={...e,fields:{...e.fields.data},version:2});let o=tu(e.fields);return o.setFormat(e.format),o}static isInline(){return!1}createDOM(e){let o=document.createElement("div");return qc(o,e?.theme?.block),o}decorate(e,o){return null}exportDOM(){let e=document.createElement("div"),o=document.createTextNode(this.getTextContent());return e.append(o),{element:e}}exportJSON(){return{...super.exportJSON(),type:"block",fields:this.getFields(),version:2}}getCacheBuster(){return this.getLatest().__cacheBuster}getFields(){return this.getLatest().__fields}getTextContent(){return"Block Field"}setFields(e,o){let r=this.getWritable();r.__fields=e,o||r.__cacheBuster++}};function tu(t){return eu(new bt({fields:{...t,id:t?.id||new Qc.default().toHexString()}}))}import{jsx as K,jsxs as kt,Fragment as Nn}from"react/jsx-runtime";import{useLexicalComposerContext as cu}from"@lexical/react/LexicalComposerContext";import{useLexicalEditable as uu}from"@lexical/react/useLexicalEditable";import{getTranslation as du}from"@payloadcms/translations";import{Button as Ln,Collapsible as mu,Drawer as pu,EditDepthProvider as fu,ErrorPill as hu,Form as gu,formatDrawerSlug as xu,FormSubmit as Cu,Pill as bu,RenderFields as ku,SectionTitle as _u,useConfig as Tu,useDocumentForm as wu,useDocumentInfo as yn,useEditDepth as Eu,useFormSubmitted as Su,useServerFunctions as Nu,useTranslation as Lu}from"@payloadcms/ui";import{abortAndIgnore as Vo}from"@payloadcms/ui/shared";import{$getNodeByKey as ro}from"lexical";import{deepCopyObjectSimpleWithoutReactComponents as no,reduceFieldsToValues as Rn}from"payload/shared";import _t,{useCallback as Ko,useEffect as Jo,useMemo as Tt,useRef as zo}from"react";import{v4 as yu}from"uuid";import{c as ou}from"react/compiler-runtime";import{jsx as oo,jsxs as ru}from"react/jsx-runtime";import{useLexicalEditable as nu}from"@lexical/react/useLexicalEditable";import{RenderFields as lu,useFormSubmitted as iu}from"@payloadcms/ui";import su,{createContext as au}from"react";var wn=au({baseClass:"LexicalEditorTheme__block",BlockCollapsible:()=>null,BlockDrawer:()=>null,CustomBlock:null,EditButton:()=>null,errorCount:0,formSchema:[],initialState:!1,nodeKey:"",RemoveButton:()=>null}),Ce=()=>su.use(wn),En=t=>{let e=ou(4),{Collapsible:o,...r}=t,{BlockDrawer:n,CustomBlock:l,errorCount:s,formSchema:i}=r,c=iu()&&s>0,u=nu(),a;e[0]!==o||e[1]!==s||e[2]!==c?(a=p=>{let{children:f,...h}=p;return oo(o,{errorCount:s,fieldHasErrors:c,...h,children:f})},e[0]=o,e[1]=s,e[2]=c,e[3]=a):a=e[3];let m=a;return l?ru(wn,{value:{...r,BlockCollapsible:m},children:[l,oo(n,{})]}):oo(m,{children:oo(lu,{fields:i,forceRender:!0,parentIndexPath:"",parentPath:"",parentSchemaPath:"",permissions:!0,readOnly:!u})})};function Sn({fields:t}){for(let e in t){let o=t[e];Array.isArray(o?.rows)&&"value"in o&&(o.disableFormData=!0)}return t}var In=t=>{let{cacheBuster:e,className:o,formData:r,nodeKey:n}=t,l=Su(),{id:s,collectionSlug:i,globalSlug:d}=yn(),{fieldProps:{featureClientSchemaMap:c,field:u,initialLexicalFormState:a,schemaPath:m},uuid:p}=H(),{fields:f}=wu(),h=zo(new AbortController),x=Eu(),[w,E]=_t.useState(0),{config:N}=Tu(),_=xu({slug:`lexical-blocks-create-${p}-${r.id}`,depth:x}),{toggleDrawer:C}=he(_),{getDocPreferences:g,setDocFieldPreferences:b}=yn(),[k]=cu(),y=uu(),R=r.blockType,{getFormState:M}=Nu(),L=`${m}.lexical_internal_feature.blocks.lexical_blocks.${R}.fields`,[T,S]=_t.useState(()=>{let j=a?.[r.id]?.formState;if(!j)return!1;let ee=Object.fromEntries(Object.entries(j).map(([U,V])=>[U,U in r?{...V,initialValue:r[U],value:r[U]}:V]));return ee.blockName={initialValue:r.blockName,passesCondition:!0,valid:!0,value:r.blockName},ee}),I=zo(!1),A=zo(e);Jo(()=>{I.current?(A.current!==e&&S(!1),A.current=e):I.current=!0},[e]);let[v,O]=_t.useState(T?._components?.customComponents?.BlockLabel??void 0),[D,G]=_t.useState(T?._components?.customComponents?.Block??void 0);Jo(()=>{let j=new AbortController;return r&&!T&&(async()=>{let{state:U}=await M({id:s,collectionSlug:i,data:r,docPermissions:{fields:!0},docPreferences:await g(),documentFormState:no(f,{excludeFiles:!0}),globalSlug:d,initialBlockData:r,operation:"update",readOnly:!y,renderAllFields:!0,schemaPath:L,signal:j.signal});if(U){U.blockName={initialValue:r.blockName,passesCondition:!0,valid:!0,value:r.blockName};let V=Rn(no(U,{excludeFiles:!0}),!0);k.update(()=>{let Q=ro(n);if(Q&&$e(Q)){let ne=V;ne.blockType=R,Q.setFields(ne,!0)}}),S(U),O(U._components?.customComponents?.BlockLabel??void 0),G(U._components?.customComponents?.Block??void 0)}})(),()=>{Vo(j)}},[M,L,y,s,r,k,n,T,i,d,g,f,R]);let[q,z]=_t.useState(a?.[r.id]?.collapsed??!1),Ut=`${m}.lexical_internal_feature.blocks.lexical_blocks.${R}`,X=c.blocks?.[Ut]?.[0],W=X.blockReferences?typeof X?.blockReferences?.[0]=="string"?N.blocksMap[X?.blockReferences?.[0]]:X?.blockReferences?.[0]:X?.blocks?.[0],{i18n:Ge,t:ye}=Lu(),fe=Ko(async({formState:j,submit:ee})=>{Vo(h.current);let U=new AbortController;h.current=U;let{state:V}=await M({id:s,collectionSlug:i,docPermissions:{fields:!0},docPreferences:await g(),documentFormState:no(f,{excludeFiles:!0}),formState:j,globalSlug:d,initialBlockFormState:j,operation:"update",readOnly:!y,renderAllFields:!!ee,schemaPath:L,signal:U.signal});if(!V)return j;j.blockName&&(V.blockName=j.blockName);let Q=Rn(Sn({fields:no(V,{excludeFiles:!0})}),!0);if(setTimeout(()=>{k.update(()=>{let ne=ro(n);if(ne&&$e(ne)){let Ke=Q;Ke.blockType=R,ne.setFields(Ke,!0)}})},0),ee){O(V._components?.customComponents?.BlockLabel??void 0),G(V._components?.customComponents?.Block??void 0);let ne=0;for(let Ke of Object.values(V))Ke?.valid===!1&&ne++;E(ne)}return V},[M,s,i,g,d,L,R,f,y,k,n]);Jo(()=>()=>{Vo(h.current)},[]);let Gt=Ko(()=>{k.update(()=>{ro(n)?.remove()})},[k,n]),Re=W?.labels?.singular?du(W.labels.singular,Ge):W?.slug,Vt=Ko(j=>{g().then(ee=>{let V=ee?.fields?.[u.name]?.collapsed,Q=V&&V?.length?V:[];j?Q.includes(r.id)||Q.push(r.id):Q.includes(r.id)&&Q.splice(Q.indexOf(r.id),1),b(u.name,{collapsed:Q,hello:"hi"})})},[g,u.name,b,r.id]),Ve=Tt(()=>()=>K(Ln,{buttonStyle:"icon-label",className:`${o}__editButton`,disabled:!y,el:"button",icon:"edit",onClick:j=>(j.preventDefault(),j.stopPropagation(),C(),!1),onMouseDown:j=>{j.preventDefault()},round:!0,size:"small",tooltip:ye("lexical:blocks:inlineBlocks:edit",{label:Re})}),[o,y,ye,Re,C]),Kt=Tt(()=>()=>K(Ln,{buttonStyle:"icon-label",className:`${o}__removeButton`,disabled:!y,icon:"x",onClick:j=>{j.preventDefault(),Gt()},round:!0,tooltip:"Remove Block"}),[o,y,Gt]),Oo=Tt(()=>({Actions:j,children:ee,className:U,collapsibleProps:V,disableBlockName:Q,editButton:ne,errorCount:Ke,fieldHasErrors:Fo,Label:on,Pill:rn,removeButton:hc})=>K("div",{className:`${o}__container ${o}-${R}`,children:K(mu,{className:[`${o}__row`,Fo?`${o}__row--has-errors`:`${o}__row--no-errors`,U].filter(Boolean).join(" "),collapsibleStyle:Fo?"error":"default",header:kt("div",{className:`${o}__block-header`,children:[typeof on<"u"?on:typeof v<"u"?v:kt("div",{className:`${o}__block-label`,children:[typeof rn<"u"?rn:K(bu,{className:`${o}__block-pill ${o}__block-pill-${R}`,pillStyle:"white",size:"small",children:Re??R}),!Q&&!W?.admin?.disableBlockName&&K(_u,{path:"blockName",readOnly:!y}),Fo&&K(hu,{count:Ke??0,i18n:Ge,withMessage:!0})]}),K("div",{className:`${o}__block-actions`,children:typeof j<"u"?j:kt(Nn,{children:[D&&ne!==!1||!D&&ne?K(Ve,{}):null,hc!==!1&&y?K(Kt,{}):null]})})]}),isCollapsed:q,onToggle:nn=>{Vt(nn),z(nn)},...V||{},children:ee},0)}),[D,v,Ve,Kt,Re,o,W?.admin?.disableBlockName,R,Ge,q,Vt,y]),en=r?.id,tn=Tt(()=>()=>K(fu,{children:K(pu,{className:"",slug:_,title:ye(`lexical:blocks:inlineBlocks:${en?"edit":"create"}`,{label:Re??ye("lexical:blocks:inlineBlocks:label")}),children:T?kt(Nn,{children:[K(ku,{fields:W?.fields??[],forceRender:!0,parentIndexPath:"",parentPath:"",parentSchemaPath:L,permissions:!0,readOnly:!y}),K(Cu,{programmaticSubmit:!0,children:ye("fields:saveChanges")})]}):null})}),[T,_,en,Re,ye,y,W?.fields,L]),fc=Tt(()=>T?K(gu,{beforeSubmit:[async({formState:j})=>await fe({formState:j,submit:!0})],el:"div",fields:W?.fields??[],initialState:T,onChange:[fe],onSubmit:(j,ee)=>{ee.blockType=R,k.update(()=>{let U=ro(n);U&&$e(U)&&U.setFields(ee,!0)}),C()},submitted:l,uuid:yu(),children:K(En,{baseClass:o,BlockDrawer:tn,Collapsible:Oo,CustomBlock:D,EditButton:Ve,errorCount:w,formSchema:W?.fields??[],initialState:T,nodeKey:n,RemoveButton:Kt})}):null,[Oo,tn,D,R,Kt,Ve,o,k,w,C,W?.fields,T,n,fe,l]);return W?fc:K(Oo,{disableBlockName:!0,fieldHasErrors:!0,children:kt("div",{className:`${o}-not-found`,children:["Error: Block '",R,"' not found in the config but exists in the lexical data"]})})};var ie=class extends bt{static clone(e){return super.clone(e)}static getType(){return super.getType()}static importJSON(e){e.version===1&&(e={...e,fields:{...e.fields.data},version:2});let o=Ae(e.fields);return o.setFormat(e.format),o}decorate(e,o){return Ru(In,{cacheBuster:this.getCacheBuster(),className:o.theme.block??"LexicalEditorTheme__block",formData:this.getFields(),nodeKey:this.getKey()})}exportJSON(){return super.exportJSON()}};function Ae(t){return vu(new ie({fields:{...t,id:t?.id||new Iu.default().toHexString()}}))}function $e(t){return t instanceof ie}import{createHeadlessEditor as Mu}from"@lexical/headless";function Xo(t,e){return({editorState:r})=>{let n=Mu({nodes:t});try{n.setEditorState(n.parseEditorState(r))}catch(s){console.error("getLexicalToMarkdown: ERROR parsing editor state",s)}let l="";return n.getEditorState().read(()=>{l=zt(e)}),l}}import{createHeadlessEditor as Du}from"@lexical/headless";function lo(t,e){return({markdown:r})=>{let n=Du({nodes:t});return n.update(()=>{Jt(r,e)},{discrete:!0}),n.getEditorState().toJSON()}}function $u(t){let e=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{regExpEnd:new RegExp(`</(${e})\\s*>|<${e}[^>]*?/>`,"i"),regExpStart:new RegExp(`<(${e})([^>]*?)\\s*(/?)>`,"i")}}var Dn=({blocks:t,inlineBlocks:e})=>{if(!t?.length&&!e?.length)return[];let o=[];if(t?.length)for(let r of t){let n=Mn(r,!1);n&&(o=o.concat(n))}if(e?.length)for(let r of e){let n=Mn(r,!0);n&&(o=o.concat(n))}return o};function Mn(t,e){if(!t.jsx)return null;let o=$u(t.slug),r=[];return e?(r.push(({allNodes:n,allTransformers:l})=>({type:"text-match",dependencies:[dt],export:s=>{if(!pt(s)||s.getFields()?.blockType?.toLowerCase()!==t.slug.toLowerCase())return null;let i=s.getFields(),d=Xo(n,l),c=t.jsx.export({fields:i,lexicalToMarkdown:d});if(c===!1)return null;if(typeof c=="string")return c;let u=c.props&&Object.keys(c.props)?.length>0,a=c.props??{};return c?.children?.length?`<${i.blockType}${u?" "+Ct({props:a}):""}>${c.children}</${i.blockType}>`:`<${i.blockType}${u?" "+Ct({props:a}):""}/>`},getEndIndex:(s,i)=>{let{endlineLastCharIndex:d}=to({isEndOptional:!1,lines:[s.getTextContent()],regexpEndRegex:o.regExpEnd,startLineIndex:0,startMatch:i,trimChildren:!1});return d},importRegExp:t.jsx?.customStartRegex??o.regExpStart,regExp:/___ignoreignoreignore___/g,replace(s,i){let{content:d,propsString:c}=to({isEndOptional:!1,lines:[s.getTextContent()],regexpEndRegex:o.regExpEnd,startLineIndex:0,startMatch:{...i,index:0},trimChildren:!1});if(!t?.jsx?.import)return;let u=lo(n,l),a=t.jsx.import({children:d,closeMatch:null,htmlToLexical:null,markdownToLexical:u,openMatch:i,props:c?eo({propsString:c}):{}});if(a===!1)return;let m=mt({blockType:t.slug,...a});s.replace(m)}})),r):(r.push(({allNodes:n,allTransformers:l})=>({dependencies:[ie],export:s=>{if(!$e(s)||s.getFields()?.blockType?.toLowerCase()!==t.slug.toLowerCase())return null;let i=s.getFields(),d=Xo(n,l),c=t.jsx.export({fields:i,lexicalToMarkdown:d});if(c===!1)return null;if(typeof c=="string")return c;let u=c.props&&Object.keys(c.props)?.length>0,a=c.props??{};if(c?.children?.length){let m=c.children,p="";if(m.includes(`
`))for(let f of m.split(`
`)){let h="";!t?.jsx?.doNotTrimChildren&&f!==""&&(h="  "),h+=f+`
`,p+=h}else p=(t?.jsx?.doNotTrimChildren?"":"  ")+m+`
`;return`<${i.blockType}${u?" "+Ct({props:a}):""}>
${p}</${i.blockType}>`}return`<${i.blockType}${u?" "+Ct({props:a}):""}/>`},handleImportAfterStartMatch:t.jsx?.customEndRegex?void 0:({lines:s,rootNode:i,startLineIndex:d,startMatch:c,transformer:u})=>{let a=typeof u.regExpEnd=="object"&&"regExp"in u.regExpEnd?u.regExpEnd.regExp:u.regExpEnd,m=u.regExpEnd&&typeof u.regExpEnd=="object"&&"optional"in u.regExpEnd?u.regExpEnd.optional:!u.regExpEnd,{afterEndLine:p,beforeStartLine:f,content:h,endLineIndex:x,propsString:w}=to({isEndOptional:m,lines:s,regexpEndRegex:a,startLineIndex:d,startMatch:c,trimChildren:!1}),E="";if(t?.jsx?.doNotTrimChildren)E=h.endsWith(`
`)?h.slice(0,-1):h;else if(h.includes(`
`)){let g=h.split(`
`),b=0;for(let k of g){if(b++,k.startsWith("  "))E+=k.slice(2);else if(k==="")E+=k;else{E=h.endsWith(`
`)?h.slice(0,-1):h;break}E+=b===g.length?"":`
`}}else E=(h.startsWith("  ")?h.slice(2):h)+`
`;if(!t?.jsx?.import)return[!1,d];let N=lo(n,l),_=t.jsx.import({children:E,closeMatch:null,htmlToLexical:null,markdownToLexical:N,openMatch:c,props:w?eo({propsString:w}):{}});if(_===!1)return[!1,d];let C=Ae({blockType:t.slug,..._});if(C){let g=null,b=null;if(f?.length){g=N({markdown:f})?.root?.children??[];let k=g?.[0];k&&i.append(vn(k))}if(i.append(C),p?.length){b=N({markdown:p})?.root?.children;let k=i.getChildren()[i.getChildren().length-1],y=vn(b[0])?.getChildren();if(y?.length)for(let R of y)k.append(R)}}return[!0,x]},regExpEnd:t.jsx?.customEndRegex??o.regExpEnd,regExpStart:t.jsx?.customStartRegex??o.regExpStart,type:"multiline-element",replace:(s,i,d,c,u)=>{if(t?.jsx?.import){if(!u){let x="";if(i)for(let w of i)x+=w.getTextContent();u=[x]}let a="";t?.jsx?.doNotTrimChildren?a=u.join(`
`):a=u.join(`
`).trim();let m=d[1]?.trim(),p=lo(n,l),f=t.jsx.import({children:a,closeMatch:c,htmlToLexical:null,markdownToLexical:p,openMatch:d,props:m?eo({propsString:m}):{}});if(f===!1)return!1;let h=Ae({blockType:t.slug,...f});h&&s.append(h);return}return!1}})),r)}import{createCommand as $n}from"lexical";var Xe=$n("INSERT_BLOCK_COMMAND"),Ze=$n("INSERT_INLINE_BLOCK_COMMAND");import{c as Au}from"react/compiler-runtime";import{useLexicalComposerContext as Ou}from"@lexical/react/LexicalComposerContext.js";import{$insertNodeToNearestRoot as Fu,$wrapNodeInElement as Pu,mergeRegister as Bu}from"@lexical/utils";import{formatDrawerSlug as ju,useEditDepth as Hu}from"@payloadcms/ui";import{$createParagraphNode as Uu,$getNodeByKey as Wu,$getPreviousSelection as Gu,$getSelection as Vu,$insertNodes as Ku,$isParagraphNode as Ju,$isRangeSelection as zu,$isRootOrShadowRoot as Xu,COMMAND_PRIORITY_EDITOR as An}from"lexical";import{useEffect as Zu,useState as Yu}from"react";var On=()=>{let t=Au(12),[e]=Ou(),[o,r]=Yu(null),{setCreatedInlineBlock:n,uuid:l}=H(),s=Hu(),i="lexical-inlineBlocks-create-"+l,d;t[0]!==s||t[1]!==i?(d=ju({slug:i,depth:s}),t[0]=s,t[1]=i,t[2]=d):d=t[2];let c=d,{toggleDrawer:u}=he(c,!0),a;t[3]!==e||t[4]!==n||t[5]!==o?(a=()=>{if(!e.hasNodes([ie]))throw new Error("BlocksPlugin: BlocksNode not registered on editor");return Bu(e.registerCommand(Xe,p=>(e.update(()=>{let f=Vu()||Gu();if(zu(f)){let h=Ae(p),{focus:x}=f,w=x.getNode();Fu(h),Ju(w)&&!w.__first&&w.remove()}}),!0),An),e.registerCommand(Ze,p=>{if(o){let h=Wu(o);return!h||!pt(h)?!1:(h.setFields(p),r(null),!0)}let f=mt(p);return n?.(f),Ku([f]),Xu(f.getParentOrThrow())&&Pu(f,Uu).selectEnd(),!0},An))},t[3]=e,t[4]=n,t[5]=o,t[6]=a):a=t[6];let m;return t[7]!==e||t[8]!==n||t[9]!==o||t[10]!==u?(m=[e,n,o,u],t[7]=e,t[8]=n,t[9]=o,t[10]=u,t[11]=m):m=t[11],Zu(a,m),null};var qu=$(({config:t,featureClientSchemaMap:e,props:o,schemaPath:r})=>{let n=`${r}.lexical_internal_feature.blocks.lexical_blocks`,l=`${r}.lexical_internal_feature.blocks.lexical_inline_blocks`,s=e.blocks;if(!s)return{};let i=Object.entries(s).filter(([a])=>a.startsWith(n+".")&&!a.replace(n+".","").includes(".")).map(([,a])=>a[0]),d=Object.entries(s).filter(([a])=>a.startsWith(l+".")&&!a.replace(l+".","").includes(".")).map(([,a])=>a[0]),c=i.map(a=>a.blockReferences?typeof a.blockReferences[0]=="string"?t.blocksMap[a.blockReferences[0]]:a.blockReferences[0]:a.blocks[0]).filter(a=>a!==void 0),u=d.map(a=>a.blockReferences?typeof a.blockReferences[0]=="string"?t.blocksMap[a.blockReferences[0]]:a.blockReferences[0]:a.blocks[0]).filter(a=>a!==void 0);return{markdownTransformers:Dn({blocks:c,inlineBlocks:u}),nodes:[ie,dt],plugins:[{Component:On,position:"normal"}],sanitizedClientFeatureProps:o,slashMenu:{groups:[c?.length?{items:c.map(a=>({Icon:Qt(a.imageURL,a.imageAltText),key:"block-"+a.slug,keywords:["block","blocks",a.slug],label:({i18n:m})=>a?.labels?.singular?io(a.labels.singular,m):a?.slug,onSelect:({editor:m})=>{m.dispatchCommand(Xe,{blockName:"",blockType:a.slug})}})),key:"blocks",label:({i18n:a})=>a.t("lexical:blocks:label")}:null,u?.length?{items:u.map(a=>({Icon:qt,key:"inlineBlocks-"+a.slug,keywords:["inlineBlock","inline block",a.slug],label:({i18n:m})=>a?.labels?.singular?io(a.labels.singular,m):a?.slug,onSelect:({editor:m})=>{m.dispatchCommand(Ze,{blockName:"",blockType:a.slug})}})),key:"inlineBlocks",label:({i18n:a})=>a.t("lexical:blocks:inlineBlocks:label")}:null].filter(Boolean)},toolbarFixed:{groups:[c.length?{type:"dropdown",ChildComponent:Yt,items:c.map((a,m)=>({ChildComponent:Qt(a.imageURL,a.imageAltText),isActive:void 0,key:"block-"+a.slug,label:({i18n:p})=>a?.labels?.singular?io(a.labels.singular,p):a?.slug,onSelect:({editor:p})=>{p.dispatchCommand(Xe,{blockName:"",blockType:a.slug})},order:m})),key:"blocks",order:20}:null,u?.length?{type:"dropdown",ChildComponent:qt,items:u.map((a,m)=>({ChildComponent:a.imageURL?Qt(a.imageURL,a.imageAltText):qt,isActive:void 0,key:"inlineBlock-"+a.slug,label:({i18n:p})=>a?.labels?.singular?io(a.labels.singular,p):a?.slug,onSelect:({editor:p})=>{p.dispatchCommand(Ze,{blockName:"",blockType:a.slug})},order:m})),key:"inlineBlocks",order:25}:null].filter(Boolean)}}});import{c as td}from"react/compiler-runtime";import{jsx as Fe,jsxs as Qo}from"react/jsx-runtime";import{useLexicalComposerContext as od}from"@lexical/react/LexicalComposerContext.js";import{$createParagraphNode as rd,$createTextNode as nd,$getRoot as ld,getDOMSelection as Zo}from"lexical";import*as Hn from"react";import{useCallback as Oe,useEffect as Yo,useLayoutEffect as Pn,useRef as qo,useState as so}from"react";var Qu=le&&"documentMode"in document?document.documentMode:null,Fn=le&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),z5=le&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),X5=le&&"InputEvent"in window&&!Qu?"getTargetRanges"in new window.InputEvent("input"):!1,Z5=le&&/Version\/[\d.].*Safari/.test(navigator.userAgent),Y5=le&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,q5=le&&/Android/.test(navigator.userAgent),Q5=le&&/Win/.test(navigator.platform),ed=le&&/^(?=.*Chrome).*/i.test(navigator.userAgent),e6=le&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!ed;var id=t=>{let e=document.createElement("textarea");e.value=t||"",e.style.position="absolute",e.style.opacity="0",document.body?.appendChild(e),e.focus(),e.select();try{let o=document.execCommand("copy");console.log(o)}catch(o){console.error(o)}document.body?.removeChild(e)},sd=(t,e)=>{let o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e||"")),o.setAttribute("download",t),o.style.display="none",document.body?.appendChild(o),o.click(),document.body?.removeChild(o)},ad=t=>{let o=((r,n)=>{switch(r){case"click":return`      await page.mouse.click(${n.x}, ${n.y});`;case"keydown":return`      await page.keyboard.keydown('${n}');`;case"keyup":return`      await page.keyboard.keyup('${n}');`;case"press":return`      await page.keyboard.press('${n}');`;case"selectAll":return"      await selectAll(page);";case"snapshot":return`      await assertHTMLSnapshot(page);
      await assertSelection(page, {
        anchorPath: [${n.anchorPath.toString()}],
        anchorOffset: ${n.anchorOffset},
        focusPath: [${n.focusPath.toString()}],
        focusOffset: ${n.focusOffset},
      });
`;case"type":return`      await page.keyboard.type('${n}');`;default:return""}})(t.name,t.value);switch(t.count){case 1:return o;case 2:return[o,o].join(`
`);default:return`      await repeat(${t.count}, async () => {
  ${o}
      );`}};function cd(t){return t.key.toLowerCase()==="a"&&(Fn?t.metaKey:t.ctrlKey)}function ud(t){let{anchorNode:e,focusNode:o}=t,{anchorOffset:r,focusOffset:n}=t;return r!==0&&r--,n!==0&&n--,{anchorNode:e,anchorOffset:r,focusNode:o,focusOffset:n}}function Bn(t,e){let o=t,r=[];for(;o!==e;)o!=null&&r.unshift(Array.from(o?.parentNode?.childNodes??[]).indexOf(o)),o=o?.parentNode;return r}var jn=new Set(["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","Backspace","Delete","Enter","Escape"]);function dd(t){let[e,o]=so([]),[r,n]=so(!1),[,l]=so(""),[s,i]=so(""),d=qo(null),c=qo(!1),u=qo(null),a=Oe(()=>t,[t]),m=Oe(()=>{let _=t.getRootElement(),C=Zo(t._window);return _==null||C==null||C.anchorNode==null||C.focusNode==null||!_.contains(C.anchorNode)||!_.contains(C.focusNode)?null:`
import {
  initializeE2E,
  assertHTMLSnapshot,
  assertSelection,
  repeat,
} from '../utils';
import {selectAll} from '../keyboardShortcuts';
import { RangeSelection } from 'lexical';
import { NodeSelection } from 'lexical';

describe('Test case', () => {
  initializeE2E((e2e) => {
    it('Should pass this test', async () => {
      const {page} = e2e;

      await page.focus('div[contenteditable="true"]');
${e.map(ad).join(`
`)}
    });
});
    `},[t,e]),p=Oe((_,C)=>{o(g=>{let b=e.length-1,k=e[b];if(k&&k.name===_){if(_==="type")return[...e.slice(0,b),{...k,value:k.value+C}];if(k.value===C)return[...e.slice(0,b),{...k,count:k.count+1}]}return[...g,{name:_,count:1,value:C}]})},[e,o]);Pn(()=>{let _=g=>{if(!r)return;let b=g.key;cd(g)?p("selectAll",""):jn.has(b)?p("press",g.key):[...b].length>1?p("keydown",g.key):p("type",g.key)},C=g=>{if(!r)return;let b=g.key;!jn.has(b)&&[...b].length>1&&p("keyup",g.key)};return t.registerRootListener((g,b)=>{b!==null&&(b.removeEventListener("keydown",_),b.removeEventListener("keyup",C)),g!==null&&(g.addEventListener("keydown",_),g.addEventListener("keyup",C))})},[t,r,p]),Pn(()=>{u.current&&u.current.scrollTo(0,u.current.scrollHeight)},[m]),Yo(()=>{if(e){let _=m();_!==null&&i(_),u.current&&u.current.scrollTo(0,u.current.scrollHeight)}},[m,e]),Yo(()=>t.registerUpdateListener(({dirtyElements:C,dirtyLeaves:g,editorState:b})=>{if(!r)return;let k=b._selection,y=d.current,R=c.current;if(y!==k){if(g.size===0&&C.size===0&&!R){let L=Zo(t._window);if(L&&(L.anchorNode==null||L.focusNode==null))return}d.current=k}c.current=!1;let M=m();M!==null&&i(M)}),[t,m,r,p]),Yo(()=>r?t.registerUpdateListener(()=>{let C=t.getRootElement();C!==null&&l(C?.innerHTML)}):void 0,[t,r]);let f=Oe(_=>{r||(_.update(()=>{let C=ld();C.clear();let g=nd();C.append(rd().append(g)),g.select()}),o([])),n(C=>!C)},[r]),h=Oe(()=>{if(!r)return;let _=Zo(t._window);if(_===null||_.anchorNode==null||_.focusNode==null)return;let{anchorNode:C,anchorOffset:g,focusNode:b,focusOffset:k}=ud(_),y=a().getRootElement(),R;C!==null&&(R=Bn(C,y));let M;b!==null&&(M=Bn(b,y)),p("snapshot",{anchorNode:C,anchorOffset:g,anchorPath:R,focusNode:b,focusOffset:k,focusPath:M})},[p,r,a]),x=Oe(()=>{id(m())},[m]),w=Oe(()=>{sd("test.js",m())},[m]);return[Fe("button",{className:`editor-dev-button ${r?"active":""}`,id:"test-recorder-button",onClick:_=>{f(a()),_.preventDefault()},title:r?"Disable test recorder":"Enable test recorder",type:"button",children:r?"Disable test recorder":"Enable test recorder"}),r?Qo("div",{className:"test-recorder-output",children:[Qo("div",{className:"test-recorder-toolbar",children:[Fe("button",{className:"test-recorder-button",id:"test-recorder-button-snapshot",onClick:_=>{h(),_.preventDefault()},title:"Insert snapshot",type:"button",children:"Insert Snapshot"}),Fe("button",{className:"test-recorder-button",id:"test-recorder-button-copy",onClick:_=>{x(),_.preventDefault()},title:"Copy to clipboard",type:"button",children:"Copy"}),Fe("button",{className:"test-recorder-button",id:"test-recorder-button-download",onClick:_=>{w(),_.preventDefault()},title:"Download as a file",type:"button",children:"Download"})]}),Fe("pre",{id:"test-recorder",ref:u,children:s})]}):null]}var Un=()=>{let t=td(3),[e]=od(),[o,r]=dd(e),n;return t[0]!==o||t[1]!==r?(n=Qo(Hn.Fragment,{children:[Fe("p",{children:"HI"}),o,r,Fe("p",{children:"DONE"})]}),t[0]=o,t[1]=r,t[2]=n):n=t[2],n};var md=$({plugins:[{Component:Un,position:"bottom"}]});import{c as pd}from"react/compiler-runtime";import{jsx as fd}from"react/jsx-runtime";import{useLexicalComposerContext as hd}from"@lexical/react/LexicalComposerContext.js";import{TreeView as gd}from"@lexical/react/LexicalTreeView.js";import"react";var Wn=()=>{let t=pd(2),[e]=hd(),o;return t[0]!==e?(o=fd(gd,{editor:e,timeTravelButtonClassName:"debug-timetravel-button",timeTravelPanelButtonClassName:"debug-timetravel-panel-button",timeTravelPanelClassName:"debug-timetravel-panel",timeTravelPanelSliderClassName:"debug-timetravel-panel-slider",treeTypeButtonClassName:"debug-treetype-button",viewClassName:"tree-view-output"}),t[0]=e,t[1]=o):o=t[1],o};var xd=$({plugins:[{Component:Wn,position:"bottom"}]});import{$isTableSelection as Cd}from"@lexical/table";import{$isRangeSelection as bd,FORMAT_TEXT_COMMAND as kd}from"lexical";import{jsx as Gn}from"react/jsx-runtime";import"react";var Vn=()=>Gn("svg",{"aria-hidden":"true",className:"icon",fill:"currentColor",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:Gn("path",{d:"M10.6772 15H6.27017V5.718H10.4172C12.6792 5.718 13.8492 6.602 13.8492 8.292C13.8492 9.098 13.1992 9.982 12.4712 10.216C13.3812 10.476 14.1742 11.256 14.1742 12.322C14.1742 14.09 12.9002 15 10.6772 15ZM8.46717 9.501H10.3262C11.3012 9.501 11.7042 9.046 11.7042 8.409C11.7042 7.72 11.2362 7.317 10.3392 7.317H8.46717V9.501ZM8.46717 11.061V13.401H10.4822C11.4702 13.401 11.9642 12.959 11.9642 12.218C11.9642 11.49 11.4702 11.061 10.4822 11.061H8.46717Z",fill:"currentColor"})});var Y=t=>({type:"buttons",items:t,key:"format",order:40});var Kn={type:"text-format",format:["bold","italic"],tag:"***"},Jn={type:"text-format",format:["bold","italic"],intraword:!1,tag:"___"},zn={type:"text-format",format:["bold"],tag:"**"},Xn={type:"text-format",format:["bold"],intraword:!1,tag:"__"};var Zn=[Y([{ChildComponent:Vn,isActive:({selection:t})=>bd(t)||Cd(t)?t.hasFormat("bold"):!1,key:"bold",onSelect:({editor:t})=>{t.dispatchCommand(kd,"bold")},order:1}])],_d=$(({featureProviderMap:t})=>{let e=[zn,Xn];return t.get("italic")&&e.push(Jn,Kn),{enableFormats:["bold"],markdownTransformers:e,toolbarFixed:{groups:Zn},toolbarInline:{groups:Zn}}});import{$isTableSelection as wd}from"@lexical/table";import{$isRangeSelection as Ed,FORMAT_TEXT_COMMAND as Sd}from"lexical";import{jsx as Yn,jsxs as Td}from"react/jsx-runtime";import"react";var qn=()=>Td("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Yn("path",{d:"M7.76465 6L3.76465 10L7.76465 14",stroke:"currentColor"}),Yn("path",{d:"M12.2354 6L16.2354 10L12.2354 14",stroke:"currentColor"})]});var Qn={type:"text-format",format:["code"],tag:"`"};var el=[Y([{ChildComponent:qn,isActive:({selection:t})=>Ed(t)||wd(t)?t.hasFormat("code"):!1,key:"inlineCode",onSelect:({editor:t})=>{t.dispatchCommand(Sd,"code")},order:7}])],Nd=$({enableFormats:["code"],markdownTransformers:[Qn],toolbarFixed:{groups:el},toolbarInline:{groups:el}});import{$isTableSelection as Ld}from"@lexical/table";import{$isRangeSelection as yd,FORMAT_TEXT_COMMAND as Rd}from"lexical";import{jsx as tl}from"react/jsx-runtime";import"react";var ol=()=>tl("svg",{"aria-hidden":"true",className:"icon",fill:"currentColor",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:tl("path",{d:"M11.311 14.2969L11.0327 15H6.18408L6.4624 14.2969C7.54639 14.2969 7.70752 14.209 7.83936 13.8721L10.8423 6.45996C10.8716 6.38672 10.8862 6.32812 10.8862 6.26953C10.8862 6.09375 10.6519 6.03516 9.80225 6.03516L10.0952 5.33203H14.9438L14.6509 6.03516C13.5669 6.03516 13.4204 6.12305 13.2886 6.45996L10.2856 13.8721C10.2563 13.9453 10.2271 14.0039 10.2271 14.0625C10.2271 14.2383 10.4614 14.2969 11.311 14.2969Z",fill:"currentColor"})});var rl={type:"text-format",format:["italic"],tag:"*"},nl={type:"text-format",format:["italic"],intraword:!1,tag:"_"};var ll=[Y([{ChildComponent:ol,isActive:({selection:t})=>yd(t)||Ld(t)?t.hasFormat("italic"):!1,key:"italic",onSelect:({editor:t})=>{t.dispatchCommand(Rd,"italic")},order:2}])],Id=$({enableFormats:["italic"],markdownTransformers:[rl,nl],toolbarFixed:{groups:ll},toolbarInline:{groups:ll}});import{$isTableSelection as Md}from"@lexical/table";import{$isRangeSelection as Dd,FORMAT_TEXT_COMMAND as $d}from"lexical";import{jsx as il,jsxs as vd}from"react/jsx-runtime";import"react";var sl=()=>vd("svg",{"aria-hidden":"true",className:"icon",fill:"currentColor",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[il("path",{d:"M5.50756 12.76H7.42756C7.56256 14.215 8.82256 14.71 10.1576 14.71C11.4326 14.71 12.4226 14.14 12.4226 13.06C12.4226 12.28 11.9576 11.845 10.6676 11.605L8.70256 11.245C7.12756 10.96 5.85256 10.21 5.85256 8.335C5.85256 6.43 7.53256 5.11 9.87256 5.11C12.4226 5.11 13.9526 6.22 14.1626 8.23H12.2876C12.1526 7.18 11.2226 6.595 9.88756 6.595C8.59756 6.595 7.78756 7.27 7.78756 8.215C7.78756 9.1 8.34256 9.385 9.49756 9.61L11.5676 10.015C13.3226 10.345 14.3726 11.215 14.3726 12.94C14.3726 14.89 12.5876 16.18 10.2176 16.18C7.66756 16.18 5.70256 15.115 5.50756 12.76Z",fill:"currentColor"}),il("path",{d:"M4.99756 11.44H15.0026V12.19H4.99756V11.44Z",fill:"currentColor"})]});var al={type:"text-format",format:["strikethrough"],tag:"~~"};var cl=[Y([{ChildComponent:sl,isActive:({selection:t})=>Dd(t)||Md(t)?t.hasFormat("strikethrough"):!1,key:"strikethrough",onSelect:({editor:t})=>{t.dispatchCommand($d,"strikethrough")},order:4}])],Ad=$({enableFormats:["strikethrough"],markdownTransformers:[al],toolbarFixed:{groups:cl},toolbarInline:{groups:cl}});import{$isTableSelection as Od}from"@lexical/table";import{$isRangeSelection as Fd,FORMAT_TEXT_COMMAND as Pd}from"lexical";import{jsx as ul}from"react/jsx-runtime";import"react";var dl=()=>ul("svg",{"aria-hidden":"true",className:"icon",fill:"currentColor",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:ul("path",{d:"M10.167 15L7.45002 11.36L4.73302 15H2.91302L6.55302 10.177L3.23802 5.718H5.20102L7.54102 8.89L9.89402 5.718H11.714L8.43802 10.06L12.13 15H10.167ZM16.7768 13.258C16.7768 14.155 16.1398 14.532 15.2038 15C14.5538 15.325 14.2808 15.546 14.2418 15.78H16.7898V16.82H12.7208V16.339C12.7208 15.286 13.5918 14.675 14.3588 14.233C15.0868 13.83 15.4378 13.635 15.4378 13.232C15.4378 12.894 15.2038 12.686 14.8268 12.686C14.3848 12.686 14.1248 13.024 14.1118 13.427H12.7468C12.8248 12.426 13.5528 11.633 14.8398 11.633C15.9448 11.633 16.7768 12.257 16.7768 13.258Z",fill:"currentColor"})});var ml=[Y([{ChildComponent:dl,isActive:({selection:t})=>Fd(t)||Od(t)?t.hasFormat("subscript"):!1,key:"subscript",onSelect:({editor:t})=>{t.dispatchCommand(Pd,"subscript")},order:5}])],Bd=$({enableFormats:["subscript"],toolbarFixed:{groups:ml},toolbarInline:{groups:ml}});import{$isTableSelection as jd}from"@lexical/table";import{$isRangeSelection as Hd,FORMAT_TEXT_COMMAND as Ud}from"lexical";import{jsx as pl}from"react/jsx-runtime";import"react";var fl=()=>pl("svg",{"aria-hidden":"true",className:"icon",fill:"currentColor",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:pl("path",{d:"M10.167 15L7.45002 11.36L4.73302 15H2.91302L6.55302 10.177L3.23802 5.718H5.20102L7.54102 8.89L9.89402 5.718H11.714L8.43802 10.06L12.13 15H10.167ZM16.7768 7.252C16.7768 8.149 16.1398 8.526 15.2038 8.994C14.5538 9.319 14.2808 9.54 14.2418 9.774H16.7898V10.814H12.7208V10.333C12.7208 9.28 13.5918 8.669 14.3588 8.227C15.0868 7.824 15.4378 7.629 15.4378 7.226C15.4378 6.888 15.2038 6.68 14.8268 6.68C14.3848 6.68 14.1248 7.018 14.1118 7.421H12.7468C12.8248 6.42 13.5528 5.627 14.8398 5.627C15.9448 5.627 16.7768 6.251 16.7768 7.252Z",fill:"currentColor"})});var hl=[Y([{ChildComponent:fl,isActive:({selection:t})=>Hd(t)||jd(t)?t.hasFormat("superscript"):!1,key:"superscript",onSelect:({editor:t})=>{t.dispatchCommand(Ud,"superscript")},order:6}])],Wd=$({enableFormats:["superscript"],toolbarFixed:{groups:hl},toolbarInline:{groups:hl}});import{$isTableSelection as Vd}from"@lexical/table";import{$isRangeSelection as Kd,FORMAT_TEXT_COMMAND as Jd}from"lexical";import{jsx as gl,jsxs as Gd}from"react/jsx-runtime";import"react";var xl=()=>Gd("svg",{"aria-hidden":"true",className:"icon",fill:"currentColor",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[gl("path",{d:"M13.9656 11.256C13.9656 13.791 12.5096 15.156 10.0006 15.156C7.50461 15.156 6.03561 13.791 6.03561 11.23V5.718H7.76461V11.243C7.76461 12.868 8.50561 13.778 10.0006 13.778C11.4956 13.778 12.2496 12.868 12.2496 11.243V5.718H13.9656V11.256Z",fill:"currentColor"}),gl("path",{d:"M5.09961 16.3H14.9016V16.95H5.09961V16.3Z",fill:"currentColor"})]});var Cl=[Y([{ChildComponent:xl,isActive:({selection:t})=>Kd(t)||Vd(t)?t.hasFormat("underline"):!1,key:"underline",onSelect:({editor:t})=>{t.dispatchCommand(Jd,"underline")},order:3}])],zd=$({enableFormats:["underline"],toolbarFixed:{groups:Cl},toolbarInline:{groups:Cl}});import{jsx as tr}from"react/jsx-runtime";import{jsx as Xd}from"react/jsx-runtime";function Zd(t){return t.replace(/-([a-z])/g,(e,o)=>o.toUpperCase())}var ao=({css:t})=>{let e=t?Object.fromEntries(Object.entries(t).map(([o,r])=>[Zd(o),r])):{};return Xd("span",{style:{...e,alignItems:"center",borderRadius:"4px",display:"flex",fontSize:"16px",height:"20px",justifyContent:"center",width:"20px"},children:"A"})};import{useLexicalComposerContext as Yd}from"@lexical/react/LexicalComposerContext";import{$forEachSelectedTextNode as qd}from"@lexical/selection";import{$getNodeByKey as Qd,$getState as em,$setState as tm,createState as om,TextNode as rm}from"lexical";import{useEffect as nm}from"react";function bl(t){let e=new Map;for(let o in t){let r=t[o],n=om(o,{parse:l=>typeof l=="string"&&Object.keys(r).includes(l)?l:void 0});e.set(o,{stateConfig:n,stateValues:r})}return e}function er(t,e,o,r){t.update(()=>{qd(n=>{let l=e.get(o);if(!l)throw new Error(`State config for ${o} not found`);tm(n,l.stateConfig,r)})})}function kl({stateMap:t}){let[e]=Yd();return nm(()=>e.registerMutationListener(rm,o=>{e.getEditorState().read(()=>{for(let[r,n]of o){if(n==="destroyed")continue;let l=Qd(r),s=e.getElementByKey(r);if(!l||!s)continue;let i=Object.create(null);t.forEach((d,c)=>{let u=em(l,d.stateConfig);if(!u){delete s.dataset[c];return}s.dataset[c]=u;let a=d.stateValues[u]?.css;a&&Object.assign(i,a)}),s.style.cssText="",Object.assign(s.style,i)}})}),[e]),null}var _l=(t,e)=>{let o=[];for(let n in t.state){let l=t.state[n];for(let s in l){let i=l[s];o.push({ChildComponent:()=>tr(ao,{css:i.css}),key:s,label:i.label,onSelect:({editor:d})=>{er(d,e,n,s)}})}}return[{type:"dropdown",ChildComponent:()=>tr(ao,{css:{color:"var(--theme-elevation-600)"}}),items:[...[{ChildComponent:()=>tr(ao,{}),key:"clear-style",label:({i18n:n})=>n.t("lexical:textState:defaultStyle"),onSelect:({editor:n})=>{for(let l in t.state)er(n,e,l,void 0)},order:1}],...o],key:"textState",order:30}]},lm=$(({props:t})=>{let e=bl(t.state);return{plugins:[{Component:()=>kl({stateMap:e}),position:"normal"}],toolbarFixed:{groups:_l(t,e)},toolbarInline:{groups:_l(t,e)}}});import{c as cm}from"react/compiler-runtime";import{useLexicalComposerContext as um}from"@lexical/react/LexicalComposerContext";import{$createHeadingNode as dm,$isHeadingNode as Al,HeadingNode as Pl}from"@lexical/rich-text";import{$setBlocksType as mm}from"@lexical/selection";import{$getSelection as pm,$isRangeSelection as fm}from"lexical";import{useEffect as hm}from"react";import{jsx as Tl}from"react/jsx-runtime";import"react";var wl=()=>Tl("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:Tl("path",{d:"M4.639 13.5V7.074H6.196V9.648H9.076V7.074H10.642V13.5H9.076V10.836H6.196V13.5H4.639ZM11.5656 9.045V8.019C12.6636 8.019 13.1316 7.731 13.2846 7.065H14.4006V13.5H12.8436V9.045H11.5656Z",fill:"currentColor"})});import{jsx as El}from"react/jsx-runtime";import"react";var Sl=()=>El("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:El("path",{d:"M4.139 13.5V7.074H5.696V9.648H8.576V7.074H10.142V13.5H8.576V10.836H5.696V13.5H4.139ZM15.9796 8.973C15.9796 10.116 15.1696 10.656 14.0356 11.232C13.2256 11.646 12.8206 11.943 12.7846 12.294H15.9886V13.5H11.0566V12.951C11.0566 11.601 12.1636 10.845 13.1176 10.287C14.0356 9.756 14.5126 9.486 14.5126 8.946C14.5126 8.46 14.2156 8.145 13.6306 8.145C13.0186 8.145 12.6586 8.613 12.6226 9.198H11.1196C11.2186 7.947 12.1006 6.966 13.6396 6.966C15.0346 6.966 15.9796 7.785 15.9796 8.973Z",fill:"currentColor"})});import{jsx as Nl}from"react/jsx-runtime";import"react";var Ll=()=>Nl("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:Nl("path",{d:"M4.139 13.5V7.074H5.696V9.648H8.576V7.074H10.142V13.5H8.576V10.836H5.696V13.5H4.139ZM16.1146 11.745C16.1146 12.744 15.2236 13.608 13.6126 13.608C12.0736 13.608 11.0926 12.762 10.9846 11.547H12.4696C12.5146 12.114 13.0006 12.456 13.6126 12.456C14.2876 12.456 14.6746 12.132 14.6746 11.619C14.6746 11.061 14.2426 10.836 13.6216 10.836H12.9826V9.738H13.6036C14.1526 9.738 14.5486 9.486 14.5486 8.937C14.5486 8.46 14.2156 8.127 13.6486 8.127C13.0366 8.127 12.6586 8.514 12.6226 9.045H11.1916C11.2726 7.929 12.1276 6.966 13.6666 6.966C15.1876 6.966 15.9706 7.848 15.9706 8.865C15.9706 9.603 15.5026 10.143 14.8186 10.269C15.6196 10.404 16.1146 10.971 16.1146 11.745Z",fill:"currentColor"})});import{jsx as yl}from"react/jsx-runtime";import"react";var Rl=()=>yl("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:yl("path",{d:"M3.639 13.5V7.074H5.196V9.648H8.076V7.074H9.642V13.5H8.076V10.836H5.196V13.5H3.639ZM15.1736 7.074V10.854H16.3706V12.033H15.1736V13.5H13.6796V12.033H10.5116V10.845L13.4996 7.074H15.1736ZM13.6796 8.46L11.8256 10.854H13.6796V8.46Z",fill:"currentColor"})});import{jsx as Il}from"react/jsx-runtime";import"react";var vl=()=>Il("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:Il("path",{d:"M3.639 13.5V7.074H5.196V9.648H8.076V7.074H9.642V13.5H8.076V10.836H5.196V13.5H3.639ZM13.1576 10.269C12.6896 10.269 12.3746 10.494 12.2216 10.737H10.8176L11.1956 7.074H15.2546V8.28H12.3206L12.1856 9.549C12.4016 9.351 12.8516 9.126 13.4636 9.126C14.7866 9.126 15.6596 10.053 15.6596 11.358C15.6596 12.609 14.7326 13.608 13.1756 13.608C11.5826 13.608 10.6556 12.753 10.5566 11.511H12.1136C12.1586 12.06 12.5456 12.465 13.1576 12.465C13.8236 12.465 14.1746 11.97 14.1746 11.376C14.1746 10.764 13.8416 10.269 13.1576 10.269Z",fill:"currentColor"})});import{jsx as Ml}from"react/jsx-runtime";import"react";var Dl=()=>Ml("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:Ml("path",{d:"M3.639 13.5V7.074H5.196V9.648H8.076V7.074H9.642V13.5H8.076V10.836H5.196V13.5H3.639ZM13.3646 8.127C12.5456 8.127 12.0416 8.937 12.0416 9.999C12.3296 9.54 12.8246 9.207 13.5536 9.207C14.8586 9.207 15.8036 10.134 15.8036 11.376C15.8036 12.645 14.8226 13.608 13.3196 13.608C11.7266 13.608 10.6196 12.393 10.6196 10.395C10.6196 8.316 11.7716 6.966 13.4186 6.966C14.7056 6.966 15.5786 7.749 15.7316 8.829H14.3186C14.2016 8.415 13.9226 8.127 13.3646 8.127ZM13.3106 12.51C13.9586 12.51 14.3816 12.042 14.3816 11.385C14.3816 10.737 13.9586 10.278 13.3106 10.278C12.6536 10.278 12.2126 10.737 12.2126 11.385C12.2126 12.042 12.6536 12.51 13.3106 12.51Z",fill:"currentColor"})});import{$createHeadingNode as im,$isHeadingNode as sm,HeadingNode as am}from"@lexical/rich-text";var or=t=>(e,o,r)=>{let n=t(r);n&&(n.append(...o),e.replace(n),n.select(0,0))};var $l=t=>{let o=`^(${t.map(n=>Number(n.slice(1))).map(n=>`#{${n}}`).join("|")})\\s`,r=new RegExp(o);return{type:"element",dependencies:[am],export:(n,l)=>{if(!sm(n))return null;let s=Number(n.getTag().slice(1));return"#".repeat(s)+" "+l(n)},regExp:r,replace:or(n=>{let l="h"+n[1]?.length;return im(l)})}};var Ol=t=>{let e=pm();mm(e,()=>dm(t))},Fl={h1:wl,h2:Sl,h3:Ll,h4:Rl,h5:vl,h6:Dl},gm=$(({props:t})=>{let{enabledHeadingSizes:e=["h1","h2","h3","h4","h5","h6"]}=t,o=[te(e.map((r,n)=>({ChildComponent:Fl[r],isActive:({selection:l})=>{if(!fm(l))return!1;for(let s of l.getNodes()){if(Al(s)&&s.getTag()===r)continue;let i=s.getParent();if(!(Al(i)&&i.getTag()===r))return!1}return!0},key:r,label:({i18n:l})=>l.t("lexical:heading:label",{headingLevel:r.charAt(1)}),onSelect:({editor:l})=>{l.update(()=>{Ol(r)})},order:n+2})))];return{markdownTransformers:[$l(e)],nodes:[Pl],plugins:[{Component:xm,position:"normal"}],sanitizedClientFeatureProps:t,slashMenu:{groups:e?.length?[Z(e.map(r=>({Icon:Fl[r],key:`heading-${r.charAt(1)}`,keywords:["heading",r],label:({i18n:n})=>n.t("lexical:heading:label",{headingLevel:r.charAt(1)}),onSelect:({editor:n})=>{n.update(()=>{Ol(r)})}})))]:[]},toolbarFixed:{groups:e?.length?o:[]},toolbarInline:{groups:e?.length?o:[]}}}),xm=t=>{let e=cm(9),{clientProps:o}=t,{enabledHeadingSizes:r}=o,n;e[0]!==r?(n=r===void 0?["h1","h2","h3","h4","h5","h6"]:r,e[0]=r,e[1]=n):n=e[1];let l=n,s;e[2]!==l?(s=l.at(-1),e[2]=l,e[3]=s):s=e[3];let i=s,[d]=um(),c,u;return e[4]!==d||e[5]!==l||e[6]!==i?(c=()=>{if(!(!i||l.length===6))return d.registerNodeTransform(Pl,a=>{l.includes(a.getTag())||a.setTag(i)})},u=[d,l,i],e[4]=d,e[5]=l,e[6]=i,e[7]=c,e[8]=u):(c=e[7],u=e[8]),hm(c,u),null};import{$isNodeSelection as Dm}from"lexical";import{jsx as Bl}from"react/jsx-runtime";import"react";var rr=()=>Bl("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:Bl("rect",{fill:"currentColor",height:"1",width:"12",x:"4",y:"9.5"})});import{jsx as jl,jsxs as Cm}from"react/jsx-runtime";import"react";var Hl=()=>Cm("svg",{fill:"none",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[jl("path",{d:"M5 10h10",stroke:"currentColor"}),jl("path",{d:"M10 15V5",stroke:"currentColor"})]});var be=t=>({type:"dropdown",ChildComponent:Hl,items:t,key:"add",order:10});import{addClassNamesToElement as bm}from"@lexical/utils";import{$applyNodeReplacement as km,createCommand as _m,DecoratorNode as Tm}from"lexical";var Et=_m("INSERT_HORIZONTAL_RULE_COMMAND"),wt=class extends Tm{static clone(e){return new this(e.__key)}static getType(){return"horizontalrule"}static importDOM(){return{hr:()=>({conversion:wm,priority:0})}}static importJSON(e){return Ul()}createDOM(e){let o=document.createElement("hr");return bm(o,e.theme.hr),o}decorate(){return null}exportDOM(){return{element:document.createElement("hr")}}exportJSON(){return{type:"horizontalrule",version:1}}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}};function wm(){return{node:Ul()}}function Ul(){return km(new wt)}import{$applyNodeReplacement as Em}from"lexical";import"react";var ke=class extends wt{static clone(e){return super.clone(e)}static getType(){return super.getType()}static importJSON(e){return Ye()}decorate(){return null}exportJSON(){return super.exportJSON()}};function Ye(){return Em(new ke)}function St(t){return t instanceof ke}var Wl={type:"element",dependencies:[ke],export:(t,e)=>St(t)?"---":null,regExp:/^---\s*$/,replace:t=>{let e=Ye();e&&t.replace(e)}};import{c as Sm}from"react/compiler-runtime";import{useLexicalComposerContext as Nm}from"@lexical/react/LexicalComposerContext.js";import{$insertNodeToNearestRoot as Lm}from"@lexical/utils";import{$getSelection as ym,$isRangeSelection as Rm,COMMAND_PRIORITY_EDITOR as Im}from"lexical";import{useEffect as vm}from"react";var Gl=()=>{let t=Sm(3),[e]=Nm(),o,r;return t[0]!==e?(o=()=>e.registerCommand(Et,Mm,Im),r=[e],t[0]=e,t[1]=o,t[2]=r):(o=t[1],r=t[2]),vm(o,r),null};function Mm(t){let e=ym();if(!Rm(e))return!1;if(e.focus.getNode()!==null){let r=Ye();Lm(r)}return!0}var $m=$({markdownTransformers:[Wl],nodes:[ke],plugins:[{Component:Gl,position:"normal"}],slashMenu:{groups:[Z([{Icon:rr,key:"horizontalRule",keywords:["hr","horizontal rule","line","separator"],label:({i18n:t})=>t.t("lexical:horizontalRule:label"),onSelect:({editor:t})=>{t.dispatchCommand(Et,void 0)}}])]},toolbarFixed:{groups:[be([{ChildComponent:rr,isActive:({selection:t})=>{if(!Dm(t)||!t.getNodes().length)return!1;let e=t.getNodes()[0];return St(e)},key:"horizontalRule",label:({i18n:t})=>t.t("lexical:horizontalRule:label"),onSelect:({editor:t})=>{t.dispatchCommand(Et,void 0)}}])]}});import{$findMatchingParent as ei}from"@lexical/utils";import{$isElementNode as Jm,INDENT_CONTENT_COMMAND as zm,OUTDENT_CONTENT_COMMAND as Xm}from"lexical";import{jsx as co,jsxs as Am}from"react/jsx-runtime";import"react";var Vl=()=>Am("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[co("path",{d:"M2.5 5H10.5",stroke:"currentColor",strokeWidth:"1.5"}),co("path",{d:"M2.5 10H10.5",stroke:"currentColor",strokeWidth:"1.5"}),co("path",{d:"M2.5 15H17.5",stroke:"currentColor",strokeWidth:"1.5"}),co("path",{d:"M12.25 7.25L17.25 3.75V10.75L12.25 7.25Z",fill:"currentColor"})]});import{jsx as uo,jsxs as Om}from"react/jsx-runtime";import"react";var Kl=()=>Om("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[uo("path",{d:"M17.5 5H9.5",stroke:"currentColor",strokeWidth:"1.5"}),uo("path",{d:"M17.5 10H9.5",stroke:"currentColor",strokeWidth:"1.5"}),uo("path",{d:"M17.5 15H2.5",stroke:"currentColor",strokeWidth:"1.5"}),uo("path",{d:"M7.75 7.25L2.75 3.75V10.75L7.75 7.25Z",fill:"currentColor"})]});import{jsx as Fm}from"react/jsx-runtime";import{useLexicalComposerContext as Pm}from"@lexical/react/LexicalComposerContext";import{TabIndentationPlugin as Bm}from"@lexical/react/LexicalTabIndentationPlugin";import{$findMatchingParent as jm,mergeRegister as Jl}from"@lexical/utils";import{$getSelection as Hm,$isElementNode as Yl,$isRangeSelection as Um,COMMAND_PRIORITY_LOW as zl,INDENT_CONTENT_COMMAND as Xl,KEY_TAB_COMMAND as Wm,OUTDENT_CONTENT_COMMAND as Gm,TabNode as Vm}from"lexical";import{useEffect as Zl}from"react";var ql=({clientProps:t})=>{let[e]=Pm(),{disabledNodes:o,disableTabNode:r}=t;return Zl(()=>{if(!(!e||!o?.length))return Jl(e.registerCommand(Xl,()=>Km(n=>{if(!o.includes(n.getType())){let l=n.getIndent();n.setIndent(l+1)}}),zl),e.registerUpdateListener(({dirtyElements:n,editorState:l})=>{e.update(()=>{for(let[s]of n){let i=l._nodeMap.get(s);Yl(i)&&o.includes(i.getType())&&i.getIndent()>0&&i.setIndent(0)}})}))},[e,o]),Zl(()=>{if(!(!e||!r))return Jl(e.registerCommand(Wm,n=>(n.preventDefault(),e.dispatchCommand(n.shiftKey?Gm:Xl,void 0)),zl),e.registerNodeTransform(Vm,n=>{n.remove()}))},[e,r]),Fm(Bm,{})};function Km(t){let e=Hm();if(!Um(e))return!1;let o=new Set,r=e.getNodes();for(let n=0;n<r.length;n++){let l=r[n],s=l.getKey();if(o.has(s))continue;let i=jm(l,c=>Yl(c)&&!c.isInline());if(i===null)continue;let d=i.getKey();i.canIndent()&&!o.has(d)&&(o.add(d),t(i))}return o.size>0}var Ql=t=>({type:"buttons",items:t,key:"indent",order:35});var ti=({disabledNodes:t})=>[Ql([{ChildComponent:Vl,isActive:()=>!1,isEnabled:({selection:e})=>{let o=e?.getNodes()??[],r=n=>oi(n)&&n.getIndent()>0;return o.some(n=>r(n)||!!ei(n,r))},key:"indentDecrease",label:({i18n:e})=>e.t("lexical:indent:decreaseLabel"),onSelect:({editor:e})=>{e.dispatchCommand(Xm,void 0)},order:1},{ChildComponent:Kl,isActive:()=>!1,isEnabled:({selection:e})=>{let o=e?.getNodes()??[],r=n=>oi(n)&&!(t??[]).includes(n.getType());return o.some(n=>r(n)||!!ei(n,r))},key:"indentIncrease",label:({i18n:e})=>e.t("lexical:indent:increaseLabel"),onSelect:({editor:e})=>{e.dispatchCommand(zm,void 0)},order:2}])],Zm=$(({props:t})=>{let e=t.disabledNodes??[];return{plugins:[{Component:ql,position:"normal"}],sanitizedClientFeatureProps:t,toolbarFixed:{groups:ti({disabledNodes:e})},toolbarInline:{groups:ti({disabledNodes:e})}}}),oi=t=>Jm(t)&&t.canIndent();import{$findMatchingParent as df}from"@lexical/utils";import{$getSelection as mr,$isRangeSelection as Di}from"lexical";import{jsx as ri}from"react/jsx-runtime";import"react";var ni=()=>ri("svg",{"aria-hidden":"true",className:"icon",fill:"none",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:ri("path",{d:"M8.5 11.5L11.5 8.5M8.5 7L9.625 5.875C10.868 4.633 12.882 4.633 14.125 5.875C15.368 7.118 15.368 9.133 14.125 10.375L13 11.5M7 8.5L5.746 9.754C4.56 10.94 4.519 12.85 5.652 14.087C6.814 15.354 8.78 15.449 10.058 14.298L11.5 13",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})});import{$isAtNodeEnd as li}from"@lexical/selection";function qe(t){let{anchor:e}=t,{focus:o}=t,r=t.anchor.getNode(),n=t.focus.getNode();return r===n?r:t.isBackward()?li(o)?r:n:li(e)?r:n}var nr=t=>({type:"buttons",items:t,key:"features",order:50});import{$createTextNode as sp}from"lexical";import{addClassNamesToElement as Ym,isHTMLAnchorElement as qm}from"@lexical/utils";import sr from"bson-objectid";import{$applyNodeReplacement as Qm,$createTextNode as ii,$getSelection as ep,$isElementNode as si,$isRangeSelection as ir,createCommand as tp,ElementNode as op}from"lexical";var rp=new Set(["http:","https:","mailto:","sms:","tel:"]),oe=class extends op{__fields;__id;constructor({id:e,fields:o={linkType:"custom",newTab:!1},key:r}){super(r),this.__fields=o,this.__id=e}static clone(e){return new this({id:e.__id,fields:e.__fields,key:e.__key})}static getType(){return"link"}static importDOM(){return{a:e=>({conversion:np,priority:1})}}static importJSON(e){let o=_e({}).updateFromJSON(e);return e.version===1&&typeof e.fields?.doc?.value=="object"&&e.fields?.doc?.value?.id&&(e.fields.doc.value=e.fields.doc.value.id,e.version=2),e.version===2&&!e.id&&(e.id=new sr.default().toHexString(),e.version=3),o}canBeEmpty(){return!1}canInsertTextAfter(){return!1}canInsertTextBefore(){return!1}createDOM(e){let o=document.createElement("a");return this.__fields?.linkType==="custom"&&(o.href=this.sanitizeUrl(this.__fields.url??"")),(this.__fields?.newTab??!1)&&(o.target="_blank"),this.__fields?.newTab===!0&&this.__fields?.linkType==="custom"&&(o.rel=lr(o.rel,"add","noopener")),Ym(o,e.theme.link),o}exportJSON(){let e=this.getFields();e?.linkType==="internal"?delete e.url:e?.linkType==="custom"&&delete e.doc;let o={...super.exportJSON(),type:"link",fields:e,version:3},r=this.getID();return r&&(o.id=r),o}extractWithChild(e,o,r){if(!ir(o))return!1;let n=o.anchor.getNode(),l=o.focus.getNode();return this.isParentOf(n)&&this.isParentOf(l)&&o.getTextContent().length>0}getFields(){return this.getLatest().__fields}getID(){return this.getLatest().__id}insertNewAfter(e,o=!0){let r=this.getParentOrThrow().insertNewAfter(e,o);if(si(r)){let n=_e({fields:this.__fields});return r.append(n),n}return null}isInline(){return!0}sanitizeUrl(e){try{let o=new URL(e);if(!rp.has(o.protocol))return"about:blank"}catch{return"https://"}return e}setFields(e){let o=this.getWritable();return o.__fields=e,o}setID(e){let o=this.getWritable();return o.__id=e,o}updateDOM(e,o,r){let n=this.__fields?.url,l=this.__fields?.newTab;return n!=null&&n!==e.__fields?.url&&this.__fields?.linkType==="custom"&&(o.href=n),this.__fields?.linkType==="internal"&&e.__fields?.linkType==="custom"&&o.removeAttribute("href"),o.rel==null&&(o.rel=""),l!==e.__fields?.newTab&&(l??!1?(o.target="_blank",this.__fields?.linkType==="custom"&&(o.rel=lr(o.rel,"add","noopener"))):(o.removeAttribute("target"),o.rel=lr(o.rel,"remove","noopener"))),!1}updateFromJSON(e){return super.updateFromJSON(e).setFields(e.fields).setID(e.id)}};function np(t){let e=null;if(qm(t)){let o=t.textContent;o!==null&&o!==""&&(e=_e({id:new sr.default().toHexString(),fields:{doc:null,linkType:"custom",newTab:t.getAttribute("target")==="_blank",url:t.getAttribute("href")??""}}))}return{node:e}}function _e({id:t,fields:e}){return Qm(new oe({id:t??new sr.default().toHexString(),fields:e}))}function J(t){return t instanceof oe}var ue=tp("TOGGLE_LINK_COMMAND");function ar(t){let e=ep();if(!ir(e)&&(t===null||!t.selectedNodes?.length))return;let o=ir(e)?e.extract():t===null?[]:t.selectedNodes;if(t===null){o?.forEach(l=>{let s=l.getParent();J(s)&&(s.getChildren().forEach(d=>{s.insertBefore(d)}),s.remove())});return}if(o?.length===1){let l=o[0],s=J(l)?l:lp(l);if(s!==null){s.setFields(t.fields),t.text!=null&&t.text!==s.getTextContent()&&(s.append(ii(t.text)),s.getChildren().forEach(i=>{i!==s.getLastChild()&&i.remove()}));return}}let r=null,n=null;o?.forEach(l=>{let s=l.getParent();if(!(s===n||s===null||si(l)&&!l.isInline())){if(J(s)){n=s,s.setFields(t.fields),t.text!=null&&t.text!==s.getTextContent()&&(s.append(ii(t.text)),s.getChildren().forEach(i=>{i!==s.getLastChild()&&i.remove()}));return}if(s.is(r)||(r=s,n=_e({fields:t.fields}),J(s)?l.getPreviousSibling()===null?s.insertBefore(n):s.insertAfter(n):l.insertBefore(n)),J(l)){if(l.is(n))return;if(n!==null){let i=l.getChildren();n.append(...i)}l.remove();return}n!==null&&n.append(l)}})}function lp(t){return ip(t,e=>J(e))}function ip(t,e){let o=t;for(;o!==null&&(o=o.getParent(),!(o===null||e(o))););return o}function lr(t,e,o){let r,n=`${t}`;if(e==="add"){if(n.includes(o)){let l=new RegExp(o,"g");n=n.replace(l,"").trim()}n=n.trim(),r=n.length===0?`${o}`:`${n} ${o}`}else{let l=new RegExp(o,"g");r=n.replace(l,"").trim()}return r}var ai={type:"text-match",dependencies:[oe],export:(t,e)=>{if(!J(t))return null;let o=t,{url:r}=o.getFields();return`[${e(o)}](${r})`},importRegExp:/\[([^[]+)\]\(([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?\)/,regExp:/\[([^[]+)\]\(([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?\)$/,replace:(t,e)=>{let[,o,r]=e,n=_e({fields:{doc:null,linkType:"custom",newTab:!1,url:r}}),l=sp(o);return l.setFormat(t.getFormat()),n.append(l),t.replace(n),l},trigger:")"};import{$applyNodeReplacement as ap,$isElementNode as cp}from"lexical";var Te=class extends oe{static clone(e){return new this({id:"",fields:e.__fields,key:e.__key})}static getType(){return"autolink"}static importDOM(){return null}static importJSON(e){let o=Nt({}).updateFromJSON(e);return e.version===1&&typeof e.fields?.doc?.value=="object"&&e.fields?.doc?.value?.id&&(e.fields.doc.value=e.fields.doc.value.id,e.version=2),o}exportJSON(){let e=super.exportJSON();return{type:"autolink",children:e.children,direction:e.direction,fields:e.fields,format:e.format,indent:e.indent,version:2}}insertNewAfter(e,o=!0){let r=this.getParentOrThrow().insertNewAfter(e,o);if(cp(r)){let n=Nt({fields:this.__fields});return r.append(n),n}return null}updateFromJSON(e){return super.updateFromJSON(e).setFields(e.fields)}};function Nt({fields:t}){return ap(new Te({id:"",fields:t}))}function we(t){return t instanceof Te}import{c as up}from"react/compiler-runtime";import{useLexicalComposerContext as dp}from"@lexical/react/LexicalComposerContext.js";import{mergeRegister as mp}from"@lexical/utils";import{$createTextNode as ci,$getSelection as pp,$isElementNode as di,$isLineBreakNode as mi,$isNodeSelection as fp,$isRangeSelection as hp,$isTextNode as Lt,TextNode as gp}from"lexical";import{useEffect as xp}from"react";function ui(t,e=o=>o){return o=>{let r=t.exec(o);return r===null?null:{index:r.index,length:r[0].length,text:r[0],url:e(r[0])}}}function pi(t,e){for(let o of e){let r=o(t);if(r!=null)return r}return null}var Cp=/[.,;\s]/;function po(t){return t!==void 0&&Cp.test(t)}function fi(t){return po(t[t.length-1])}function ur(t){return po(t[0])}function bp(t,e){return e?/^\.[a-z]{2,}/i.test(t):/^\.[a-z0-9]+/i.test(t)}function hi(t){let e=t.getPreviousSibling();return di(e)&&(e=e.getLastDescendant()),e===null||mi(e)||Lt(e)&&fi(e.getTextContent())}function gi(t){let e=t.getNextSibling();return di(e)&&(e=e.getFirstDescendant()),e===null||mi(e)||Lt(e)&&ur(e.getTextContent())}function kp(t,e,o,r){return(t>0?po(o[t-1]):hi(r[0]))?e<o.length?po(o[e]):gi(r[r.length-1]):!1}function _p(t,e,o){let r=[],n=[],l=[],s=0,i=0,d=[...t];for(;d.length>0;){let c=d[0],a=c.getTextContent().length,m=i;i+a<=e?(r.push(c),s+=a):m>=o?l.push(c):n.push(c),i+=a,d.shift()}return[s,r,n,l]}function Tp(t,e,o,r){let n={linkType:"custom",url:r.url,...r.fields},l=Nt({fields:n});if(t.length===1){let s=t[0],i;if(e===0?[i]=s.splitText(o):[,i]=s.splitText(e,o),i){let d=ci(r.text);d.setFormat(i.getFormat()),d.setDetail(i.getDetail()),d.setStyle(i.getStyle()),l.append(d),i.replace(l)}return s}else if(t.length>1){let s=t[0],i=s.getTextContent().length,d;e===0?d=s:[,d]=s.splitText(e);let c=[],u;if(t.forEach(a=>{let p=a.getTextContent().length,f=i,h=i+p;if(f<o)if(h<=o)c.push(a);else{let[x,w]=a.splitText(o-f);x&&c.push(x),u=w}i+=p}),d){let a=pp(),m=a?a.getNodes().find(Lt):void 0,p=ci(d.getTextContent());return p.setFormat(d.getFormat()),p.setDetail(d.getDetail()),p.setStyle(d.getStyle()),l.append(p,...c),m&&m===d&&(hp(a)?p.select(a.anchor.offset,a.focus.offset):fp(a)&&p.select(0,p.getTextContent().length)),d.replace(l),u}}}function wp(t,e,o){let r=[...t],n=r.map(d=>d.getTextContent()).join(""),l=n,s,i=0;for(;(s=pi(l,e))!=null&&s!==null;){let d=s.index,c=s.length,u=d+c;if(kp(i+d,i+u,n,r)){let[m,,p,f]=_p(r,i+d,i+u),h=i+d-m,x=i+u-m,w=Tp(p,h,x,s);r=w?[w,...f]:f,o(s.url,null),i=0}else i+=u;l=l.substring(u)}}function cr(t,e,o){let r=t.getChildren(),n=r.length;for(let d=0;d<n;d++){let c=r[d];if(!Lt(c)||!c.isSimpleText()){mo(t),o(null,t.getFields()?.url??null);return}}let l=t.getTextContent(),s=pi(l,e);if(s===null||s.text!==l){mo(t),o(null,t.getFields()?.url??null);return}if(!hi(t)||!gi(t)){mo(t),o(null,t.getFields()?.url??null);return}let i=t.getFields()?.url;if(i!==s?.url){let d=t.getFields();d.url=s?.url,t.setFields(d),o(s.url,i??null)}}function Ep(t,e,o){let r=t.getPreviousSibling(),n=t.getNextSibling(),l=t.getTextContent();if(we(r)){let s=r.getFields()?.url?r.getFields()?.url?.startsWith("mailto:")??!1:!1;(!ur(l)||bp(l,s))&&(r.append(t),cr(r,e,o),o(null,r.getFields()?.url??null))}we(n)&&!fi(l)&&(mo(n),cr(n,e,o),o(null,n.getFields()?.url??null))}function mo(t){let e=t.getChildren(),o=e.length;for(let r=o-1;r>=0;r--)t.insertAfter(e[r]);return t.remove(),e.map(r=>r.getLatest())}function Sp(t){let e=[t],o=t.getNextSibling();for(;o!==null&&Lt(o)&&o.isSimpleText()&&(e.push(o),!/\s/.test(o.getTextContent()));)o=o.getNextSibling();return e}function Np(t,e,o){let r=up(5),n,l;r[0]!==t||r[1]!==e||r[2]!==o?(n=()=>{if(!t.hasNodes([Te]))throw new Error("LexicalAutoLinkPlugin: AutoLinkNode not registered on editor");let s=(i,d)=>{o?.(i,d)};return mp(t.registerNodeTransform(gp,i=>{let d=i.getParentOrThrow(),c=i.getPreviousSibling();if(we(d))cr(d,e,s);else if(!J(d)){if(i.isSimpleText()&&(ur(i.getTextContent())||!we(c))){let u=Sp(i);wp(u,e,s)}Ep(i,e,s)}}))},l=[t,e,o],r[0]=t,r[1]=e,r[2]=o,r[3]=n,r[4]=l):(n=r[3],l=r[4]),xp(n,l)}var Lp=/((https?:\/\/(www\.)?)|(www\.))[-\w@:%.+~#=]{1,256}\.[a-zA-Z\d()]{1,6}\b([-\w()@:%+.~#?&/=]*)(?<![-.+():%])/,yp=/(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-z\-\d]+\.)+[a-z]{2,}))/i,Rp=[ui(Lp,t=>t.startsWith("http")?t:`https://${t}`),ui(yp,t=>`mailto:${t}`)],xi=()=>{let[t]=dp();return Np(t,Rp),null};import{jsx as Ip}from"react/jsx-runtime";import{ClickableLinkPlugin as vp}from"@lexical/react/LexicalClickableLinkPlugin.js";import"react";var Ci=()=>Ip(vp,{});import{jsx as Yp}from"react/jsx-runtime";import"react";import{createPortal as qp}from"react-dom";import{jsx as Ee,jsxs as yt,Fragment as Dp}from"react/jsx-runtime";import{useLexicalComposerContext as $p}from"@lexical/react/LexicalComposerContext.js";import{useLexicalEditable as Ap}from"@lexical/react/useLexicalEditable";import{$findMatchingParent as bi,mergeRegister as ki}from"@lexical/utils";import{getTranslation as dr}from"@payloadcms/translations";import{CloseMenuIcon as Op,EditIcon as Fp,ExternalLinkIcon as _i,formatDrawerSlug as Pp,useConfig as Bp,useEditDepth as jp,useLocale as Hp,useTranslation as Up}from"@payloadcms/ui";import{requests as Wp}from"@payloadcms/ui/shared";import{$getSelection as Ti,$isLineBreakNode as Gp,$isRangeSelection as wi,COMMAND_PRIORITY_HIGH as Vp,COMMAND_PRIORITY_LOW as Ei,getDOMSelection as Kp,KEY_ESCAPE_COMMAND as Jp,SELECTION_CHANGE_COMMAND as zp}from"lexical";import{formatAdminURL as Xp}from"payload/shared";import Si,{useCallback as Ni,useEffect as go,useRef as Zp,useState as Pe}from"react";function fo(t,e,o,r=10,n=5){let l=o.parentElement;if(t===null||l==null){e.style.opacity="0",e.style.transform="translate(-10000px, -10000px)";return}let s=e.getBoundingClientRect(),i=o.getBoundingClientRect(),d=l.getBoundingClientRect(),c=t.top-r,u=t.left-n;c<d.top&&(c+=s.height+t.height+r*2),u+s.width>d.right&&(u=d.right-s.width-n),c-=i.top,u-=i.left,e.style.opacity="1",e.style.transform=`translate(${u}px, ${c}px)`}import{createCommand as Mp}from"lexical";var ho=Mp("TOGGLE_LINK_WITH_MODAL_COMMAND");function Li(t){t.preventDefault()}function yi({anchorElem:t}){let[e]=$p(),[o,r]=Pe(),n=Zp(null),[l,s]=Pe(null),[i,d]=Pe(null),{fieldProps:{schemaPath:c},uuid:u}=H(),a=Ap(),{config:m,getEntityConfig:p}=Bp(),{i18n:f,t:h}=Up(),[x,w]=Pe(),E=jp(),[N,_]=Pe(!1),[C,g]=Pe([]),b=Hp(),[k,y]=Pe(!1),R=Pp({slug:"lexical-rich-text-link-"+u,depth:E}),{toggleDrawer:M}=he(R),L=Ni(()=>{_(!1),n&&n.current&&(n.current.style.opacity="0",n.current.style.transform="translate(-10000px, -10000px)"),y(!1),s(null),d(null),g([]),w(void 0)},[_,s,d,g]),T=Ni(()=>{let S=Ti(),I;if(!wi(S)||!S){L();return}let A=qe(S);I=e.getElementByKey(A.getKey())?.getBoundingClientRect();let v=bi(A,J),O=S.getNodes().filter(X=>!Gp(X)).find(X=>{let W=bi(X,J);return v&&!v.is(W)||W&&!W.is(v)});if(v==null||O){L();return}r(v);let D=v.getFields(),G={...D,id:v.getID(),text:v.getTextContent()};if(D?.linkType==="custom")s(D?.url??null),d(null);else{s(`${m.routes.admin==="/"?"":m.routes.admin}/collections/${D?.doc?.relationTo}/${D?.doc?.value}`);let X=D?.doc?.relationTo?p({collectionSlug:D?.doc?.relationTo}):void 0;if(!X)d(D?.label?String(D?.label):null),s(D?.url?String(D?.url):null);else{let W=typeof D.doc?.value=="object"?D.doc.value.id:D.doc?.value,Ge=D.doc?.relationTo;if(!W||!Ge)throw new Error("Focus link parent is missing doc.value or doc.relationTo");let ye=h("fields:linkedTo",{label:`${dr(X.labels.singular,f)} - ${h("lexical:link:loadingWithEllipsis",f)}`}).replace(/<[^>]*>?/g,"");d(ye),Wp.get(Xp({apiRoute:m.routes.api,path:`/${Ge}/${W}`,serverURL:m.serverURL}),{headers:{"Accept-Language":f.language},params:{depth:0,locale:b?.code}}).then(async fe=>{if(!fe.ok)throw new Error(`HTTP error! Status: ${fe.status}`);let Gt=await fe.json(),Re=X?.admin?.useAsTitle||"id",Vt=Gt[Re],Ve=h("fields:linkedTo",{label:`${dr(X.labels.singular,f)} - ${Vt}`}).replace(/<[^>]*>?/g,"");d(Ve)}).catch(()=>{let fe=h("fields:linkedTo",{label:`${dr(X.labels.singular,f)} - ${h("general:untitled",f)} - ID: ${W}`}).replace(/<[^>]*>?/g,"");d(fe)})}}w(G),_(!0),g(S?S?.getNodes():[]),we(v)?y(!0):y(!1);let q=n.current,z=Kp(e._window),{activeElement:Ut}=document;if(q===null)return;let Wt=e.getRootElement();return z!==null&&Wt!==null&&Wt.contains(z.anchorNode)?(I||(I=z.getRangeAt(0).getBoundingClientRect()),I!=null&&(I.y+=40,fo(I,q,t))):(Ut==null||Ut.className!=="link-input")&&(Wt!==null&&fo(null,q,t),s(null),d(null)),!0},[e,L,m.routes.admin,m.routes.api,m.serverURL,p,h,f,b?.code,t]);return go(()=>ki(e.registerCommand(ho,S=>(e.dispatchCommand(ue,S),T(),M(),!0),Ei)),[e,T,M,R]),go(()=>{let S=t.parentElement,I=()=>{e.getEditorState().read(()=>{T()})};return window.addEventListener("resize",I),S?.addEventListener("scroll",I),()=>{window.removeEventListener("resize",I),S?.removeEventListener("scroll",I)}},[t.parentElement,e,T]),go(()=>ki(e.registerUpdateListener(({editorState:S})=>{S.read(()=>{T()})}),e.registerCommand(zp,()=>(T(),!0),Ei),e.registerCommand(Jp,()=>N?(L(),!0):!1,Vp)),[e,T,N,L]),go(()=>{e.getEditorState().read(()=>{T()})},[e,T]),yt(Si.Fragment,{children:[Ee("div",{className:"link-editor",ref:n,children:yt("div",{className:"link-input",children:[l&&l.length>0?yt("a",{href:l,rel:"noopener noreferrer",target:"_blank",children:[o?.__fields.newTab?Ee(_i,{}):null,i!=null&&i.length>0?i:l]}):i!=null&&i.length>0?yt(Dp,{children:[o?.__fields.newTab?Ee(_i,{}):null,Ee("span",{className:"link-input__label-pure",children:i})]}):null,a&&yt(Si.Fragment,{children:[Ee("button",{"aria-label":"Edit link",className:"link-edit",onClick:S=>{S.preventDefault(),M()},onMouseDown:Li,tabIndex:0,type:"button",children:Ee(Fp,{})}),!k&&Ee("button",{"aria-label":"Remove link",className:"link-trash",onClick:()=>{e.dispatchCommand(ue,null)},onMouseDown:Li,tabIndex:0,type:"button",children:Ee(Op,{})})]})]})}),Ee(ft,{className:"lexical-link-edit-drawer",data:x,drawerSlug:R,drawerTitle:h("fields:editLink"),featureKey:"link",handleDrawerSubmit:(S,I)=>{let A=I,v={...A};delete v.text,e.update(()=>{let O=Ti(),D=null;if(wi(O)?D=qe(O).getParent():C.length&&(D=C[0]?.getParent()??null),D&&we(D)){let G=_e({fields:v});D.replace(G,!0)}}),e.dispatchCommand(ue,{fields:v,selectedNodes:C,text:A.text})},schemaPath:c,schemaPathSuffix:"fields"})]})}var Ri=t=>{let{anchorElem:e=document.body}=t;return qp(Yp(yi,{anchorElem:e}),e)};import{c as tf}from"react/compiler-runtime";import{useLexicalComposerContext as of}from"@lexical/react/LexicalComposerContext.js";import{mergeRegister as rf}from"@lexical/utils";import{$getSelection as nf,$isElementNode as lf,$isRangeSelection as sf,COMMAND_PRIORITY_LOW as vi,PASTE_COMMAND as af}from"lexical";import{useEffect as cf}from"react";var Qp=/^(?:[a-zA-Z][a-zA-Z\d+.-]*:(?:\/\/)?(?:[-;:&=+$,\w]+@)?[A-Za-z\d]+(?:\.[A-Za-z\d]+)+|www\.[A-Za-z\d]+(?:\.[A-Za-z\d]+)+|(?:tel|mailto):[\w+.-]+)(?:\/[+~%/\w-]*)?(?:\?[-;&=%\w]*)?(?:#\w+)?$/,ef=/^(?:\/[\w\-./]*(?:\?[-;&=%\w]*)?(?:#[\w-]+)?|#[\w\-]+)$/;function Ii(t){if(!t||t.includes(" ")||/^[a-z][a-z\d+.-]*:\/[^/]/i.test(t))return!1;if(t==="https://"||Qp.test(t)||ef.test(t))return!0;try{let e=new URL(t);return!(["ftp:","http:","https:"].includes(e.protocol)&&!e.hostname.includes("."))}catch{}return!1}var Mi=t=>{let e=tf(5),{clientProps:o}=t,[r]=of(),n,l;return e[0]!==o.defaultLinkType||e[1]!==o.defaultLinkURL||e[2]!==r?(n=()=>{if(!r.hasNodes([oe]))throw new Error("LinkPlugin: LinkNode not registered on editor");return rf(r.registerCommand(ue,s=>s===null?(ar(null),!0):(s.fields?.linkType||(s.fields.linkType=o.defaultLinkType),s.fields?.url||(s.fields.url=o.defaultLinkURL),ar(s),!0),vi),r.registerCommand(af,s=>{let i=nf();if(!sf(i)||i.isCollapsed()||!(s instanceof ClipboardEvent)||s.clipboardData==null)return!1;let d=s.clipboardData.getData("text");if(!Ii(d))return!1;if(!i.getNodes().some(uf)){let c={doc:null,linkType:"custom",newTab:!1,url:d};return r.dispatchCommand(ue,{fields:c,text:null}),s.preventDefault(),!0}return!1},vi))},l=[o.defaultLinkType,o.defaultLinkURL,r],e[0]=o.defaultLinkType,e[1]=o.defaultLinkURL,e[2]=r,e[3]=n,e[4]=l):(n=e[3],l=e[4]),cf(n,l),null};function uf(t){return lf(t)}var $i=[nr([{ChildComponent:ni,isActive:({selection:t})=>{if(Di(t)){let e=qe(t);return df(e,J)!=null}return!1},isEnabled:({selection:t})=>!!(Di(t)&&mr()?.getTextContent()?.length),key:"link",label:({i18n:t})=>t.t("lexical:link:label"),onSelect:({editor:t,isActive:e})=>{if(e)t.dispatchCommand(ue,null);else{let o,r=[];if(t.getEditorState().read(()=>{o=mr()?.getTextContent(),r=mr()?.getNodes()??[]}),!o?.length)return;let n={doc:null};t.dispatchCommand(ho,{fields:n,selectedNodes:r,text:o})}},order:1}])],mf=$(({props:t})=>({markdownTransformers:[ai],nodes:[oe,t?.disableAutoLinks===!0?null:Te].filter(Boolean),plugins:[{Component:Mi,position:"normal"},t?.disableAutoLinks===!0||t?.disableAutoLinks==="creationOnly"?null:{Component:xi,position:"normal"},{Component:Ci,position:"normal"},{Component:Ri,position:"floatingAnchorElem"}].filter(Boolean),sanitizedClientFeatureProps:t,toolbarFixed:{groups:$i},toolbarInline:{groups:$i}}));import{$isListNode as hr,INSERT_CHECK_LIST_COMMAND as ji,ListItemNode as Ef,ListNode as Sf}from"@lexical/list";import{$isRangeSelection as Nf}from"lexical";import{jsx as Ai,jsxs as pf}from"react/jsx-runtime";import"react";var pr=()=>pf("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Ai("rect",{height:"13",rx:"1.5",stroke:"currentColor",width:"13",x:"3.5",y:"3.5"}),Ai("path",{d:"M7 10L9 12.5L13 7.5",stroke:"currentColor",strokeWidth:"1.5"})]});import{jsx as ff}from"react/jsx-runtime";import{ListPlugin as hf}from"@lexical/react/LexicalListPlugin.js";import"react";var Qe=()=>ff(hf,{});function xo(t,e){return t==="ordered"?!e.has("unorderedList"):t==="checklist"?!e.has("unorderedList")&&!e.has("orderedList"):!1}function et(t){return{items:t,key:"lists",label:({i18n:e})=>e.t("lexical:general:slashMenuListGroupLabel")}}import{$isListNode as bf,ListItemNode as kf,ListNode as _f}from"@lexical/list";import{$createListItemNode as gf,$createListNode as xf,$isListItemNode as Cf,$isListNode as fr}from"@lexical/list";var Oi=4,tt=t=>(e,o,r)=>{let n=e.getPreviousSibling(),l=e.getNextSibling(),s=gf(t==="check"?r[3]==="x":void 0);if(fr(l)&&l.getListType()===t){let d=l.getFirstChild();d!==null?d.insertBefore(s):l.append(s),e.remove()}else if(fr(n)&&n.getListType()===t)n.append(s),e.remove();else{let d=xf(t,t==="number"?Number(r[2]):void 0);d.append(s),e.replace(d)}s.append(...o),s.select(0,0);let i=Math.floor(r[1].length/Oi);i&&s.setIndent(i)},Be=(t,e,o)=>{let r=[],n=t.getChildren(),l=0;for(let s of n)if(Cf(s)){if(s.getChildrenSize()===1){let u=s.getFirstChild();if(fr(u)){r.push(Be(u,e,o+1));continue}}let i=" ".repeat(o*Oi),d=t.getListType(),c=d==="number"?`${t.getStart()+l}. `:d==="check"?`- [${s.getChecked()?"x":" "}] `:"- ";r.push(i+c+e(s)),l++}return r.join(`
`)};var Fi={type:"element",dependencies:[_f,kf],export:(t,e)=>bf(t)?Be(t,e,0):null,regExp:/^(\s*)(?:-\s)?\s?(\[(\s|x)?\])\s/i,replace:tt("check")};import{jsx as Tf}from"react/jsx-runtime";import{CheckListPlugin as wf}from"@lexical/react/LexicalCheckListPlugin.js";import"react";var Pi=()=>Tf(wf,{});var Bi=[te([{ChildComponent:pr,isActive:({selection:t})=>{if(!Nf(t))return!1;for(let e of t.getNodes()){if(hr(e)&&e.getListType()==="check")continue;let o=e.getParent();if(hr(o)&&o.getListType()==="check")continue;let r=o?.getParent();if(!(hr(r)&&r.getListType()==="check"))return!1}return!0},key:"checklist",label:({i18n:t})=>t.t("lexical:checklist:label"),onSelect:({editor:t})=>{t.dispatchCommand(ji,void 0)},order:12}])],Lf=$(({featureProviderMap:t})=>{let e=[{Component:Pi,position:"normal"}],o=xo("checklist",t);return o&&e.push({Component:Qe,position:"normal"}),{markdownTransformers:[Fi],nodes:o?[Sf,Ef]:[],plugins:e,slashMenu:{groups:[et([{Icon:pr,key:"checklist",keywords:["check list","check","checklist","cl"],label:({i18n:r})=>r.t("lexical:checklist:label"),onSelect:({editor:r})=>{r.dispatchCommand(ji,void 0)}}])]},toolbarFixed:{groups:Bi},toolbarInline:{groups:Bi}}});import{$isListNode as xr,INSERT_ORDERED_LIST_COMMAND as Wi,ListItemNode as Mf,ListNode as Df}from"@lexical/list";import{$isRangeSelection as $f}from"lexical";import{jsx as Rt,jsxs as yf}from"react/jsx-runtime";import"react";var gr=()=>yf("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Rt("path",{d:"M5.89284 12.479C5.89284 13.368 5.26284 13.788 4.38084 14.236C3.75084 14.558 3.43584 14.789 3.40784 15.062H5.89984V16H2.06384V15.573C2.06384 14.523 2.92484 13.935 3.66684 13.501C4.38084 13.088 4.75184 12.878 4.75184 12.458C4.75184 12.08 4.52084 11.835 4.06584 11.835C3.58984 11.835 3.30984 12.199 3.28184 12.654H2.11284C2.18984 11.681 2.87584 10.918 4.07284 10.918C5.15784 10.918 5.89284 11.555 5.89284 12.479Z",fill:"currentColor"}),Rt("path",{d:"M2.68608 4.535V3.737C3.54008 3.737 3.90408 3.513 4.02308 2.995H4.89108V8H3.68008L3.68008 4.535H2.68608Z",fill:"currentColor"}),Rt("path",{d:"M8 15L17 15",stroke:"currentColor",strokeWidth:"1.5"}),Rt("path",{d:"M8 10L17 10",stroke:"currentColor",strokeWidth:"1.5"}),Rt("path",{d:"M8 5L17 5",stroke:"currentColor",strokeWidth:"1.5"})]});import{$isListNode as Rf,ListItemNode as If,ListNode as vf}from"@lexical/list";var Hi={type:"element",dependencies:[vf,If],export:(t,e)=>Rf(t)?Be(t,e,0):null,regExp:/^(\s*)(\d+)\.\s/,replace:tt("number")};var Ui=[te([{ChildComponent:gr,isActive:({selection:t})=>{if(!$f(t))return!1;for(let e of t.getNodes()){if(xr(e)&&e.getListType()==="number")continue;let o=e.getParent();if(xr(o)&&o.getListType()==="number")continue;let r=o?.getParent();if(!(xr(r)&&r.getListType()==="number"))return!1}return!0},key:"orderedList",label:({i18n:t})=>t.t("lexical:orderedList:label"),onSelect:({editor:t})=>{t.dispatchCommand(Wi,void 0)},order:10}])],Af=$(({featureProviderMap:t})=>{let e=xo("ordered",t);return{markdownTransformers:[Hi],nodes:e?[Df,Mf]:[],plugins:e?[{Component:Qe,position:"normal"}]:[],slashMenu:{groups:[et([{Icon:gr,key:"orderedList",keywords:["ordered list","ol"],label:({i18n:o})=>o.t("lexical:orderedList:label"),onSelect:({editor:o})=>{o.dispatchCommand(Wi,void 0)}}])]},toolbarFixed:{groups:Ui},toolbarInline:{groups:Ui}}});import{$isListNode as br,INSERT_UNORDERED_LIST_COMMAND as Ki,ListItemNode as jf,ListNode as Hf}from"@lexical/list";import{$isRangeSelection as Uf}from"lexical";import{jsx as ot,jsxs as Of}from"react/jsx-runtime";import"react";var Cr=()=>Of("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[ot("circle",{cx:"4",cy:"5",fill:"currentColor",r:"1.15",stroke:"currentColor",strokeWidth:"0.3"}),ot("circle",{cx:"4",cy:"10",fill:"currentColor",r:"1.15",stroke:"currentColor",strokeWidth:"0.3"}),ot("circle",{cx:"4",cy:"15",fill:"currentColor",r:"1.15",stroke:"currentColor",strokeWidth:"0.3"}),ot("path",{d:"M17 5H7",stroke:"currentColor",strokeWidth:"1.5"}),ot("path",{d:"M17 10H7",stroke:"currentColor",strokeWidth:"1.5"}),ot("path",{d:"M17 15H7",stroke:"currentColor",strokeWidth:"1.5"})]});import{$isListNode as Ff,ListItemNode as Pf,ListNode as Bf}from"@lexical/list";var Gi={type:"element",dependencies:[Bf,Pf],export:(t,e)=>Ff(t)?Be(t,e,0):null,regExp:/^(\s*)[-*+]\s/,replace:tt("bullet")};var Vi=[te([{ChildComponent:Cr,isActive:({selection:t})=>{if(!Uf(t))return!1;for(let e of t.getNodes()){if(br(e)&&e.getListType()==="bullet")continue;let o=e.getParent();if(br(o)&&o.getListType()==="bullet")continue;let r=o?.getParent();if(!(br(r)&&r.getListType()==="bullet"))return!1}return!0},key:"unorderedList",label:({i18n:t})=>t.t("lexical:unorderedList:label"),onSelect:({editor:t})=>{t.dispatchCommand(Ki,void 0)},order:11}])],Wf=$({markdownTransformers:[Gi],nodes:[Hf,jf],plugins:[{Component:Qe,position:"normal"}],slashMenu:{groups:[et([{Icon:Cr,key:"unorderedList",keywords:["unordered list","ul"],label:({i18n:t})=>t.t("lexical:unorderedList:label"),onSelect:({editor:t})=>{t.dispatchCommand(Ki,void 0)}}])]},toolbarFixed:{groups:Vi},toolbarInline:{groups:Vi}});import{jsx as Gf}from"react/jsx-runtime";import{addClassNamesToElement as Vf}from"@lexical/utils";import{$applyNodeReplacement as Kf,DecoratorNode as Jf}from"lexical";import*as Ji from"react";var zf=Ji.lazy(()=>import("./Component-MBLHTKDK.js").then(t=>({default:t.UnknownConvertedNodeComponent}))),It=class extends Jf{__data;constructor({data:e,key:o}){super(o),this.__data=e}static clone(e){return new this({data:e.__data,key:e.__key})}static getType(){return"unknownConverted"}static importJSON(e){return Xf({data:e.data})}canInsertTextAfter(){return!0}canInsertTextBefore(){return!0}createDOM(e){let o=document.createElement("span");return Vf(o,"unknownConverted"),o}decorate(){return Gf(zf,{data:this.__data})}exportJSON(){return{type:this.getType(),data:this.__data,version:1}}isInline(){return!0}updateDOM(e,o){return!1}};function Xf({data:t}){return Kf(new It({data:t}))}var Zf=$(()=>({nodes:[It]}));import{jsx as Yf}from"react/jsx-runtime";import{addClassNamesToElement as qf}from"@lexical/utils";import{$applyNodeReplacement as Qf,DecoratorNode as e0}from"lexical";import*as zi from"react";var t0=zi.lazy(()=>import("./Component-DOSSWC76.js").then(t=>({default:t.UnknownConvertedNodeComponent}))),vt=class extends e0{__data;constructor({data:e,key:o}){super(o),this.__data=e}static clone(e){return new this({data:e.__data,key:e.__key})}static getType(){return"unknownConverted"}static importJSON(e){return o0({data:e.data})}canInsertTextAfter(){return!0}canInsertTextBefore(){return!0}createDOM(e){let o=document.createElement("span");return qf(o,"unknownConverted"),o}decorate(){return Yf(t0,{data:this.__data})}exportJSON(){return{type:this.getType(),data:this.__data,version:1}}isInline(){return!0}updateDOM(e,o){return!1}};function o0({data:t}){return Qf(new vt({data:t}))}var r0=$(()=>({nodes:[vt]}));import{$setBlocksType as Yi}from"@lexical/selection";import{$createParagraphNode as qi,$getSelection as Qi,$isParagraphNode as Xi,$isRangeSelection as n0}from"lexical";var Zi=[te([{ChildComponent:xt,isActive:({selection:t})=>{if(!n0(t))return!1;for(let e of t.getNodes())if(!Xi(e)&&!Xi(e.getParent()))return!1;return!0},key:"paragraph",label:({i18n:t})=>t.t("lexical:paragraph:label2"),onSelect:({editor:t})=>{t.update(()=>{let e=Qi();Yi(e,()=>qi())})},order:1}])],l0=$({slashMenu:{groups:[Z([{Icon:xt,key:"paragraph",keywords:["normal","paragraph","p","text"],label:({i18n:t})=>t.t("lexical:paragraph:label"),onSelect:({editor:t})=>{t.update(()=>{let e=Qi();Yi(e,()=>qi())})}}])]},toolbarFixed:{groups:Zi},toolbarInline:{groups:Zi}});import{c as N0}from"react/compiler-runtime";import{jsx as bs}from"react/jsx-runtime";import{useLexicalComposerContext as L0}from"@lexical/react/LexicalComposerContext";import{useEffect as y0,useState as R0}from"react";import{jsx as Cs,Fragment as S0}from"react/jsx-runtime";import"react";import{jsx as i0}from"react/jsx-runtime";var es={quote:({node:t,nodesToJSX:e})=>{let o=e({nodes:t.children});return i0("blockquote",{children:o})}};import{jsx as s0}from"react/jsx-runtime";var ts={heading:({node:t,nodesToJSX:e})=>{let o=e({nodes:t.children}),r=t.tag;return s0(r,{children:o})}};import{jsx as a0}from"react/jsx-runtime";var os={horizontalrule:a0("hr",{})};import{jsx as c0}from"react/jsx-runtime";var rs={linebreak:c0("br",{})};import{jsx as ns}from"react/jsx-runtime";var ls=({internalDocToHref:t})=>({autolink:({node:e,nodesToJSX:o})=>{let r=o({nodes:e.children}),n=e.fields.newTab?"noopener noreferrer":void 0,l=e.fields.newTab?"_blank":void 0;return ns("a",{href:e.fields.url,rel:n,target:l,children:r})},link:({node:e,nodesToJSX:o})=>{let r=o({nodes:e.children}),n=e.fields.newTab?"noopener noreferrer":void 0,l=e.fields.newTab?"_blank":void 0,s=e.fields.url??"";return e.fields.linkType==="internal"&&(t?s=t({linkNode:e}):(console.error("Lexical => JSX converter: Link converter: found internal link, but internalDocToHref is not provided"),s="#")),ns("a",{href:s,rel:n,target:l,children:r})}});import{jsx as rt,jsxs as u0,Fragment as d0}from"react/jsx-runtime";import{v4 as m0}from"uuid";var is={list:({node:t,nodesToJSX:e})=>{let o=e({nodes:t.children}),r=t.tag;return rt(r,{className:`list-${t?.listType}`,children:o})},listitem:({node:t,nodesToJSX:e,parent:o})=>{let r=t.children.some(l=>l.type==="list"),n=e({nodes:t.children});if("listType"in o&&o?.listType==="check"){let l=m0();return rt("li",{"aria-checked":t.checked?"true":"false",className:`list-item-checkbox${t.checked?" list-item-checkbox-checked":" list-item-checkbox-unchecked"}${r?" nestedListItem":""}`,role:"checkbox",style:{listStyleType:"none"},tabIndex:-1,value:t?.value,children:r?n:u0(d0,{children:[rt("input",{checked:t.checked,id:l,readOnly:!0,type:"checkbox"}),rt("label",{htmlFor:l,children:n}),rt("br",{})]})})}else return rt("li",{className:`${r?"nestedListItem":""}`,style:r?{listStyleType:"none"}:void 0,value:t?.value,children:n})}};import{jsx as kr}from"react/jsx-runtime";var ss={paragraph:({node:t,nodesToJSX:e})=>{let o=e({nodes:t.children});return o?.length?kr("p",{children:o}):kr("p",{children:kr("br",{})})}};var as={tab:"	"};import{jsx as Mt}from"react/jsx-runtime";var cs={table:({node:t,nodesToJSX:e})=>{let o=e({nodes:t.children});return Mt("div",{className:"lexical-table-container",children:Mt("table",{className:"lexical-table",style:{borderCollapse:"collapse"},children:Mt("tbody",{children:o})})})},tablecell:({node:t,nodesToJSX:e})=>{let o=e({nodes:t.children}),r=t.headerState>0?"th":"td",n=`lexical-table-cell-header-${t.headerState}`,l={backgroundColor:t.backgroundColor||void 0,border:"1px solid #ccc",padding:"8px"},s=t.colSpan&&t.colSpan>1?t.colSpan:void 0,i=t.rowSpan&&t.rowSpan>1?t.rowSpan:void 0;return Mt(r,{className:`lexical-table-cell ${n}`,colSpan:s,rowSpan:i,style:l,children:o})},tablerow:({node:t,nodesToJSX:e})=>{let o=e({nodes:t.children});return Mt("tr",{className:"lexical-table-row",children:o})}};import{jsx as je}from"react/jsx-runtime";import"react";var F={DOM_ELEMENT_TYPE:1,DOM_TEXT_TYPE:3,NO_DIRTY_NODES:0,HAS_DIRTY_NODES:1,FULL_RECONCILE:2,IS_NORMAL:0,IS_TOKEN:1,IS_SEGMENTED:2,IS_INERT:3,IS_BOLD:1,IS_ITALIC:2,IS_STRIKETHROUGH:4,IS_UNDERLINE:8,IS_CODE:16,IS_SUBSCRIPT:32,IS_SUPERSCRIPT:64,IS_HIGHLIGHT:128,IS_DIRECTIONLESS:1,IS_UNMERGEABLE:2,IS_ALIGN_LEFT:1,IS_ALIGN_CENTER:2,IS_ALIGN_RIGHT:3,IS_ALIGN_JUSTIFY:4,IS_ALIGN_START:5,IS_ALIGN_END:6},p0=F.IS_BOLD|F.IS_ITALIC|F.IS_STRIKETHROUGH|F.IS_UNDERLINE|F.IS_CODE|F.IS_SUBSCRIPT|F.IS_SUPERSCRIPT|F.IS_HIGHLIGHT,f0="\xA0",h0=`

`,us="\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC",ds="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF",g0=new RegExp("^[^"+ds+"]*["+us+"]"),x0=new RegExp("^[^"+us+"]*["+ds+"]"),C0={bold:F.IS_BOLD,code:F.IS_CODE,highlight:F.IS_HIGHLIGHT,italic:F.IS_ITALIC,strikethrough:F.IS_STRIKETHROUGH,subscript:F.IS_SUBSCRIPT,superscript:F.IS_SUPERSCRIPT,underline:F.IS_UNDERLINE},b0={directionless:F.IS_DIRECTIONLESS,unmergeable:F.IS_UNMERGEABLE},k0={center:F.IS_ALIGN_CENTER,end:F.IS_ALIGN_END,justify:F.IS_ALIGN_JUSTIFY,left:F.IS_ALIGN_LEFT,right:F.IS_ALIGN_RIGHT,start:F.IS_ALIGN_START},_0={[F.IS_ALIGN_CENTER]:"center",[F.IS_ALIGN_END]:"end",[F.IS_ALIGN_JUSTIFY]:"justify",[F.IS_ALIGN_LEFT]:"left",[F.IS_ALIGN_RIGHT]:"right",[F.IS_ALIGN_START]:"start"},T0={normal:F.IS_NORMAL,segmented:F.IS_SEGMENTED,token:F.IS_TOKEN},w0={[F.IS_NORMAL]:"normal",[F.IS_SEGMENTED]:"segmented",[F.IS_TOKEN]:"token"};var ms={text:({node:t})=>{let e=t.text;return t.format&F.IS_BOLD&&(e=je("strong",{children:e})),t.format&F.IS_ITALIC&&(e=je("em",{children:e})),t.format&F.IS_STRIKETHROUGH&&(e=je("span",{style:{textDecoration:"line-through"},children:e})),t.format&F.IS_UNDERLINE&&(e=je("span",{style:{textDecoration:"underline"},children:e})),t.format&F.IS_CODE&&(e=je("code",{children:e})),t.format&F.IS_SUBSCRIPT&&(e=je("sub",{children:e})),t.format&F.IS_SUPERSCRIPT&&(e=je("sup",{children:e})),e}};import{jsx as Dt}from"react/jsx-runtime";var ps={upload:({node:t})=>{let e=t;if(typeof e.value!="object")return null;let o=e.value,r=e.fields?.alt||o?.alt||"",n=o.url;if(!o.mimeType.startsWith("image"))return Dt("a",{href:n,rel:"noopener noreferrer",children:o.filename});if(!o.sizes||!Object.keys(o.sizes).length)return Dt("img",{alt:r,height:o.height,src:n,width:o.width});let l=[];for(let s in o.sizes){let i=o.sizes[s];if(!i||!i.width||!i.height||!i.mimeType||!i.filesize||!i.filename||!i.url)continue;let d=i?.url;l.push(Dt("source",{media:`(max-width: ${i.width}px)`,srcSet:d,type:i.mimeType},s))}return l.push(Dt("img",{alt:r,height:o?.height,src:n,width:o?.width},"image")),Dt("picture",{children:l})}};var nt={...ss,...ms,...rs,...es,...cs,...ts,...os,...is,...ls({}),...ps,...as};import{jsx as hs,Fragment as E0}from"react/jsx-runtime";import _r from"react";function fs(t){let e=!!t?.root?.children?.length,o=!1;if(t?.root?.children?.length===1&&t?.root?.children[0]?.type==="paragraph"){let r=t?.root?.children[0];if(!r?.children||r?.children?.length===0)o=!0;else if(r?.children?.length===1){let n=r?.children[0];n?.type==="text"&&(n?.text?.length||(o=!0))}}return!(!e||o)}function gs({converters:t,data:e,disableIndent:o,disableTextAlign:r}){return fs(e)?xs({converters:t,disableIndent:o,disableTextAlign:r,nodes:e?.root?.children,parent:e?.root}):hs(E0,{})}function xs({converters:t,disableIndent:e,disableTextAlign:o,nodes:r,parent:n}){let l=t.unknown;return r.map((i,d)=>{let c;i.type==="block"?(c=t?.blocks?.[i?.fields?.blockType],!c&&!l&&console.error(`Lexical => JSX converter: Blocks converter: found ${i?.fields?.blockType} block, but no converter is provided`)):i.type==="inlineBlock"?(c=t?.inlineBlocks?.[i?.fields?.blockType],!c&&!l&&console.error(`Lexical => JSX converter: Inline Blocks converter: found ${i?.fields?.blockType} inline block, but no converter is provided`)):c=t[i.type];try{!c&&l&&(c=l);let u;c?u=typeof c=="function"?c({childIndex:d,converters:t,node:i,nodesToJSX:p=>xs({converters:p.converters??t,disableIndent:p.disableIndent??e,disableTextAlign:p.disableTextAlign??o,nodes:p.nodes,parent:p.parent??{...i,parent:n}}),parent:n}):c:u=hs("span",{children:"unknown node"},d);let a={};if(!o&&(!Array.isArray(o)||!o?.includes(i.type))&&"format"in i&&i.format)switch(i.format){case"center":a.textAlign="center";break;case"end":a.textAlign="right";break;case"justify":a.textAlign="justify";break;case"left":break;case"right":a.textAlign="right";break;case"start":a.textAlign="left";break}if(!e&&(!Array.isArray(e)||!e?.includes(i.type))&&"indent"in i&&i.indent&&i.type!=="listitem"&&(a.paddingInlineStart=`${Number(i.indent)*40}px`),_r.isValidElement(u)){if(a.textAlign||a.paddingInlineStart){let m={...a,...u?.props?.style??{}};return _r.cloneElement(u,{key:d,style:m})}return _r.cloneElement(u,{key:d})}return u}catch(u){return console.error("Error converting lexical node to JSX:",u,"node:",i),null}}).filter(Boolean)}var Tr=({className:t,converters:e,data:o,disableContainer:r,disableIndent:n,disableTextAlign:l})=>{if(!o)return null;let s={};e?typeof e=="function"?s=e({defaultConverters:nt}):s=e:s=nt;let i=o&&!Array.isArray(o)&&typeof o=="object"&&"root"in o&&gs({converters:s,data:o,disableIndent:n,disableTextAlign:l});return r?Cs(S0,{children:i}):Cs("div",{className:t??"payload-richtext",children:i})};function ks(){let t=N0(7),[e]=L0(),o;t[0]!==e?(o=e.getEditorState().toJSON(),t[0]=e,t[1]=o):o=t[1];let[r,n]=R0(o),l,s;t[2]!==e?(l=()=>e.registerUpdateListener(d=>{let{editorState:c}=d;n(c.toJSON())}),s=[e],t[2]=e,t[3]=l,t[4]=s):(l=t[3],s=t[4]),y0(l,s);let i;return t[5]!==r?(i=bs("div",{className:"debug-jsx-converter",children:bs(Tr,{converters:nt,data:r})}),t[5]=r,t[6]=i):i=t[6],i}var I0=$({plugins:[{Component:ks,position:"bottom"}]});var B={amber:{50:"oklch(0.987 0.022 95.277)",100:"oklch(0.962 0.059 95.617)",200:"oklch(0.924 0.12 95.746)",300:"oklch(0.879 0.169 91.605)",400:"oklch(0.828 0.189 84.429)",500:"oklch(0.769 0.188 70.08)",600:"oklch(0.666 0.179 58.318)",700:"oklch(0.555 0.163 48.998)",800:"oklch(0.473 0.137 46.201)",900:"oklch(0.414 0.112 45.904)",950:"oklch(0.279 0.077 45.635)"},black:"#000",blue:{50:"oklch(0.97 0.014 254.604)",100:"oklch(0.932 0.032 255.585)",200:"oklch(0.882 0.059 254.128)",300:"oklch(0.809 0.105 251.813)",400:"oklch(0.707 0.165 254.624)",500:"oklch(0.623 0.214 259.815)",600:"oklch(0.546 0.245 262.881)",700:"oklch(0.488 0.243 264.376)",800:"oklch(0.424 0.199 265.638)",900:"oklch(0.379 0.146 265.522)",950:"oklch(0.282 0.091 267.935)"},current:"currentColor",cyan:{50:"oklch(0.984 0.019 200.873)",100:"oklch(0.956 0.045 203.388)",200:"oklch(0.917 0.08 205.041)",300:"oklch(0.865 0.127 207.078)",400:"oklch(0.789 0.154 211.53)",500:"oklch(0.715 0.143 215.221)",600:"oklch(0.609 0.126 221.723)",700:"oklch(0.52 0.105 223.128)",800:"oklch(0.45 0.085 224.283)",900:"oklch(0.398 0.07 227.392)",950:"oklch(0.302 0.056 229.695)"},emerald:{50:"oklch(0.979 0.021 166.113)",100:"oklch(0.95 0.052 163.051)",200:"oklch(0.905 0.093 164.15)",300:"oklch(0.845 0.143 164.978)",400:"oklch(0.765 0.177 163.223)",500:"oklch(0.696 0.17 162.48)",600:"oklch(0.596 0.145 163.225)",700:"oklch(0.508 0.118 165.612)",800:"oklch(0.432 0.095 166.913)",900:"oklch(0.378 0.077 168.94)",950:"oklch(0.262 0.051 172.552)"},fuchsia:{50:"oklch(0.977 0.017 320.058)",100:"oklch(0.952 0.037 318.852)",200:"oklch(0.903 0.076 319.62)",300:"oklch(0.833 0.145 321.434)",400:"oklch(0.74 0.238 322.16)",500:"oklch(0.667 0.295 322.15)",600:"oklch(0.591 0.293 322.896)",700:"oklch(0.518 0.253 323.949)",800:"oklch(0.452 0.211 324.591)",900:"oklch(0.401 0.17 325.612)",950:"oklch(0.293 0.136 325.661)"},gray:{50:"oklch(0.985 0.002 247.839)",100:"oklch(0.967 0.003 264.542)",200:"oklch(0.928 0.006 264.531)",300:"oklch(0.872 0.01 258.338)",400:"oklch(0.707 0.022 261.325)",500:"oklch(0.551 0.027 264.364)",600:"oklch(0.446 0.03 256.802)",700:"oklch(0.373 0.034 259.733)",800:"oklch(0.278 0.033 256.848)",900:"oklch(0.21 0.034 264.665)",950:"oklch(0.13 0.028 261.692)"},green:{50:"oklch(0.982 0.018 155.826)",100:"oklch(0.962 0.044 156.743)",200:"oklch(0.925 0.084 155.995)",300:"oklch(0.871 0.15 154.449)",400:"oklch(0.792 0.209 151.711)",500:"oklch(0.723 0.219 149.579)",600:"oklch(0.627 0.194 149.214)",700:"oklch(0.527 0.154 150.069)",800:"oklch(0.448 0.119 151.328)",900:"oklch(0.393 0.095 152.535)",950:"oklch(0.266 0.065 152.934)"},indigo:{50:"oklch(0.962 0.018 272.314)",100:"oklch(0.93 0.034 272.788)",200:"oklch(0.87 0.065 274.039)",300:"oklch(0.785 0.115 274.713)",400:"oklch(0.673 0.182 276.935)",500:"oklch(0.585 0.233 277.117)",600:"oklch(0.511 0.262 276.966)",700:"oklch(0.457 0.24 277.023)",800:"oklch(0.398 0.195 277.366)",900:"oklch(0.359 0.144 278.697)",950:"oklch(0.257 0.09 281.288)"},inherit:"inherit",lime:{50:"oklch(0.986 0.031 120.757)",100:"oklch(0.967 0.067 122.328)",200:"oklch(0.938 0.127 124.321)",300:"oklch(0.897 0.196 126.665)",400:"oklch(0.841 0.238 128.85)",500:"oklch(0.768 0.233 130.85)",600:"oklch(0.648 0.2 131.684)",700:"oklch(0.532 0.157 131.589)",800:"oklch(0.453 0.124 130.933)",900:"oklch(0.405 0.101 131.063)",950:"oklch(0.274 0.072 132.109)"},neutral:{50:"oklch(0.985 0 0)",100:"oklch(0.97 0 0)",200:"oklch(0.922 0 0)",300:"oklch(0.87 0 0)",400:"oklch(0.708 0 0)",500:"oklch(0.556 0 0)",600:"oklch(0.439 0 0)",700:"oklch(0.371 0 0)",800:"oklch(0.269 0 0)",900:"oklch(0.205 0 0)",950:"oklch(0.145 0 0)"},orange:{50:"oklch(0.98 0.016 73.684)",100:"oklch(0.954 0.038 75.164)",200:"oklch(0.901 0.076 70.697)",300:"oklch(0.837 0.128 66.29)",400:"oklch(0.75 0.183 55.934)",500:"oklch(0.705 0.213 47.604)",600:"oklch(0.646 0.222 41.116)",700:"oklch(0.553 0.195 38.402)",800:"oklch(0.47 0.157 37.304)",900:"oklch(0.408 0.123 38.172)",950:"oklch(0.266 0.079 36.259)"},pink:{50:"oklch(0.971 0.014 343.198)",100:"oklch(0.948 0.028 342.258)",200:"oklch(0.899 0.061 343.231)",300:"oklch(0.823 0.12 346.018)",400:"oklch(0.718 0.202 349.761)",500:"oklch(0.656 0.241 354.308)",600:"oklch(0.592 0.249 0.584)",700:"oklch(0.525 0.223 3.958)",800:"oklch(0.459 0.187 3.815)",900:"oklch(0.408 0.153 2.432)",950:"oklch(0.284 0.109 3.907)"},purple:{50:"oklch(0.977 0.014 308.299)",100:"oklch(0.946 0.033 307.174)",200:"oklch(0.902 0.063 306.703)",300:"oklch(0.827 0.119 306.383)",400:"oklch(0.714 0.203 305.504)",500:"oklch(0.627 0.265 303.9)",600:"oklch(0.558 0.288 302.321)",700:"oklch(0.496 0.265 301.924)",800:"oklch(0.438 0.218 303.724)",900:"oklch(0.381 0.176 304.987)",950:"oklch(0.291 0.149 302.717)"},red:{50:"oklch(0.971 0.013 17.38)",100:"oklch(0.936 0.032 17.717)",200:"oklch(0.885 0.062 18.334)",300:"oklch(0.808 0.114 19.571)",400:"oklch(0.704 0.191 22.216)",500:"oklch(0.637 0.237 25.331)",600:"oklch(0.577 0.245 27.325)",700:"oklch(0.505 0.213 27.518)",800:"oklch(0.444 0.177 26.899)",900:"oklch(0.396 0.141 25.723)",950:"oklch(0.258 0.092 26.042)"},rose:{50:"oklch(0.969 0.015 12.422)",100:"oklch(0.941 0.03 12.58)",200:"oklch(0.892 0.058 10.001)",300:"oklch(0.81 0.117 11.638)",400:"oklch(0.712 0.194 13.428)",500:"oklch(0.645 0.246 16.439)",600:"oklch(0.586 0.253 17.585)",700:"oklch(0.514 0.222 16.935)",800:"oklch(0.455 0.188 13.697)",900:"oklch(0.41 0.159 10.272)",950:"oklch(0.271 0.105 12.094)"},sky:{50:"oklch(0.977 0.013 236.62)",100:"oklch(0.951 0.026 236.824)",200:"oklch(0.901 0.058 230.902)",300:"oklch(0.828 0.111 230.318)",400:"oklch(0.746 0.16 232.661)",500:"oklch(0.685 0.169 237.323)",600:"oklch(0.588 0.158 241.966)",700:"oklch(0.5 0.134 242.749)",800:"oklch(0.443 0.11 240.79)",900:"oklch(0.391 0.09 240.876)",950:"oklch(0.293 0.066 243.157)"},slate:{50:"oklch(0.984 0.003 247.858)",100:"oklch(0.968 0.007 247.896)",200:"oklch(0.929 0.013 255.508)",300:"oklch(0.869 0.022 252.894)",400:"oklch(0.704 0.04 256.788)",500:"oklch(0.554 0.046 257.417)",600:"oklch(0.446 0.043 257.281)",700:"oklch(0.372 0.044 257.287)",800:"oklch(0.279 0.041 260.031)",900:"oklch(0.208 0.042 265.755)",950:"oklch(0.129 0.042 264.695)"},stone:{50:"oklch(0.985 0.001 106.423)",100:"oklch(0.97 0.001 106.424)",200:"oklch(0.923 0.003 48.717)",300:"oklch(0.869 0.005 56.366)",400:"oklch(0.709 0.01 56.259)",500:"oklch(0.553 0.013 58.071)",600:"oklch(0.444 0.011 73.639)",700:"oklch(0.374 0.01 67.558)",800:"oklch(0.268 0.007 34.298)",900:"oklch(0.216 0.006 56.043)",950:"oklch(0.147 0.004 49.25)"},teal:{50:"oklch(0.984 0.014 180.72)",100:"oklch(0.953 0.051 180.801)",200:"oklch(0.91 0.096 180.426)",300:"oklch(0.855 0.138 181.071)",400:"oklch(0.777 0.152 181.912)",500:"oklch(0.704 0.14 182.503)",600:"oklch(0.6 0.118 184.704)",700:"oklch(0.511 0.096 186.391)",800:"oklch(0.437 0.078 188.216)",900:"oklch(0.386 0.063 188.416)",950:"oklch(0.277 0.046 192.524)"},transparent:"transparent",violet:{50:"oklch(0.969 0.016 293.756)",100:"oklch(0.943 0.029 294.588)",200:"oklch(0.894 0.057 293.283)",300:"oklch(0.811 0.111 293.571)",400:"oklch(0.702 0.183 293.541)",500:"oklch(0.606 0.25 292.717)",600:"oklch(0.541 0.281 293.009)",700:"oklch(0.491 0.27 292.581)",800:"oklch(0.432 0.232 292.759)",900:"oklch(0.38 0.189 293.745)",950:"oklch(0.283 0.141 291.089)"},white:"#fff",yellow:{50:"oklch(0.987 0.026 102.212)",100:"oklch(0.973 0.071 103.193)",200:"oklch(0.945 0.129 101.54)",300:"oklch(0.905 0.182 98.111)",400:"oklch(0.852 0.199 91.936)",500:"oklch(0.795 0.184 86.047)",600:"oklch(0.681 0.162 75.834)",700:"oklch(0.554 0.135 66.442)",800:"oklch(0.476 0.114 61.907)",900:"oklch(0.421 0.095 57.708)",950:"oklch(0.286 0.066 53.813)"},zinc:{50:"oklch(0.985 0 0)",100:"oklch(0.967 0.001 286.375)",200:"oklch(0.92 0.004 286.32)",300:"oklch(0.871 0.006 286.286)",400:"oklch(0.705 0.015 286.067)",500:"oklch(0.552 0.016 285.938)",600:"oklch(0.442 0.017 285.786)",700:"oklch(0.37 0.013 285.805)",800:"oklch(0.274 0.006 286.033)",900:"oklch(0.21 0.006 285.885)",950:"oklch(0.141 0.005 285.823)"}},v0={text:{"text-red":{css:{color:`light-dark(${B.red[600]}, ${B.red[400]})`},label:"Red"},"text-orange":{css:{color:`light-dark(${B.orange[600]}, ${B.orange[400]})`},label:"Orange"},"text-yellow":{css:{color:`light-dark(${B.yellow[700]}, ${B.yellow[300]})`},label:"Yellow"},"text-green":{css:{color:`light-dark(${B.green[700]}, ${B.green[400]})`},label:"Green"},"text-blue":{css:{color:`light-dark(${B.blue[600]}, ${B.blue[400]})`},label:"Blue"},"text-purple":{css:{color:`light-dark(${B.purple[600]}, ${B.purple[400]})`},label:"Purple"},"text-pink":{css:{color:`light-dark(${B.pink[600]}, ${B.pink[400]})`},label:"Pink"}},background:{"bg-red":{css:{"background-color":`light-dark(${B.red[400]}, ${B.red[600]})`},label:"Red"},"bg-orange":{css:{"background-color":`light-dark(${B.orange[400]}, ${B.orange[600]})`},label:"Orange"},"bg-yellow":{css:{"background-color":`light-dark(${B.yellow[300]}, ${B.yellow[700]})`},label:"Yellow"},"bg-green":{css:{"background-color":`light-dark(${B.green[400]}, ${B.green[700]})`},label:"Green"},"bg-blue":{css:{"background-color":`light-dark(${B.blue[400]}, ${B.blue[600]})`},label:"Blue"},"bg-purple":{css:{"background-color":`light-dark(${B.purple[400]}, ${B.purple[600]})`},label:"Purple"},"bg-pink":{css:{"background-color":`light-dark(${B.pink[400]}, ${B.pink[600]})`},label:"Pink"}}};import{$isNodeSelection as b1}from"lexical";import{jsx as $t,jsxs as M0}from"react/jsx-runtime";import"react";var wr=()=>M0("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[$t("g",{clipPath:"url(#clip0_4397_10817)",children:$t("path",{d:"M7.75 12.25L15.25 4.75M15.25 4.75H11.5M15.25 4.75V8.5M13 11.5V13.75C13 14.5784 12.3284 15.25 11.5 15.25H6.25C5.42157 15.25 4.75 14.5784 4.75 13.75V8.5C4.75 7.67157 5.42157 7 6.25 7H8.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})}),$t("defs",{children:$t("clipPath",{id:"clip0_4397_10817",children:$t("rect",{fill:"currentColor",height:"12",transform:"translate(4 4)",width:"12"})})})]});import{jsx as F0}from"react/jsx-runtime";import{$applyNodeReplacement as P0}from"lexical";import*as Ts from"react";import{DecoratorBlockNode as D0}from"@lexical/react/LexicalDecoratorBlockNode.js";import{addClassNamesToElement as $0}from"@lexical/utils";import{$applyNodeReplacement as A0}from"lexical";function O0(t){let e=t.getAttribute("data-lexical-relationship-id"),o=t.getAttribute("data-lexical-relationship-relationTo");return e!=null&&o!=null?{node:_s({relationTo:o,value:e})}:null}var At=class extends D0{__data;constructor({data:e,format:o,key:r}){super(o,r),this.__data=e}static clone(e){return new this({data:e.__data,format:e.__format,key:e.__key})}static getType(){return"relationship"}static importDOM(){return{div:e=>!e.hasAttribute("data-lexical-relationship-relationTo")||!e.hasAttribute("data-lexical-relationship-id")?null:{conversion:O0,priority:2}}}static importJSON(e){e.version===1&&e?.value?.id&&(e.value=e.value.id);let o={relationTo:e.relationTo,value:e.value},r=_s(o);return r.setFormat(e.format),r}static isInline(){return!1}createDOM(e){let o=document.createElement("div");return $0(o,e?.theme?.relationship),o}decorate(e,o){return null}exportDOM(){let e=document.createElement("div");e.setAttribute("data-lexical-relationship-id",String(typeof this.__data?.value=="object"?this.__data?.value?.id:this.__data?.value)),e.setAttribute("data-lexical-relationship-relationTo",this.__data?.relationTo);let o=document.createTextNode(this.getTextContent());return e.append(o),{element:e}}exportJSON(){return{...super.exportJSON(),...this.getData(),type:"relationship",version:2}}getData(){return this.getLatest().__data}getTextContent(){return`${this.__data?.relationTo} relation to ${typeof this.__data?.value=="object"?this.__data?.value?.id:this.__data?.value}`}setData(e){let o=this.getWritable();o.__data=e}};function _s(t){return A0(new At({data:t}))}var B0=Ts.lazy(()=>import("./RelationshipComponent-BG3DPV3T.js").then(t=>({default:t.RelationshipComponent})));function j0(t){let e=t.getAttribute("data-lexical-relationship-id"),o=t.getAttribute("data-lexical-relationship-relationTo");return e!=null&&o!=null?{node:He({relationTo:o,value:e})}:null}var Se=class extends At{static clone(e){return super.clone(e)}static getType(){return super.getType()}static importDOM(){return{div:e=>!e.hasAttribute("data-lexical-relationship-relationTo")||!e.hasAttribute("data-lexical-relationship-id")?null:{conversion:j0,priority:2}}}static importJSON(e){e.version===1&&e?.value?.id&&(e.value=e.value.id);let o={relationTo:e.relationTo,value:e.value},r=He(o);return r.setFormat(e.format),r}decorate(e,o){return F0(B0,{className:o.theme.relationship??"LexicalEditorTheme__relationship",data:this.__data,format:this.__format,nodeKey:this.getKey()})}exportJSON(){return super.exportJSON()}};function He(t){return P0(new Se({data:t}))}function Er(t){return t instanceof Se}import{c as s1}from"react/compiler-runtime";import{jsx as a1}from"react/jsx-runtime";import{useLexicalComposerContext as c1}from"@lexical/react/LexicalComposerContext.js";import{$insertNodeToNearestRoot as u1}from"@lexical/utils";import{$getPreviousSelection as d1,$getSelection as m1,$isParagraphNode as p1,$isRangeSelection as f1,COMMAND_PRIORITY_EDITOR as h1,createCommand as g1}from"lexical";import{useEffect as x1}from"react";import{c as Ss}from"react/compiler-runtime";import{jsx as Sr}from"react/jsx-runtime";import{useLexicalComposerContext as Ns}from"@lexical/react/LexicalComposerContext.js";import{toast as q0}from"@payloadcms/ui";import{$getNodeByKey as Q0,COMMAND_PRIORITY_EDITOR as Ls}from"lexical";import{useEffect as ys,useState as e1}from"react";import{c as H0}from"react/compiler-runtime";import{jsx as U0}from"react/jsx-runtime";import{useLexicalComposerContext as W0}from"@lexical/react/LexicalComposerContext";import{useListDrawer as G0,useModal as V0}from"@payloadcms/ui";import{$getNodeByKey as ws,$getPreviousSelection as K0,$getRoot as J0,$getSelection as z0,$isRangeSelection as X0,$setSelection as Z0}from"lexical";import{useEffect as Y0,useState as Es}from"react";var Ot=t=>{let e=H0(23),[o]=W0(),[r,n]=Es(null),[l,s]=Es(!1),[i,d,c]=G0(t),{closeDrawer:u,drawerSlug:a,isDrawerOpen:m,openDrawer:p}=c,{modalState:f}=V0(),h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=()=>{let R=z0()??K0();n(R)},e[0]=h):h=e[0];let x=h,w;e[1]!==o||e[2]!==r?(w=()=>{r&&o.update(()=>{if(X0(r)){let{anchor:R,focus:M}=r;ws(R.key)&&ws(M.key)&&Z0(r.clone())}else J0().selectEnd()},{discrete:!0,skipTransforms:!0})},e[1]=o,e[2]=r,e[3]=w):w=e[3];let E=w,N;e[4]!==u?(N=()=>{u()},e[4]=u,e[5]=N):N=e[5];let _=N,C,g;e[6]!==a||e[7]!==f||e[8]!==E||e[9]!==l?(C=()=>{if(!l)return;let R=f[a];R&&!R?.isOpen&&(s(!1),setTimeout(()=>{E()},1))},g=[f,a,E,l],e[6]=a,e[7]=f,e[8]=E,e[9]=l,e[10]=C,e[11]=g):(C=e[10],g=e[11]),Y0(C,g);let b;e[12]!==d?(b=R=>U0(d,{...R,onClick:()=>{x()}}),e[12]=d,e[13]=b):b=e[13];let k;e[14]!==p?(k=()=>{x(),p(),s(!0)},e[14]=p,e[15]=k):k=e[15];let y;return e[16]!==i||e[17]!==_||e[18]!==m||e[19]!==a||e[20]!==b||e[21]!==k?(y={closeListDrawer:_,isListDrawerOpen:m,ListDrawer:i,listDrawerSlug:a,ListDrawerToggler:b,openListDrawer:k},e[16]=i,e[17]=_,e[18]=m,e[19]=a,e[20]=b,e[21]=k,e[22]=y):y=e[22],y};var t1=({editor:t,relationTo:e,replaceNodeKey:o,value:r})=>{o?t.update(()=>{let n=Q0(o);n&&n.replace(He({relationTo:e,value:r}))}):t.dispatchCommand(Nr,{relationTo:e,value:r})},o1=t=>{let e=Ss(14),{enabledCollectionSlugs:o}=t,[r]=Ns(),[n,l]=e1(null),s=o?.[0],i;e[0]!==o||e[1]!==s?(i={collectionSlugs:o,selectedCollection:s},e[0]=o,e[1]=s,e[2]=i):i=e[2];let{closeListDrawer:d,ListDrawer:c,openListDrawer:u}=Ot(i),a,m;e[3]!==r||e[4]!==u?(a=()=>r.registerCommand(Je,x=>(l(x?.replace?x?.replace.nodeKey:null),u(),!0),Ls),m=[r,u],e[3]=r,e[4]=u,e[5]=a,e[6]=m):(a=e[5],m=e[6]),ys(a,m);let p;e[7]!==d||e[8]!==r||e[9]!==n?(p=x=>{let{collectionSlug:w,doc:E}=x;t1({editor:r,relationTo:w,replaceNodeKey:n,value:E.id}),d()},e[7]=d,e[8]=r,e[9]=n,e[10]=p):p=e[10];let f=p,h;return e[11]!==c||e[12]!==f?(h=Sr(c,{onSelect:f}),e[11]=c,e[12]=f,e[13]=h):h=e[13],h},r1=()=>{let t=Ss(3),[e]=Ns(),o,r;return t[0]!==e?(o=()=>e.registerCommand(Je,n1,Ls),r=[e],t[0]=e,t[1]=o,t[2]=r):(o=t[1],r=t[2]),ys(o,r),null},Rs=({enabledCollectionSlugs:t})=>t?.length?Sr(o1,{enabledCollectionSlugs:t}):Sr(r1,{});function n1(){return q0.error("No relationship collections enabled"),!0}import{useConfig as l1,useEntityVisibility as i1}from"@payloadcms/ui";import*as Is from"react";var Co=t=>{let{collectionSlugsBlacklist:e,collectionSlugsWhitelist:o,uploads:r=!1}=t||{},{config:{collections:n}}=l1(),{visibleEntities:l}=i1();return Is.useMemo(()=>{let i=[],d=[],c=o?new Set(o):null,u=e?new Set(e):null;for(let a of n){let{slug:m,admin:{enableRichTextRelationship:p},upload:f}=a;if(l?.collections.includes(m)){if(r){if(!p||!f)continue}else if(f||!p)continue;c&&!c.has(m)||u&&u.has(m)||(i.push(m),d.push(a))}}return{enabledCollections:d,enabledCollectionSlugs:i}},[n,l,r,o,e])};var Nr=g1("INSERT_RELATIONSHIP_COMMAND"),vs=t=>{let e=s1(8),{clientProps:o}=t,[r]=c1(),n=o?.disabledCollections,l=o?.enabledCollections,s;e[0]!==n||e[1]!==l?(s={collectionSlugsBlacklist:n,collectionSlugsWhitelist:l},e[0]=n,e[1]=l,e[2]=s):s=e[2];let{enabledCollectionSlugs:i}=Co(s),d,c;e[3]!==r?(d=()=>{if(!r.hasNodes([Se]))throw new Error("RelationshipPlugin: RelationshipNode not registered on editor");return r.registerCommand(Nr,C1,h1)},c=[r],e[3]=r,e[4]=d,e[5]=c):(d=e[4],c=e[5]),x1(d,c);let u;return e[6]!==i?(u=a1(Rs,{enabledCollectionSlugs:i}),e[6]=i,e[7]=u):u=e[7],u};function C1(t){let e=m1()||d1();if(f1(e)){let o=He(t),{focus:r}=e,n=r.getNode();u1(o),p1(n)&&!n.__first&&n.remove()}return!0}var k1=$({nodes:[Se],plugins:[{Component:vs,position:"normal"}],slashMenu:{groups:[Z([{Icon:wr,key:"relationship",keywords:["relationship","relation","rel"],label:({i18n:t})=>t.t("lexical:relationship:label"),onSelect:({editor:t})=>{t.dispatchCommand(Je,{replace:!1})}}])]},toolbarFixed:{groups:[be([{ChildComponent:wr,isActive:({selection:t})=>{if(!b1(t)||!t.getNodes().length)return!1;let e=t.getNodes()[0];return Er(e)},key:"relationship",label:({i18n:t})=>t.t("lexical:relationship:label"),onSelect:({editor:t})=>{t.dispatchCommand(Je,{replace:!1})}}])]}});import{c as js}from"react/compiler-runtime";import{jsx as se,jsxs as J1}from"react/jsx-runtime";import{useLexicalComposerContext as z1}from"@lexical/react/LexicalComposerContext.js";import{useLexicalEditable as Hs}from"@lexical/react/useLexicalEditable";import{useScrollInfo as X1,useThrottledEffect as Z1,useTranslation as Y1}from"@payloadcms/ui";import*as Ne from"react";import{useMemo as q1}from"react";import{c as _1}from"react/compiler-runtime";import{jsx as T1}from"react/jsx-runtime";import{mergeRegister as w1}from"@lexical/utils";import{$addUpdateTag as E1,$getSelection as S1}from"lexical";import{useDeferredValue as N1,useEffect as L1,useState as y1}from"react";var Ms="toolbar-popup__button",Ft=t=>{let e=_1(23),{children:o,editor:r,item:n}=t,l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={active:!1,enabled:!0},e[0]=l):l=e[0];let[s,i]=y1(l),d=N1(s),c=H(),u=d.enabled?"":"disabled",a=d.active?"active":"",m=n.key?`${Ms}-${n.key}`:"",p;e[1]!==u||e[2]!==a||e[3]!==m?(p=[Ms,u,a,m].filter(Boolean),e[1]=u,e[2]=a,e[3]=m,e[4]=p):p=e[4];let f=p.join(" "),h;e[5]!==r||e[6]!==c||e[7]!==n?(h=()=>{r.getEditorState().read(()=>{let k=S1();if(!k)return;let y=n.isActive?n.isActive({editor:r,editorConfigContext:c,selection:k}):!1,R=n.isEnabled?n.isEnabled({editor:r,editorConfigContext:c,selection:k}):!0;i(M=>M.active===y&&M.enabled===R?M:{active:y,enabled:R})})},e[5]=r,e[6]=c,e[7]=n,e[8]=h):h=e[8];let x=h,w=Xt(),E,N;e[9]!==r||e[10]!==w||e[11]!==x?(E=()=>{w(x);let k=()=>w(x),y=w1(r.registerUpdateListener(k));return document.addEventListener("mouseup",k),()=>{y(),document.removeEventListener("mouseup",k)}},N=[r,w,x],e[9]=r,e[10]=w,e[11]=x,e[12]=E,e[13]=N):(E=e[12],N=e[13]),L1(E,N);let _;e[14]!==s||e[15]!==r||e[16]!==n?(_=()=>{s.enabled&&r.focus(()=>{r.update(R1),n.onSelect?.({editor:r,isActive:s.active})})},e[14]=s,e[15]=r,e[16]=n,e[17]=_):_=e[17];let C=_,g=I1,b;return e[18]!==o||e[19]!==f||e[20]!==C||e[21]!==n.key?(b=T1("button",{className:f,"data-button-key":n.key,onClick:C,onMouseDown:g,type:"button",children:o}),e[18]=o,e[19]=f,e[20]=C,e[21]=n.key,e[22]=b):b=e[22],b};function R1(){E1("toolbar")}function I1(t){t.preventDefault()}import{c as F1}from"react/compiler-runtime";import{jsx as lt}from"react/jsx-runtime";import Bs,{useCallback as P1,useDeferredValue as B1,useEffect as j1,useMemo as H1}from"react";import{mergeRegister as U1}from"@lexical/utils";import{useTranslation as W1}from"@payloadcms/ui";import{$getSelection as G1}from"lexical";import{jsx as ve,jsxs as Ds}from"react/jsx-runtime";import{Button as v1}from"@payloadcms/ui";import{$addUpdateTag as M1,isDOMNode as D1}from"lexical";import bo,{useCallback as $1,useEffect as ko,useMemo as As,useRef as Lr,useState as yr}from"react";import{createPortal as A1}from"react-dom";var $s="toolbar-popup__dropdown-item",Os=bo.createContext(null);function Fs({active:t,children:e,editor:o,enabled:r,Icon:n,item:l,itemKey:s,tooltip:i}){let d=As(()=>[$s,r===!1?"disabled":"",t?"active":"",l?.key?`${$s}-${l.key}`:""].filter(Boolean).join(" "),[r,t,l.key]),c=Lr(null),u=bo.use(Os);if(u===null)throw new Error("DropDownItem must be used within a DropDown");let{registerItem:a}=u;return ko(()=>{c?.current!=null&&a(c)},[c,a]),ve(v1,{"aria-label":i,buttonStyle:"none",className:d,disabled:r===!1,extraButtonProps:{"data-item-key":s},icon:n,iconPosition:"left",iconStyle:"none",onClick:()=>{r!==!1&&o.focus(()=>{o.update(()=>{M1("toolbar")}),l.onSelect?.({editor:o,isActive:t})})},onMouseDown:m=>{m.preventDefault()},ref:c,tooltip:i,type:"button",children:e})}function O1({children:t,dropDownRef:e,itemsContainerClassNames:o,onClose:r}){let[n,l]=yr(),[s,i]=yr(),d=$1(a=>{l(m=>m!=null?[...m,a]:[a])},[l]),c=a=>{if(n==null)return;let{key:m}=a;["ArrowDown","ArrowUp","Escape","Tab"].includes(m)&&a.preventDefault(),m==="Escape"||m==="Tab"?r():m==="ArrowUp"?i(p=>{if(p==null)return n[0];let f=n.indexOf(p)-1;return n[f===-1?n.length-1:f]}):m==="ArrowDown"&&i(p=>p==null?n[0]:n[n.indexOf(p)+1])},u=As(()=>({registerItem:d}),[d]);return ko(()=>{n!=null&&s==null&&i(n[0]),s!=null&&s?.current!=null&&s.current.focus()},[n,s]),ve(Os,{value:u,children:ve("div",{className:(o??["toolbar-popup__dropdown-items"]).join(" "),onKeyDown:c,ref:e,children:t})})}function Ps({buttonAriaLabel:t,buttonClassName:e,children:o,disabled:r=!1,dropdownKey:n,Icon:l,itemsContainerClassNames:s,label:i,stopCloseOnClickSelf:d}){let c=Lr(null),u=Lr(null),[a,m]=yr(!1),p=()=>{m(!1),u?.current!=null&&u.current.focus()};ko(()=>{let h=u.current,x=c.current;if(a&&h!==null&&x!==null){let{left:w,top:E}=h.getBoundingClientRect(),N=window.scrollY||document.documentElement.scrollTop;x.style.top=`${E+N+h.offsetHeight+5}px`,x.style.left=`${Math.min(w-5,window.innerWidth-x.offsetWidth-20)}px`}},[c,u,a]),ko(()=>{let h=u.current;if(h!==null&&a){let x=w=>{let E=w.target;D1(E)&&(d&&c.current&&c.current.contains(E)||h.contains(E)||m(!1))};return document.addEventListener("click",x),()=>{document.removeEventListener("click",x)}}},[c,u,a,d]);let f=A1(ve(O1,{dropDownRef:c,itemsContainerClassNames:s,onClose:p,children:o}),document.body);return Ds(bo.Fragment,{children:[Ds("button",{"aria-label":t,className:e+(a?" active":""),"data-dropdown-key":n,disabled:r,onClick:h=>{h.preventDefault(),m(!a)},onMouseDown:h=>{h.preventDefault()},ref:u,type:"button",children:[l&&ve(l,{}),i&&ve("span",{className:"toolbar-popup__dropdown-label",children:i}),ve("i",{className:"toolbar-popup__dropdown-caret"})]}),a&&ve(bo.Fragment,{children:f})]})}var Rr="toolbar-popup__dropdown",V1=t=>{let e=F1(14),{active:o,anchorElem:r,editor:n,enabled:l,item:s}=t,{i18n:i}=W1(),{fieldProps:d}=H(),{featureClientSchemaMap:c,schemaPath:u}=d;if(s.Component){let m;return e[0]!==o||e[1]!==r||e[2]!==n||e[3]!==l||e[4]!==s?(m=s?.Component&&lt(s.Component,{active:o,anchorElem:r,editor:n,enabled:l,item:s},s.key),e[0]=o,e[1]=r,e[2]=n,e[3]=l,e[4]=s,e[5]=m):m=e[5],m}let a;if(e[6]!==o||e[7]!==n||e[8]!==l||e[9]!==c||e[10]!==i||e[11]!==s||e[12]!==u){let m=s.key,p;s.label&&(m=typeof s.label=="function"?s.label({featureClientSchemaMap:c,i18n:i,schemaPath:u}):s.label),m.length>25?p=m.substring(0,25)+"...":p=m,a=lt(Fs,{active:o,editor:n,enabled:l,Icon:s?.ChildComponent?lt(s.ChildComponent,{}):void 0,item:s,itemKey:s.key,tooltip:m,children:lt("span",{className:"text",children:p})},s.key),e[6]=o,e[7]=n,e[8]=l,e[9]=c,e[10]=i,e[11]=s,e[12]=u,e[13]=a}else a=e[13];return a},K1=Bs.memo(V1),Ue=({anchorElem:t,classNames:e,editor:o,group:r,Icon:n,itemsContainerClassNames:l,label:s,maxActiveItems:i,onActiveChange:d})=>{let[c,u]=Bs.useState({activeItemKeys:[],enabledGroup:!0,enabledItemKeys:[]}),a=B1(c),m=H(),{items:p,key:f}=r,h=Xt(),x=P1(()=>{o.getEditorState().read(()=>{let E=G1();if(!E)return;let N=[],_=[],C=[];for(let g of p)g.isActive&&(!i||N.length<i)&&g.isActive({editor:o,editorConfigContext:m,selection:E})&&(N.push(g.key),_.push(g)),g.isEnabled?g.isEnabled({editor:o,editorConfigContext:m,selection:E})&&C.push(g.key):C.push(g.key);u({activeItemKeys:N,enabledGroup:r.isEnabled?r.isEnabled({editor:o,editorConfigContext:m,selection:E}):!0,enabledItemKeys:C}),d&&d({activeItems:_})})},[o,m,r,p,i,d]);j1(()=>(h(x),U1(o.registerUpdateListener(async()=>{await h(x)}))),[o,h,x]);let w=H1(()=>p?.length?p.map(E=>lt(K1,{active:a.activeItemKeys.includes(E.key),anchorElem:t,editor:o,enabled:a.enabledItemKeys.includes(E.key),item:E},E.key)):null,[p,a,t,o]);return lt(Ps,{buttonAriaLabel:`${f} dropdown`,buttonClassName:[Rr,`${Rr}-${f}`,...e||[]].filter(Boolean).join(" "),disabled:!a.enabledGroup,dropdownKey:f,Icon:n,itemsContainerClassNames:[`${Rr}-items`,...l||[]],label:s,children:w},f)};function Q1({anchorElem:t,editor:e,item:o}){return o.Component?o?.Component&&se(o.Component,{anchorElem:t,editor:e,item:o},o.key):o.ChildComponent?se(Ft,{editor:e,item:o,children:se(o.ChildComponent,{})},o.key):null}function eh(t){let e=js(23),{anchorElem:o,editor:r,editorConfig:n,group:l,index:s}=t,{i18n:i}=Y1(),{fieldProps:d}=H(),{featureClientSchemaMap:c,schemaPath:u}=d,[a,m]=Ne.useState(void 0),[p,f]=Ne.useState(void 0),h;e[0]!==l.ChildComponent||e[1]!==l.items||e[2]!==l.type?(h=()=>{l?.type==="dropdown"&&l.items.length&&l.ChildComponent?f(()=>l.ChildComponent):f(void 0)},e[0]=l.ChildComponent,e[1]=l.items,e[2]=l.type,e[3]=h):h=e[3];let x;e[4]!==l?(x=[l],e[4]=l,e[5]=x):x=e[5],Ne.useEffect(h,x);let w;e[6]!==c||e[7]!==l.ChildComponent||e[8]!==l.items||e[9]!==l.type||e[10]!==i||e[11]!==u?(w=C=>{let{activeItems:g}=C;if(!g.length){l?.type==="dropdown"&&l.items.length&&l.ChildComponent?(f(()=>l.ChildComponent),m(void 0)):(f(void 0),m(void 0));return}let b=g[0],k=b.key;b.label&&(k=typeof b.label=="function"?b.label({featureClientSchemaMap:c,i18n:i,schemaPath:u}):b.label),k.length>25&&(k=k.substring(0,25)+"..."),g.length===1?(m(k),f(()=>b.ChildComponent)):(m(i.t("lexical:general:toolbarItemsActive",{count:g.length})),l?.type==="dropdown"&&l.items.length&&l.ChildComponent?f(()=>l.ChildComponent):f(void 0))},e[6]=c,e[7]=l.ChildComponent,e[8]=l.items,e[9]=l.type,e[10]=i,e[11]=u,e[12]=w):w=e[12];let E=w,N=`fixed-toolbar__group fixed-toolbar__group-${l.key}`,_;return e[13]!==p||e[14]!==o||e[15]!==a||e[16]!==r||e[17]!==n.features.toolbarFixed?.groups.length||e[18]!==l||e[19]!==s||e[20]!==E||e[21]!==N?(_=J1("div",{className:N,"data-toolbar-group-key":l.key,children:[l.type==="dropdown"&&l.items.length?p?se(Ue,{anchorElem:o,editor:r,group:l,Icon:p,itemsContainerClassNames:["fixed-toolbar__dropdown-items"],label:a,maxActiveItems:l.maxActiveItems??1,onActiveChange:E}):se(Ue,{anchorElem:o,editor:r,group:l,itemsContainerClassNames:["fixed-toolbar__dropdown-items"],label:a,maxActiveItems:l.maxActiveItems??1,onActiveChange:E}):null,l.type==="buttons"&&l.items.length?l.items.map(C=>se(Q1,{anchorElem:o,editor:r,item:C},C.key)):null,s<n.features.toolbarFixed?.groups.length-1&&se("div",{className:"divider"})]},l.key),e[13]=p,e[14]=o,e[15]=a,e[16]=r,e[17]=n.features.toolbarFixed?.groups.length,e[18]=l,e[19]=s,e[20]=E,e[21]=N,e[22]=_):_=e[22],_}function th({anchorElem:t,clientProps:e,editor:o,editorConfig:r,parentWithFixedToolbar:n}){let l=Ne.useRef(null),s=Hs(),{y:i}=X1(),d=q1(()=>{if(!n||e?.disableIfParentHasFixedToolbar)return null;let u=n.editorContainerRef.current.previousElementSibling;for(;u;){if(u.classList.contains("fixed-toolbar"))return u;u=u.previousElementSibling}return null},[e?.disableIfParentHasFixedToolbar,n]);return Z1(()=>{if(!d)return;let c=l.current;if(!c)return;let u=c.getBoundingClientRect(),a=d.getBoundingClientRect();if(!(u.bottom<a.top||u.top>a.bottom))c.classList.remove("fixed-toolbar"),c.classList.add("fixed-toolbar","fixed-toolbar--overlapping"),d.classList.remove("fixed-toolbar"),d.classList.add("fixed-toolbar","fixed-toolbar--hide");else{if(!c.classList.contains("fixed-toolbar--overlapping"))return;c.classList.remove("fixed-toolbar--overlapping"),c.classList.add("fixed-toolbar"),d.classList.remove("fixed-toolbar--hide"),d.classList.add("fixed-toolbar")}},50,[l,d,i]),se("div",{className:"fixed-toolbar",onFocus:c=>{c.stopPropagation()},ref:l,children:s&&se(Ne.Fragment,{children:r?.features&&r.features?.toolbarFixed?.groups.map((c,u)=>se(eh,{anchorElem:t,editor:o,editorConfig:r,group:c,index:u},c.key))})})}var Us=t=>{if(t.parentEditor?.editorConfig){if(t.parentEditor?.editorConfig.resolvedFeatureMap.has("toolbarFixed"))return t.parentEditor;if(t.parentEditor)return Us(t.parentEditor)}return!1},Ws=t=>{let e=js(6),{clientProps:o}=t,[r]=z1(),n=H();if(!Hs())return null;let{editorConfig:s}=n,i=o.applyToFocusedEditor&&n.focusedEditor?.editor||r,d=o.applyToFocusedEditor&&n.focusedEditor?.editorConfig||s,c,u;if(e[0]!==o.disableIfParentHasFixedToolbar||e[1]!==i||e[2]!==d||e[3]!==n){u=Symbol.for("react.early_return_sentinel");e:{let a=Us(n);if(o?.disableIfParentHasFixedToolbar&&a){u=null;break e}if(!d?.features?.toolbarFixed?.groups?.length){u=null;break e}c=se(th,{anchorElem:document.body,editor:i,editorConfig:d,parentWithFixedToolbar:a})}e[0]=o.disableIfParentHasFixedToolbar,e[1]=i,e[2]=d,e[3]=n,e[4]=c,e[5]=u}else c=e[4],u=e[5];return u!==Symbol.for("react.early_return_sentinel")?u:c};var oh=$({plugins:[{Component:Ws,position:"aboveContainer"}]});import{c as Ks}from"react/compiler-runtime";import{jsx as de,jsxs as Js}from"react/jsx-runtime";import{useLexicalComposerContext as rh}from"@lexical/react/LexicalComposerContext.js";import{useLexicalEditable as nh}from"@lexical/react/useLexicalEditable";import{mergeRegister as zs}from"@lexical/utils";import{$getSelection as Xs,$isRangeSelection as Gs,$isTextNode as lh,COMMAND_PRIORITY_LOW as ih,getDOMSelection as Zs,SELECTION_CHANGE_COMMAND as sh}from"lexical";import{useCallback as To,useEffect as Pt,useRef as Vs,useState as ah}from"react";import*as wo from"react";import{createPortal as ch}from"react-dom";function Ir(t,e){let o=t.getRangeAt(0),r;if(t.anchorNode===e){let n=e;for(;n.firstElementChild!=null;)n=n.firstElementChild;r=n.getBoundingClientRect()}else r=o.getBoundingClientRect();return r}function _o(t){let{alwaysDisplayOnTop:e=!1,anchorElem:o,anchorFlippedOffset:r=0,floatingElem:n,horizontalOffset:l=32,horizontalPosition:s="left",specialHandlingForCaret:i=!1,targetRect:d,verticalGap:c=10}=t,u=o.parentElement;if(d===null||u==null){n.style.opacity="0",n.style.transform="translate(-10000px, -10000px)";return}let a=n.getBoundingClientRect(),m=o.getBoundingClientRect(),p=u.getBoundingClientRect(),f=d.top-a.height-c,h=d.left-l;s==="center"&&(h=d.left+d.width/2-a.width/2);let x=0;return!e&&f<p.top&&!i&&(x=a.height+d.height+c*2,f+=x),s==="center"?h+a.width>p.right?h=p.right-a.width-l:h<p.left&&(h=p.left+l):h+a.width>p.right&&(h=p.right-a.width-l),h-=m.left,n.style.opacity="1",i&&r!==0?(f-=m.bottom-r+a.height-3,n.style.transform=`translate(${h}px, ${f}px) rotate(180deg)`):(f-=m.top,n.style.transform=`translate(${h}px, ${f}px)`),x}function uh({anchorElem:t,editor:e,item:o}){return o.Component?o?.Component&&de(o.Component,{anchorElem:t,editor:e,item:o},o.key):o.ChildComponent?de(Ft,{editor:e,item:o,children:de(o.ChildComponent,{})},o.key):null}function dh(t){let e=Ks(19),{anchorElem:o,editor:r,group:n,index:l}=t,{editorConfig:s}=H(),[i,d]=wo.useState(),c;e[0]!==n.ChildComponent||e[1]!==n.items||e[2]!==n.type?(c=()=>{n?.type==="dropdown"&&n.items.length&&n.ChildComponent?d(()=>n.ChildComponent):d(void 0)},e[0]=n.ChildComponent,e[1]=n.items,e[2]=n.type,e[3]=c):c=e[3];let u;e[4]!==n?(u=[n],e[4]=n,e[5]=u):u=e[5],wo.useEffect(c,u);let a;e[6]!==n.ChildComponent||e[7]!==n.items||e[8]!==n.type?(a=h=>{let{activeItems:x}=h;if(!x.length){n?.type==="dropdown"&&n.items.length&&n.ChildComponent?d(()=>n.ChildComponent):d(void 0);return}let w=x[0];d(()=>w?.ChildComponent)},e[6]=n.ChildComponent,e[7]=n.items,e[8]=n.type,e[9]=a):a=e[9];let m=a,p=`inline-toolbar-popup__group inline-toolbar-popup__group-${n.key}`,f;return e[10]!==i||e[11]!==o||e[12]!==r||e[13]!==s.features.toolbarInline?.groups.length||e[14]!==n||e[15]!==l||e[16]!==m||e[17]!==p?(f=Js("div",{className:p,"data-toolbar-group-key":n.key,children:[n.type==="dropdown"&&n.items.length?i?de(Ue,{anchorElem:o,editor:r,group:n,Icon:i,maxActiveItems:n.maxActiveItems??1,onActiveChange:m}):de(Ue,{anchorElem:o,editor:r,group:n,maxActiveItems:n.maxActiveItems??1,onActiveChange:m}):null,n.type==="buttons"&&n.items.length?n.items.map(h=>de(uh,{anchorElem:o,editor:r,item:h},h.key)):null,l<s.features.toolbarInline?.groups.length-1&&de("div",{className:"divider"})]},n.key),e[10]=i,e[11]=o,e[12]=r,e[13]=s.features.toolbarInline?.groups.length,e[14]=n,e[15]=l,e[16]=m,e[17]=p,e[18]=f):f=e[18],f}function mh({anchorElem:t,editor:e}){let o=Vs(null),r=Vs(null),{editorConfig:n}=H(),l=To(()=>{if(o?.current){let c=o.current.style.opacity==="0",u=o.current.style.pointerEvents==="none";c||(o.current.style.opacity="0"),u||(o.current.style.pointerEvents="none")}},[o]),s=To(c=>{if(o?.current&&(c.buttons===1||c.buttons===3)){let u=o.current.style.opacity==="0",a=o.current.style.pointerEvents==="none";if(!u||!a){let m=c.clientX,p=c.clientY,f=document.elementFromPoint(m,p);o.current.contains(f)||l()}}},[l]),i=To(()=>{o?.current&&(o.current.style.opacity!=="1"&&(o.current.style.opacity="1"),o.current.style.pointerEvents!=="auto"&&(o.current.style.pointerEvents="auto"))},[]);Pt(()=>(document.addEventListener("mousemove",s),document.addEventListener("mouseup",i),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i)}),[o,s,i]);let d=To(()=>{let c=Xs(),u=Zs(e._window);if(o.current===null)return;let a=t.querySelector(":scope > .link-editor"),m=a!==null&&"style"in a&&a?.style?.opacity==="1",p=e.getRootElement();if(c!==null&&u!==null&&!u.isCollapsed&&p!==null&&p.contains(u.anchorNode)){let f=Ir(u,p),h=_o({alwaysDisplayOnTop:m,anchorElem:t,floatingElem:o.current,horizontalPosition:"center",targetRect:f});r.current&&_o({anchorElem:o.current,anchorFlippedOffset:h,floatingElem:r.current,horizontalOffset:5,horizontalPosition:"center",specialHandlingForCaret:!0,targetRect:f,verticalGap:8})}else l()},[e,l,t]);return Pt(()=>{let c=t.parentElement,u=()=>{e.getEditorState().read(()=>{d()})};return window.addEventListener("resize",u),c&&c.addEventListener("scroll",u),()=>{window.removeEventListener("resize",u),c&&c.removeEventListener("scroll",u)}},[e,d,t]),Pt(()=>(e.getEditorState().read(()=>{d()}),zs(e.registerUpdateListener(({editorState:c})=>{c.read(()=>{d()})}),e.registerCommand(sh,()=>(d(),!1),ih))),[e,d]),Js("div",{className:"inline-toolbar-popup",ref:o,children:[de("div",{className:"caret",ref:r}),n?.features&&n.features?.toolbarInline?.groups.map((c,u)=>de(dh,{anchorElem:t,editor:e,group:c,index:u},c.key))]})}function ph(t,e){let o=Ks(12),[r,n]=ah(!1),l=nh(),s;o[0]!==t?(s=()=>{t.getEditorState().read(()=>{if(t.isComposing())return;let p=Xs(),f=Zs(t._window),h=t.getRootElement();if(f!==null&&(!Gs(p)||h===null||!h.contains(f.anchorNode))){n(!1);return}if(!Gs(p))return;if(p.getTextContent()!==""){let w=p.getNodes(),E=!1;for(let N of w)if(lh(N)){n(!0),E=!0;break}E||n(!1)}else n(!1);let x=p.getTextContent().replace(/\n/g,"");if(!p.isCollapsed()&&x===""){n(!1);return}})},o[0]=t,o[1]=s):s=o[1];let i=s,d,c;o[2]!==i?(d=()=>(document.addEventListener("selectionchange",i),document.addEventListener("mouseup",i),()=>{document.removeEventListener("selectionchange",i),document.removeEventListener("mouseup",i)}),c=[i],o[2]=i,o[3]=d,o[4]=c):(d=o[3],c=o[4]),Pt(d,c);let u,a;if(o[5]!==t||o[6]!==i?(u=()=>zs(t.registerUpdateListener(()=>{i()}),t.registerRootListener(()=>{t.getRootElement()===null&&n(!1)})),a=[t,i],o[5]=t,o[6]=i,o[7]=u,o[8]=a):(u=o[7],a=o[8]),Pt(u,a),!r||!l)return null;let m;return o[9]!==e||o[10]!==t?(m=ch(de(mh,{anchorElem:e,editor:t}),e),o[9]=e,o[10]=t,o[11]=m):m=o[11],m}var Ys=t=>{let{anchorElem:e}=t,[o]=rh();return ph(o,e)};var fh=$({plugins:[{Component:Ys,position:"floatingAnchorElem"}]});import{TableCellNode as rx,TableNode as nx,TableRowNode as lx}from"@lexical/table";import{jsx as qs}from"react/jsx-runtime";import"react";var vr=()=>qs("svg",{className:"icon",fill:"none",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:qs("path",{clipRule:"evenodd",d:"M5.33333 4.5C4.8731 4.5 4.5 4.8731 4.5 5.33333V7.5H9.5V4.5H5.33333ZM5.33333 3.5C4.32081 3.5 3.5 4.32081 3.5 5.33333V14.6667C3.5 15.6792 4.32081 16.5 5.33333 16.5H14.6667C15.6792 16.5 16.5 15.6792 16.5 14.6667V5.33333C16.5 4.32081 15.6792 3.5 14.6667 3.5H5.33333ZM10.5 4.5V7.5H15.5V5.33333C15.5 4.8731 15.1269 4.5 14.6667 4.5H10.5ZM15.5 8.5H10.5V11.5H15.5V8.5ZM15.5 12.5H10.5V15.5H14.6667C15.1269 15.5 15.5 15.1269 15.5 14.6667V12.5ZM9.5 15.5V12.5H4.5V14.6667C4.5 15.1269 4.8731 15.5 5.33333 15.5H9.5ZM4.5 11.5H9.5V8.5H4.5V11.5Z",fill:"currentColor",fillRule:"evenodd"})});import{$createTableCellNode as hh,$createTableNode as gh,$createTableRowNode as xh,$isTableCellNode as Qs,$isTableNode as Mr,$isTableRowNode as Dr,TableCellHeaderStates as Eo,TableCellNode as Ch,TableNode as bh,TableRowNode as kh}from"@lexical/table";import{$isParagraphNode as _h,$isTextNode as Th}from"lexical";var ta=/^\|(.+)\|\s?$/,wh=/^(\| ?:?-*:? ?)+\|\s?$/,oa=({allTransformers:t})=>({type:"element",dependencies:[bh,kh,Ch],export:e=>{if(!Mr(e))return null;let o=[];for(let r of e.getChildren()){let n=[];if(!Dr(r))continue;let l=!1;for(let s of r.getChildren())Qs(s)&&(n.push(zt(t,s).replace(/\n/g,"\\n").trim()),s.__headerState===Eo.ROW&&(l=!0));o.push(`| ${n.join(" | ")} |`),l&&o.push(`| ${n.map(s=>"---").join(" | ")} |`)}return o.join(`
`)},regExp:ta,replace:(e,o,r)=>{let n=r[0];if(!n)return;if(wh.test(n)){let a=e.getPreviousSibling();if(!a||!Mr(a))return;let m=a.getChildren(),p=m[m.length-1];if(!p||!Dr(p))return;p.getChildren().forEach(f=>{Qs(f)&&f.setHeaderStyles(Eo.ROW,Eo.ROW)}),e.remove();return}let l=ea(n,t);if(l==null)return;let s=[l],i=e.getPreviousSibling(),d=l.length;for(;i&&!(!_h(i)||i.getChildrenSize()!==1);){let a=i.getFirstChild();if(!Th(a))break;let m=ea(a.getTextContent(),t);if(m==null)break;d=Math.max(d,m.length),s.unshift(m);let p=i.getPreviousSibling();i.remove(),i=p}let c=gh();for(let a of s){let m=xh();c.append(m);for(let p=0;p<d;p++)m.append(p<a.length?a[p]:ra("",t))}let u=e.getPreviousSibling();Mr(u)&&Eh(u)===d?(u.append(...c.getChildren()),e.remove()):e.replace(c),c.selectEnd()}});function Eh(t){let e=t.getFirstChild();return Dr(e)?e.getChildrenSize():0}var ra=(t,e)=>{t=t.replace(/\\n/g,`
`);let o=hh(Eo.NO_STATUS);return Jt(t,e,o),o},ea=(t,e)=>{let o=t.match(ta);return!o||!o[1]?null:o[1].split("|").map(r=>ra(r,e))};import{c as Nh}from"react/compiler-runtime";import{jsx as P,jsxs as Le}from"react/jsx-runtime";import{useLexicalComposerContext as aa}from"@lexical/react/LexicalComposerContext";import{useLexicalEditable as Lh}from"@lexical/react/useLexicalEditable";import{$computeTableMapSkipCellCheck as la,$deleteTableColumnAtSelection as yh,$deleteTableRowAtSelection as Rh,$getNodeTriplet as Ih,$getTableCellNodeFromLexicalNode as ia,$getTableColumnIndexFromTableCellNode as vh,$getTableNodeFromLexicalNodeOrThrow as De,$getTableRowIndexFromTableCellNode as Mh,$insertTableColumnAtSelection as Dh,$insertTableRowAtSelection as $h,$isTableCellNode as ca,$isTableSelection as Bt,$mergeCells as Ah,$unmergeCell as Oh,getTableElement as Ar,getTableObserverFromTableElement as Or,TableCellHeaderStates as Me,TableCellNode as Fh}from"@lexical/table";import{mergeRegister as Ph}from"@lexical/utils";import{useScrollInfo as Bh}from"@payloadcms/ui";import{$getSelection as No,$isElementNode as jh,$isRangeSelection as Fr,$isTextNode as Hh,$setSelection as Uh,COMMAND_PRIORITY_CRITICAL as Wh,getDOMSelection as Gh,isDOMNode as Vh,SELECTION_CHANGE_COMMAND as Kh}from"lexical";import*as Pr from"react";import{useCallback as ae,useEffect as it,useRef as So,useState as st}from"react";import{createPortal as ua}from"react-dom";import{jsx as $r,jsxs as Sh}from"react/jsx-runtime";import"react";var na=()=>Sh("svg",{fill:"none",height:"18",viewBox:"0 0 20 20",width:"18",xmlns:"http://www.w3.org/2000/svg",children:[$r("path",{d:"M5 11C5.55228 11 6 10.5523 6 10C6 9.44772 5.55228 9 5 9C4.44772 9 4 9.44772 4 10C4 10.5523 4.44772 11 5 11Z",fill:"currentColor"}),$r("path",{d:"M10 11C10.5523 11 11 10.5523 11 10C11 9.44772 10.5523 9 10 9C9.44772 9 9 9.44772 9 10C9 10.5523 9.44772 11 10 11Z",fill:"currentColor"}),$r("path",{d:"M15 11C15.5523 11 16 10.5523 16 10C16 9.44772 15.5523 9 15 9C14.4477 9 14 9.44772 14 10C14 10.5523 14.4477 11 15 11Z",fill:"currentColor"})]});function sa(t){let e=t.getShape();return{columns:e.toX-e.fromX+1,rows:e.toY-e.fromY+1}}function Jh(){let t=No();if(Fr(t)&&!t.isCollapsed()||Bt(t)&&!t.anchor.is(t.focus)||!Fr(t)&&!Bt(t))return!1;let[e]=Ih(t.anchor);return e.__colSpan>1||e.__rowSpan>1}function zh(t){let e=t.getLastDescendant();Hh(e)?e.select():jh(e)?e.selectEnd():e!==null&&e.selectNext()}function Xh({cellMerge:t,contextRef:e,onClose:o,setIsMenuOpen:r,tableCellNode:n}){let[l]=aa(),s=So(null),[i,d]=st(n),[c,u]=st({columns:1,rows:1}),[a,m]=st(!1),[p,f]=st(!1),{y:h}=Bh();it(()=>l.registerMutationListener(Fh,T=>{T.get(i.getKey())==="updated"&&l.getEditorState().read(()=>{d(i.getLatest())})},{skipInitialization:!0}),[l,i]),it(()=>{l.getEditorState().read(()=>{let T=No();if(Bt(T)){let S=sa(T);u(sa(T)),m(S.columns>1||S.rows>1)}f(Jh())})},[l]),it(()=>{let T=e.current,S=s.current,I=l.getRootElement();if(T!=null&&S!=null&&I!=null){let A=I.getBoundingClientRect(),v=T.getBoundingClientRect();S.style.opacity="1";let O=S.getBoundingClientRect(),D=5,G=v.right+D;if(G+O.width>window.innerWidth||G+O.width>A.right){let z=v.left-O.width-D;G=(z<0?D:z)+window.pageXOffset}S.style.left=`${G+window.pageXOffset}px`;let q=v.top;if(q+O.height>window.innerHeight){let z=v.bottom-O.height;q=z<0?D:z}S.style.top=`${q}px`}},[e,s,l,h]),it(()=>{function T(S){s.current!=null&&e.current!=null&&Vh(S.target)&&!s.current.contains(S.target)&&!e.current.contains(S.target)&&r(!1)}return window.addEventListener("click",T),()=>window.removeEventListener("click",T)},[r,e]);let x=ae(()=>{l.update(()=>{if(i.isAttached()){let T=De(i),S=Ar(T,l.getElementByKey(T.getKey()));if(S===null)throw new Error("Expected to find tableElement in DOM");let I=Or(S);I!==null&&I.$clearHighlight(),T.markDirty(),d(i.getLatest())}Uh(null)})},[l,i]),w=()=>{l.update(()=>{let T=No();if(!Bt(T))return;let I=T.getNodes().filter(ca),A=Ah(I);A&&(zh(A),o())})},E=()=>{l.update(()=>{Oh()})},N=ae(T=>{l.update(()=>{for(let S=0;S<c.rows;S++)$h(T);o()})},[l,o,c.rows]),_=ae(T=>{l.update(()=>{for(let S=0;S<c.columns;S++)Dh(T);o()})},[l,o,c.columns]),C=ae(()=>{l.update(()=>{Rh(),o()})},[l,o]),g=ae(()=>{l.update(()=>{De(i).remove(),x(),o()})},[l,i,x,o]),b=ae(()=>{l.update(()=>{yh(),o()})},[l,o]),k=ae(()=>{l.update(()=>{let T=De(i),S=Mh(i),[I]=la(T,null,null),A=new Set,v=i.getHeaderStyles()^Me.ROW;if(I[S])for(let O=0;O<I[S].length;O++){let D=I[S][O];D?.cell&&(A.has(D.cell)||(A.add(D.cell),D.cell.setHeaderStyles(v,Me.ROW)))}x(),o()})},[l,i,x,o]),y=ae(()=>{l.update(()=>{let T=De(i),S=vh(i),[I]=la(T,null,null),A=new Set,v=i.getHeaderStyles()^Me.COLUMN;if(I)for(let O=0;O<I.length;O++){let D=I?.[O]?.[S];D?.cell&&(A.has(D.cell)||(A.add(D.cell),D.cell.setHeaderStyles(v,Me.COLUMN)))}x(),o()})},[l,i,x,o]),R=ae(()=>{l.update(()=>{if(i.isAttached()){let T=De(i);T&&T.setRowStriping(!T.getRowStriping())}x(),o()})},[l,i,x,o]),M=ae(()=>{l.update(()=>{if(i.isAttached()){let T=De(i);T&&T.setFrozenColumns(T.getFrozenColumns()===0?1:0)}x(),o()})},[l,i,x,o]),L=null;return t&&(a?L=P("button",{className:"item","data-test-id":"table-merge-cells",onClick:()=>w(),type:"button",children:P("span",{className:"text",children:"Merge cells"})}):p&&(L=P("button",{className:"item","data-test-id":"table-unmerge-cells",onClick:()=>E(),type:"button",children:P("span",{className:"text",children:"Unmerge cells"})}))),ua(Le("div",{className:"table-action-menu-dropdown",onClick:T=>{T.stopPropagation()},ref:s,children:[L?Le(Pr.Fragment,{children:[L,P("hr",{})]}):null,P("button",{className:"item","data-test-id":"table-row-striping",onClick:()=>R(),type:"button",children:P("span",{className:"text",children:"Toggle Row Striping"})}),P("button",{className:"item","data-test-id":"table-freeze-first-column",onClick:()=>M(),type:"button",children:P("span",{className:"text",children:"Toggle First Column Freeze"})}),P("button",{className:"item","data-test-id":"table-insert-row-above",onClick:()=>N(!1),type:"button",children:Le("span",{className:"text",children:["Insert ",c.rows===1?"row":`${c.rows} rows`," above"]})}),P("button",{className:"item","data-test-id":"table-insert-row-below",onClick:()=>N(!0),type:"button",children:Le("span",{className:"text",children:["Insert ",c.rows===1?"row":`${c.rows} rows`," below"]})}),P("hr",{}),P("button",{className:"item","data-test-id":"table-insert-column-before",onClick:()=>_(!1),type:"button",children:Le("span",{className:"text",children:["Insert ",c.columns===1?"column":`${c.columns} columns`," ","left"]})}),P("button",{className:"item","data-test-id":"table-insert-column-after",onClick:()=>_(!0),type:"button",children:Le("span",{className:"text",children:["Insert ",c.columns===1?"column":`${c.columns} columns`," ","right"]})}),P("hr",{}),P("button",{className:"item","data-test-id":"table-delete-columns",onClick:()=>b(),type:"button",children:P("span",{className:"text",children:"Delete column"})}),P("button",{className:"item","data-test-id":"table-delete-rows",onClick:()=>C(),type:"button",children:P("span",{className:"text",children:"Delete row"})}),P("button",{className:"item","data-test-id":"table-delete",onClick:()=>g(),type:"button",children:P("span",{className:"text",children:"Delete table"})}),P("hr",{}),P("button",{className:"item","data-test-id":"table-row-header",onClick:()=>k(),type:"button",children:Le("span",{className:"text",children:[(i.__headerState&Me.ROW)===Me.ROW?"Remove":"Add"," ","row header"]})}),P("button",{className:"item","data-test-id":"table-column-header",onClick:()=>y(),type:"button",children:Le("span",{className:"text",children:[(i.__headerState&Me.COLUMN)===Me.COLUMN?"Remove":"Add"," ","column header"]})})]}),document.body)}function Zh({anchorElem:t,cellMerge:e}){let[o]=aa(),r=So(null),n=So(null),[l,s]=st(!1),[i,d]=st(null),c=ae(()=>{let a=r.current,m=No(),p=Gh(o._window),f=document.activeElement;function h(){a&&(a.classList.remove("table-cell-action-button-container--active"),a.classList.add("table-cell-action-button-container--inactive")),d(null)}if(m==null||a==null)return h();let x=o.getRootElement(),w=null,E=null;if(Fr(m)&&x!==null&&p!==null&&x.contains(p.anchorNode)){let _=ia(m.anchor.getNode());if(_==null||(E=o.getElementByKey(_.getKey()),E==null||!_.isAttached()))return h();let C=De(_),g=Ar(C,o.getElementByKey(C.getKey()));if(g===null)throw new Error("TableActionMenu: Expected to find tableElement in DOM");w=Or(g),d(_)}else if(Bt(m)){let _=ia(m.anchor.getNode());if(!ca(_))throw new Error("TableSelection anchorNode must be a TableCellNode");let C=De(_),g=Ar(C,o.getElementByKey(C.getKey()));if(g===null)throw new Error("TableActionMenu: Expected to find tableElement in DOM");w=Or(g),E=o.getElementByKey(_.getKey())}else if(!f)return h();if(w===null||E===null)return h();let N=!w||!w.isSelecting;if(a.classList.toggle("table-cell-action-button-container--active",N),a.classList.toggle("table-cell-action-button-container--inactive",!N),N){let _=E.getBoundingClientRect(),C=t.getBoundingClientRect(),g=_.top-C.top,b=_.right-C.left;a.style.transform=`translate(${b}px, ${g}px)`}},[o,t]);it(()=>{let a,m=()=>{a=void 0,o.getEditorState().read(c)},p=()=>(a===void 0&&(a=setTimeout(m,0)),!1);return Ph(o.registerUpdateListener(p),o.registerCommand(Kh,p,Wh),o.registerRootListener((f,h)=>{h&&h.removeEventListener("pointerup",p),f&&(f.addEventListener("pointerup",p),p())}),()=>clearTimeout(a))});let u=So(i);return it(()=>{u.current!==i&&s(!1),u.current=i},[u,i]),P("div",{className:"table-cell-action-button-container",ref:r,children:i!=null&&Le(Pr.Fragment,{children:[P("button",{className:"table-cell-action-button",onClick:a=>{a.stopPropagation(),s(!l)},ref:n,type:"button",children:P(na,{})}),l&&P(Xh,{cellMerge:e,contextRef:n,onClose:()=>s(!1),setIsMenuOpen:s,tableCellNode:i})]})})}var da=t=>{let e=Nh(3),{anchorElem:o}=t,r=Lh(),n;return e[0]!==o||e[1]!==r?(n=ua(r?P(Zh,{anchorElem:o??document.body,cellMerge:!0}):null,o??document.body),e[0]=o,e[1]=r,e[2]=n):n=e[2],n};import{c as Yh}from"react/compiler-runtime";import{jsx as yo,jsxs as qh}from"react/jsx-runtime";import{useLexicalComposerContext as Qh}from"@lexical/react/LexicalComposerContext";import{useLexicalEditable as eg}from"@lexical/react/useLexicalEditable";import{$computeTableMapSkipCellCheck as tg,$getTableNodeFromLexicalNodeOrThrow as Br,$getTableRowIndexFromTableCellNode as og,$isTableCellNode as ma,$isTableRowNode as rg,getDOMCellFromTarget as ng,getTableElement as lg,TableNode as pa}from"@lexical/table";import{calculateZoomLevel as fa,mergeRegister as ig}from"@lexical/utils";import{$getNearestNodeFromDOMNode as jr,isHTMLElement as sg,SKIP_SCROLL_INTO_VIEW_TAG as ha}from"lexical";import*as xa from"react";import{useCallback as jt,useEffect as Hr,useRef as Lo,useState as at}from"react";import{createPortal as ag}from"react-dom";var cg=33,ga=92;function ug({editor:t}){let e=Lo(null),o=Lo(null),r=Lo(null),[n,l]=at(!1),s=H(),i=Lo(null),[d,c]=at(null),[u,a]=at(null),[m,p]=at(!1),[f,h]=at(null),x=jt(()=>{a(null),e.current=null,h(null),i.current=null,r.current=null},[]),w=M=>(M.buttons&1)===1;Hr(()=>{let M=new Set;return ig(t.registerMutationListener(pa,L=>{for(let[T,S]of L)S==="destroyed"?M.delete(T):M.add(T);l(M.size>0)}),t.registerNodeTransform(pa,L=>{if(L.getColWidths())return L;let T=L.getColumnCount(),S=ga;return L.setColWidths(Array(T).fill(S)),L}))},[t]),Hr(()=>{if(!n)return;let M=I=>{let A=I.target;if(sg(A)){if(f){c({x:I.clientX,y:I.clientY});return}if(p(w(I)),!(o.current&&o.current.contains(A))&&e.current!==A){e.current=A;let v=ng(A);v&&u!==v?t.getEditorState().read(()=>{let O=jr(v.elem);if(!O)throw new Error("TableCellResizer: Table cell node not found.");let D=Br(O),G=lg(D,t.getElementByKey(D.getKey()));if(!G)throw new Error("TableCellResizer: Table element not found.");e.current=A,r.current=G.getBoundingClientRect(),a(v)},{editor:t}):v==null&&x()}}},L=I=>{p(!0)},T=I=>{p(!1)},S=t.registerRootListener((I,A)=>{A?.removeEventListener("mousemove",M),A?.removeEventListener("mousedown",L),A?.removeEventListener("mouseup",T),I?.addEventListener("mousemove",M),I?.addEventListener("mousedown",L),I?.addEventListener("mouseup",T)});return()=>{S()}},[u,f,t,n,x]);let E=M=>M==="bottom",N=jt(M=>{if(!u)throw new Error("TableCellResizer: Expected active cell.");t.update(()=>{let L=jr(u.elem);if(!ma(L))throw new Error("TableCellResizer: Table cell node not found.");let T=Br(L),S=og(L),I=T.getChildren(),v=L.getColSpan()===T.getColumnCount()?S:S+L.getRowSpan()-1;if(v>=I.length||v<0)throw new Error("Expected table cell to be inside of table row.");let O=I[v];if(!rg(O))throw new Error("Expected table row");let D=O.getHeight();if(D===void 0){let q=O.getChildren();D=Math.min(...q.map(z=>_(z,t)??1/0))}let G=Math.max(D+M,cg);O.setHeight(G)},{tag:ha})},[u,t]),_=(M,L)=>L.getElementByKey(M.getKey())?.clientHeight,C=(M,L)=>{let T;return L.forEach(S=>{S.forEach((I,A)=>{I.cell===M&&(T=A)})}),T},g=jt(M=>{if(!u)throw new Error("TableCellResizer: Expected active cell.");t.update(()=>{let L=jr(u.elem);if(!ma(L))throw new Error("TableCellResizer: Table cell node not found.");let T=Br(L),[S]=tg(T,null,null),I=C(L,S);if(I===void 0)throw new Error("TableCellResizer: Table column not found.");let A=T.getColWidths();if(!A)return;let v=A[I];if(v===void 0)return;let O=[...A],D=Math.max(v+M,ga);O[I]=D,T.setColWidths(O)},{tag:ha})},[u,t]),b=jt(M=>{let L=T=>{if(T.preventDefault(),T.stopPropagation(),!u)throw new Error("TableCellResizer: Expected active cell.");if(i.current){let{x:S,y:I}=i.current;if(u===null)return;let A=fa(T.target);if(E(M)){let v=(T.clientY-I)/A;N(v)}else{let v=(T.clientX-S)/A;g(v)}x(),document.removeEventListener("mouseup",L)}};return L},[u,x,g,N]),k=jt(M=>L=>{if(L.preventDefault(),L.stopPropagation(),!u)throw new Error("TableCellResizer: Expected active cell.");i.current={x:L.clientX,y:L.clientY},c(i.current),h(M),document.addEventListener("mouseup",b(M))},[u,b]),[y,R]=at({bottom:null,left:null,right:null,top:null});return Hr(()=>{if(u){let{height:M,left:L,top:T,width:S}=u.elem.getBoundingClientRect(),I=fa(u.elem),A=10,v={bottom:{backgroundColor:"none",cursor:"row-resize",height:`${A}px`,left:`${window.scrollX+L}px`,top:`${window.scrollY+T+M-A/2}px`,width:`${S}px`},right:{backgroundColor:"none",cursor:"col-resize",height:`${M}px`,left:`${window.scrollX+L+S-A/2}px`,top:`${window.scrollY+T}px`,width:`${A}px`}},O=r.current;f&&d&&O&&(E(f)?(v[f].left=`${window.scrollX+O.left}px`,v[f].top=`${window.scrollY+d.y/I}px`,v[f].height="3px",v[f].width=`${O.width}px`):(v[f].top=`${window.scrollY+O.top}px`,v[f].left=`${window.scrollX+d.x/I}px`,v[f].width="3px",v[f].height=`${O.height}px`),v[f].backgroundColor="#adf"),R(v)}else R({bottom:null,left:null,right:null,top:null})},[u,f,d]),yo("div",{ref:o,children:u!=null&&!m&&qh(xa.Fragment,{children:[yo("div",{className:`${s.editorConfig.lexical.theme.tableCellResizer} TableCellResizer__ui`,onMouseDown:k("right"),style:y.right||void 0}),yo("div",{className:`${s.editorConfig.lexical.theme.tableCellResizer} TableCellResizer__ui`,onMouseDown:k("bottom"),style:y.bottom||void 0})]})})}var Ca=()=>{let t=Yh(3),[e]=Qh(),o=eg(),r;return t[0]!==e||t[1]!==o?(r=o?ag(yo(ug,{editor:e}),document.body):null,t[0]=e,t[1]=o,t[2]=r):r=t[2],r};import{c as Cg}from"react/compiler-runtime";import{jsx as Ur,jsxs as bg,Fragment as kg}from"react/jsx-runtime";import{useLexicalComposerContext as _g}from"@lexical/react/LexicalComposerContext";import{useLexicalEditable as Na}from"@lexical/react/useLexicalEditable";import{$getTableAndElementByKey as Tg,$getTableColumnIndexFromTableCellNode as wg,$getTableRowIndexFromTableCellNode as Eg,$insertTableColumnAtSelection as Sg,$insertTableRowAtSelection as Ng,$isTableCellNode as Lg,$isTableNode as _a,getTableElement as yg,TableNode as Rg}from"@lexical/table";import{$findMatchingParent as Ig,mergeRegister as vg}from"@lexical/utils";import{$getNearestNodeFromDOMNode as Ta,isHTMLElement as Mg}from"lexical";import{useEffect as wa,useMemo as Dg,useRef as Ea,useState as Ro}from"react";import"react";import{createPortal as $g}from"react-dom";import{c as hg}from"react/compiler-runtime";import{useEffect as gg,useRef as xg}from"react";var dg="Expected a function",mg=Math.max,pg=Math.min;function fg(t,e,o){let r,n,l=0,s,i=!1,d=!1,c,u,a,m=!0;if(typeof t!="function")throw new TypeError(dg);e=e||0,typeof o=="object"&&(i=!!o.leading,d="maxWait"in o,c=d?mg(o.maxWait||0,e):c,m="trailing"in o?!!o.trailing:m);function p(g){let b=r,k=s;return r=s=void 0,l=g,u=t.apply(k,b),u}function f(g){return l=g,a=setTimeout(w,e),i?p(g):u}function h(g){let b=g-n,k=g-l,y=e-b;return d?pg(y,c-k):y}function x(g){let b=g-n,k=g-l;return n===void 0||b>=e||b<0||d&&k>=c}function w(){let g=Date.now();if(x(g))return E(g);a=setTimeout(w,h(g))}function E(g){return a=void 0,m&&r?p(g):(r=s=void 0,u)}function N(){a!==void 0&&clearTimeout(a),l=0,r=n=s=a=void 0}function _(){return a===void 0?u:E(Date.now())}function C(){let g=Date.now(),b=x(g);if(r=arguments,s=this,n=g,b){if(a===void 0)return f(n);if(d)return clearTimeout(a),a=setTimeout(w,e),p(n)}return a===void 0&&(a=setTimeout(w,e)),u}return C.cancel=N,C.flush=_,C}var ba=fg;function ka(t,e,o){let r=hg(6),n=xg(null),l,s;r[0]!==t||r[1]!==o||r[2]!==e?(l=()=>(n.current=ba(t,e,{maxWait:o}),()=>{n.current?.cancel()}),s=[t,e,o],r[0]=t,r[1]=o,r[2]=e,r[3]=l,r[4]=s):(l=r[3],s=r[4]),gg(l,s);let i;return r[5]===Symbol.for("react.memo_cache_sentinel")?(i=(...c)=>{let u=c;n.current&&n.current(...u)},r[5]=i):i=r[5],i}var Sa=20;function Ag({anchorElem:t}){let[e]=_g(),o=Na(),r=H(),[n,l]=Ro(!1),[s,i]=Ro(!1),[d,c]=Ro(!1),[u,a]=Ro({}),m=Ea(new Set),p=Ea(null),f=ka(w=>{let{isOutside:E,tableDOMNode:N}=Og(w,r.editorConfig?.lexical);if(E){l(!1),i(!1);return}if(!N)return;p.current=N;let _=null,C=null,g=null;if(e.getEditorState().read(()=>{let v=Ta(N);if(Lg(v)){let O=Ig(v,D=>_a(D));if(!_a(O))return;if(g=yg(O,e.getElementByKey(O.getKey())),g){let D=O.getChildrenSize(),G=O.getChildAtIndex(0)?.getChildrenSize(),q=Eg(v),z=wg(v);q===D-1?_=v:z===G-1&&(C=v)}}},{editor:e}),!g)return;let b=g.parentElement;if(!b)return;let{bottom:k,height:y,left:R,right:M,width:L,y:T}=g.getBoundingClientRect(),S=!1;b&&b.classList.contains("LexicalEditorTheme__tableScrollableWrapper")&&(S=b.scrollWidth>b.clientWidth);let{left:I,y:A}=t.getBoundingClientRect();_?(i(!1),l(!0),a({height:Sa,left:S&&b?b.offsetLeft:R-I,top:k-A+5,width:S&&b?b.offsetWidth:L})):C&&(i(!0),l(!1),a({height:y,left:M-I+5,top:T-A,width:Sa}))},50,250),h=Dg(()=>new ResizeObserver(()=>{l(!1),i(!1)}),[]);wa(()=>{if(d)return document.addEventListener("mousemove",f),()=>{l(!1),i(!1),document.removeEventListener("mousemove",f)}},[d,f]),wa(()=>vg(e.registerMutationListener(Rg,w=>{e.getEditorState().read(()=>{let E=!1;for(let[N,_]of w)switch(_){case"created":{m.current.add(N),E=!0;break}case"destroyed":{m.current.delete(N),E=!0;break}default:break}if(E){h.disconnect();for(let N of m.current){let{tableElement:_}=Tg(N);h.observe(_)}c(m.current.size>0)}},{editor:e})},{skipInitialization:!1})),[e,h]);let x=w=>{e.update(()=>{p.current&&(Ta(p.current)?.selectEnd(),w?(Ng(),l(!1)):(Sg(),i(!1)))})};return o?bg(kg,{children:[n&&Ur("button",{"aria-label":"Add Row",className:r.editorConfig.lexical.theme.tableAddRows,onClick:()=>x(!0),style:{...u},type:"button"}),s&&Ur("button",{"aria-label":"Add Column",className:r.editorConfig.lexical.theme.tableAddColumns,onClick:()=>x(!1),style:{...u},type:"button"})]}):null}function Og(t,e){let o=t.target;if(Mg(o)){let r=o.closest(`td.${e.theme.tableCell}, th.${e.theme.tableCell}`);return{isOutside:!(r||o.closest(`button.${e.theme.tableAddRows}`)||o.closest(`button.${e.theme.tableAddColumns}`)||o.closest(`div.${e.theme.tableCellResizer}`)),tableDOMNode:r}}else return{isOutside:!0,tableDOMNode:null}}function La(t){let e=Cg(2),{anchorElem:o}=t,r=o===void 0?document.body:o;if(!Na())return null;let l;return e[0]!==r?(l=$g(Ur(Ag,{anchorElem:r}),r),e[0]=r,e[1]=l):l=e[1],l}import{c as Fg}from"react/compiler-runtime";import{jsx as Wr,jsxs as Pg}from"react/jsx-runtime";import{useLexicalComposerContext as Bg}from"@lexical/react/LexicalComposerContext";import{TablePlugin as jg}from"@lexical/react/LexicalTablePlugin";import{INSERT_TABLE_COMMAND as Hg,TableCellNode as Ug,TableNode as Wg,TableRowNode as Gg}from"@lexical/table";import{mergeRegister as Vg}from"@lexical/utils";import{formatDrawerSlug as Kg,useEditDepth as Jg}from"@payloadcms/ui";import{$getSelection as zg,$isRangeSelection as Xg,COMMAND_PRIORITY_EDITOR as Zg,createCommand as Yg}from"lexical";import{createContext as qg,use as Qg,useEffect as ex,useMemo as tx,useState as ox}from"react";import*as ya from"react";var Io=Yg("OPEN_EMBED_DRAWER_COMMAND"),Ra=qg({cellEditorConfig:null,cellEditorPlugins:null,set:()=>{}});function Ia({children:t}){let[e,o]=ox({cellEditorConfig:null,cellEditorPlugins:null});return Wr(Ra,{value:tx(()=>({cellEditorConfig:e.cellEditorConfig,cellEditorPlugins:e.cellEditorPlugins,set:(r,n)=>{o({cellEditorConfig:r,cellEditorPlugins:n})}}),[e.cellEditorConfig,e.cellEditorPlugins]),children:t})}var va=()=>{let t=Fg(16),[e]=Bg(),o=Qg(Ra),r=Jg(),{fieldProps:n,uuid:l}=H(),{schemaPath:s}=n,i="lexical-table-create-"+l,d;t[0]!==r||t[1]!==i?(d=Kg({slug:i,depth:r}),t[0]=r,t[1]=i,t[2]=d):d=t[2];let c=d,{toggleDrawer:u}=he(c,!0),a;t[3]!==e||t[4]!==u?(a=()=>{if(!e.hasNodes([Wg,Gg,Ug]))throw new Error("TablePlugin: TableNode, TableRowNode, or TableCellNode is not registered on editor");return Vg(e.registerCommand(Io,()=>{let h=null;return e.getEditorState().read(()=>{let x=zg();Xg(x)&&(h=x)}),h&&u(),!0},Zg))},t[3]=e,t[4]=u,t[5]=a):a=t[5];let m;t[6]!==o||t[7]!==e||t[8]!==u?(m=[o,e,u],t[6]=o,t[7]=e,t[8]=u,t[9]=m):m=t[9],ex(a,m);let p;t[10]!==e?(p=(h,x)=>{!x.columns||!x.rows||e.dispatchCommand(Hg,{columns:String(x.columns),rows:String(x.rows)})},t[10]=e,t[11]=p):p=t[11];let f;return t[12]!==c||t[13]!==s||t[14]!==p?(f=Pg(ya.Fragment,{children:[Wr(ft,{drawerSlug:c,drawerTitle:"Create Table",featureKey:"experimental_table",handleDrawerSubmit:p,schemaPath:s,schemaPathSuffix:"fields"}),Wr(jg,{hasCellBackgroundColor:!1,hasCellMerge:!0,hasHorizontalScroll:!0})]}),t[12]=c,t[13]=s,t[14]=p,t[15]=f):f=t[15],f};var ix=$({markdownTransformers:[oa],nodes:[nx,rx,lx],plugins:[{Component:va,position:"normal"},{Component:Ca,position:"normal"},{Component:da,position:"floatingAnchorElem"},{Component:La,position:"floatingAnchorElem"}],providers:[Ia],slashMenu:{groups:[Z([{Icon:vr,key:"table",keywords:["table"],label:"Table",onSelect:({editor:t})=>{t.dispatchCommand(Io,{})}}])]},toolbarFixed:{groups:[be([{ChildComponent:vr,key:"table",label:"Table",onSelect:({editor:t})=>{t.dispatchCommand(Io,{})}}])]}});import{$isNodeSelection as Ux}from"lexical";import{jsx as Gr,jsxs as sx}from"react/jsx-runtime";import"react";var Vr=()=>sx("svg",{"aria-hidden":"true",className:"icon",fill:"none",focusable:"false",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",children:[Gr("path",{d:"M14.6667 4H5.33333C4.59695 4 4 4.59695 4 5.33333V14.6667C4 15.403 4.59695 16 5.33333 16H14.6667C15.403 16 16 15.403 16 14.6667V5.33333C16 4.59695 15.403 4 14.6667 4Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),Gr("path",{d:"M7.99984 9.33366C8.73622 9.33366 9.33317 8.73671 9.33317 8.00033C9.33317 7.26395 8.73622 6.66699 7.99984 6.66699C7.26346 6.66699 6.6665 7.26395 6.6665 8.00033C6.6665 8.73671 7.26346 9.33366 7.99984 9.33366Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),Gr("path",{d:"M16 11.9995L13.9427 9.94214C13.6926 9.69218 13.3536 9.55176 13 9.55176C12.6464 9.55176 12.3074 9.69218 12.0573 9.94214L6 15.9995",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});import{jsx as Oa}from"react/jsx-runtime";import Fa from"bson-objectid";import{$applyNodeReplacement as px}from"lexical";import*as Pa from"react";import ax from"bson-objectid";function vo(t,e){if(t.hasAttribute("data-lexical-pending-upload-form-id")){let r=t.getAttribute("data-lexical-pending-upload-form-id");if(r!=null)return{node:e({data:{pending:{formID:r,src:t.getAttribute("src")||""}}})}}if(t.hasAttribute("data-lexical-upload-relation-to")&&t.hasAttribute("data-lexical-upload-id")){let r=t.getAttribute("data-lexical-upload-id"),n=t.getAttribute("data-lexical-upload-relation-to");if(r!=null&&n!=null)return{node:e({data:{fields:{},relationTo:n,value:r}})}}return{node:e({data:{pending:{formID:new ax.default().toHexString(),src:t.getAttribute("src")||""}}})}}import{DecoratorBlockNode as cx}from"@lexical/react/LexicalDecoratorBlockNode.js";import{addClassNamesToElement as ux}from"@lexical/utils";import Da from"bson-objectid";import{$applyNodeReplacement as dx}from"lexical";var Ht=class extends cx{__data;constructor({data:e,format:o,key:r}){super(o,r),this.__data=e}static clone(e){return new this({data:e.__data,format:e.__format,key:e.__key})}static getType(){return"upload"}static importDOM(){return{img:e=>({conversion:o=>vo(o,Ma),priority:0})}}static importJSON(e){e.version===1&&e?.value?.id&&(e.value=e.value.id),e.version===2&&!e?.id&&(e.id=new Da.default().toHexString(),e.version=3);let o={id:e.id,fields:e.fields,pending:e.pending,relationTo:e.relationTo,value:e.value},r=Ma({data:o});return r.setFormat(e.format),r}static isInline(){return!1}createDOM(e){let o=document.createElement("div");return ux(o,e?.theme?.upload),o}decorate(){return null}exportDOM(){let e=document.createElement("img"),o=this.__data;return o.pending?(e.setAttribute("data-lexical-pending-upload-form-id",String(o?.pending?.formID)),e.setAttribute("src",o?.pending?.src||"")):(e.setAttribute("data-lexical-upload-id",String(o?.value)),e.setAttribute("data-lexical-upload-relation-to",o?.relationTo)),{element:e}}exportJSON(){return{...super.exportJSON(),...this.getData(),type:"upload",version:3}}getData(){return this.getLatest().__data}setData(e){let o=this.getWritable();o.__data=e}updateDOM(){return!1}};function Ma({data:t}){return t?.id||(t.id=new Da.default().toHexString()),dx(new Ht({data:t}))}import{jsx as $a}from"react/jsx-runtime";import{ShimmerEffect as mx}from"@payloadcms/ui";var Aa=()=>$a("div",{className:"lexical-upload",children:$a(mx,{height:"95px",width:"203px"})});var fx=Pa.lazy(()=>import("./component-XIHC3W6W.js").then(t=>({default:t.UploadComponent}))),me=class extends Ht{static clone(e){return super.clone(e)}static getType(){return super.getType()}static importDOM(){return{img:e=>({conversion:o=>vo(o,pe),priority:0})}}static importJSON(e){e.version===1&&e?.value?.id&&(e.value=e.value.id),e.version===2&&!e?.id&&(e.id=new Fa.default().toHexString(),e.version=3);let o={id:e.id,fields:e.fields,pending:e.pending,relationTo:e.relationTo,value:e.value},r=pe({data:o});return r.setFormat(e.format),r}decorate(e,o){return this.__data.pending?Oa(Aa,{}):Oa(fx,{className:o?.theme?.upload??"LexicalEditorTheme__upload",data:this.__data,format:this.__format,nodeKey:this.getKey()})}exportJSON(){return super.exportJSON()}};function pe({data:t}){return t?.id||(t.id=new Fa.default().toHexString()),px(new me({data:t}))}function ct(t){return t instanceof me}import{c as Tx}from"react/compiler-runtime";import{jsx as wx}from"react/jsx-runtime";import{useLexicalComposerContext as Ex}from"@lexical/react/LexicalComposerContext.js";import{$dfsIterator as Xa,$insertNodeToNearestRoot as zr,mergeRegister as Sx}from"@lexical/utils";import{useBulkUpload as Nx,useEffectEvent as Lx,useModal as yx}from"@payloadcms/ui";import Xr from"bson-objectid";import{$createRangeSelection as Rx,$getPreviousSelection as Ga,$getSelection as Va,$isParagraphNode as Zr,$isRangeSelection as Ka,$setSelection as Ix,COMMAND_PRIORITY_EDITOR as vx,COMMAND_PRIORITY_LOW as Ja,createCommand as Mx,DROP_COMMAND as Dx,getDOMSelectionFromTarget as $x,isHTMLElement as za,PASTE_COMMAND as Ax}from"lexical";import{useEffect as Ox}from"react";import{c as Ba}from"react/compiler-runtime";import{jsx as Kr}from"react/jsx-runtime";import{useLexicalComposerContext as ja}from"@lexical/react/LexicalComposerContext.js";import{toast as hx}from"@payloadcms/ui";import{$getNodeByKey as gx,COMMAND_PRIORITY_EDITOR as Ha}from"lexical";import{useEffect as Ua,useState as xx}from"react";var Cx=({editor:t,relationTo:e,replaceNodeKey:o,value:r})=>{o?t.update(()=>{let n=gx(o);n&&n.replace(pe({data:{fields:null,relationTo:e,value:r}}))}):t.dispatchCommand(Jr,{fields:null,relationTo:e,value:r})},bx=t=>{let e=Ba(13),{enabledCollectionSlugs:o}=t,[r]=ja(),[n,l]=xx(null),s;e[0]!==o?(s={collectionSlugs:o,uploads:!0},e[0]=o,e[1]=s):s=e[1];let{closeListDrawer:i,ListDrawer:d,openListDrawer:c}=Ot(s),u,a;e[2]!==r||e[3]!==c?(u=()=>r.registerCommand(ze,h=>(l(h?.replace?h?.replace.nodeKey:null),c(),!0),Ha),a=[r,c],e[2]=r,e[3]=c,e[4]=u,e[5]=a):(u=e[4],a=e[5]),Ua(u,a);let m;e[6]!==i||e[7]!==r||e[8]!==n?(m=h=>{let{collectionSlug:x,doc:w}=h;i(),Cx({editor:r,relationTo:x,replaceNodeKey:n,value:w.id})},e[6]=i,e[7]=r,e[8]=n,e[9]=m):m=e[9];let p=m,f;return e[10]!==d||e[11]!==p?(f=Kr(d,{onSelect:p}),e[10]=d,e[11]=p,e[12]=f):f=e[12],f},kx=()=>{let t=Ba(3),[e]=ja(),o,r;return t[0]!==e?(o=()=>e.registerCommand(ze,_x,Ha),r=[e],t[0]=e,t[1]=o,t[2]=r):(o=t[1],r=t[2]),Ua(o,r),null},Wa=({enabledCollectionSlugs:t})=>t?.length?Kr(bx,{enabledCollectionSlugs:t}):Kr(kx,{});function _x(){return hx.error("No upload collections enabled"),!0}function Fx(t){let e=t.target;return!!(za(e)&&!e.closest("code, span.editor-image")&&za(e.parentElement)&&e.parentElement.closest("div.ContentEditable__root"))}function Px(t){let e,o=$x(t.target);if(document.caretRangeFromPoint)e=document.caretRangeFromPoint(t.clientX,t.clientY);else if(t.rangeParent&&o!==null)o.collapse(t.rangeParent,t.rangeOffset||0),e=o.getRangeAt(0);else throw Error("Cannot get the selection when dragging");return e}var Jr=Mx("INSERT_UPLOAD_COMMAND"),Za=t=>{let e=Tx(21),{clientProps:o}=t,[r]=Ex(),n=o?.disabledCollections,l=o?.enabledCollections,s;e[0]!==n||e[1]!==l?(s={collectionSlugsBlacklist:n,collectionSlugsWhitelist:l,uploads:!0},e[0]=n,e[1]=l,e[2]=s):s=e[2];let{enabledCollectionSlugs:i}=Co(s),{drawerSlug:d,setCollectionSlug:c,setInitialForms:u,setOnCancel:a,setOnSuccess:m,setSelectableCollections:p}=Nx(),{isModalOpen:f,openModal:h}=yx(),x;e[3]!==d||e[4]!==r||e[5]!==i||e[6]!==f||e[7]!==h||e[8]!==c||e[9]!==u||e[10]!==a||e[11]!==m||e[12]!==p?(x=C=>{let{files:g}=C;if(g?.length!==0&&(u(b=>[...b??[],...g.map(Bx)]),!f(d))){if(!i.length||!i[0])return;c(i[0]),p(i),a(()=>{r.update(jx)}),m(b=>{let k=new Map(b.map(Hx));r.update(()=>{for(let y of Xa()){let R=y.node;if(ct(R)){let M=R.getData();if(M?.pending){let L=k.get(M.pending?.formID);L&&R.replace(pe({data:{id:new Xr.default().toHexString(),fields:{},relationTo:L.collectionSlug,value:L.doc.id}}))}}}})}),h(d)}},e[3]=d,e[4]=r,e[5]=i,e[6]=f,e[7]=h,e[8]=c,e[9]=u,e[10]=a,e[11]=m,e[12]=p,e[13]=x):x=e[13];let w=Lx(x),E;e[14]!==r||e[15]!==w?(E=()=>{if(!r.hasNodes([me]))throw new Error("UploadPlugin: UploadNode not registered on editor");return Sx(r.registerNodeTransform(me,C=>{let g=C.getData();if(!g?.pending)return;(async function(){let y=null,R=g?.pending?.src,M=g?.pending?.formID;if(R?.startsWith("data:")){let L=R.match(/data:(image\/[a-zA-Z]+);base64,/),T=L?L[1]:"image/png",S=R.replace(/^data:image\/[a-zA-Z]+;base64,/,""),I=atob(S),A=new Array(I.length);for(let D=0;D<I.length;D++)A[D]=I.charCodeAt(D);let v=new Uint8Array(A);y={alt:void 0,file:new File([v],"pasted-image."+T?.split("/",2)[1],{type:T}),formID:M}}else if(R?.startsWith("http")||R?.startsWith("https")){let T=await(await fetch(R)).blob(),S=R.split("/").pop()||"pasted-image"+T.type.split("/",2)[1];y={alt:void 0,file:new File([T],S,{type:T.type}),formID:M}}y&&w({files:[y]})})()}),r.registerCommand(Jr,C=>(r.update(()=>{let g=Va()||Ga();if(Ka(g)){let b=pe({data:{id:C.id,fields:C.fields,relationTo:C.relationTo,value:C.value}}),{focus:k}=g,y=k.getNode();zr(b),Zr(y)&&!y.__first&&y.remove()}}),!0),vx),r.registerCommand(Ax,C=>{if(!(C instanceof ClipboardEvent))return!1;let g=C.clipboardData;if(!g?.types?.length||g?.types?.includes("text/html"))return!1;let b=[];return g?.files?.length&&Array.from(g.files).forEach(k=>{b.push({alt:"",file:k,formID:new Xr.default().toHexString()})}),b.length?(r.update(()=>{let k=Va()||Ga();if(Ka(k))for(let y of b){let R=pe({data:{pending:{formID:y.formID,src:URL.createObjectURL(y.file)}}}),{focus:M}=k,L=M.getNode();zr(R),Zr(L)&&!L.__first&&L.remove()}}),w({files:b}),!0):!1},Ja),r.registerCommand(Dx,C=>{if(!(C instanceof DragEvent))return!1;let g=C.dataTransfer;if(!g?.types?.length)return!1;let b=[];return g?.files?.length&&Array.from(g.files).forEach(k=>{b.push({alt:"",file:k,formID:new Xr.default().toHexString()})}),b.length?(C.preventDefault(),C.stopPropagation(),r.update(()=>{if(Fx(C)){let k=Px(C),y=Rx();k!=null&&y.applyDOMRange(k),Ix(y);for(let R of b){let M=pe({data:{pending:{formID:R.formID,src:URL.createObjectURL(R.file)}}}),{focus:L}=y,T=L.getNode();zr(M),Zr(T)&&!T.__first&&T.remove()}}}),w({files:b}),!0):!1},Ja))},e[14]=r,e[15]=w,e[16]=E):E=e[16];let N;e[17]!==r?(N=[r],e[17]=r,e[18]=N):N=e[18],Ox(E,N);let _;return e[19]!==i?(_=wx(Wa,{enabledCollectionSlugs:i}),e[19]=i,e[20]=_):_=e[20],_};function Bx(t){return{file:t.file,formID:t.formID}}function jx(){for(let t of Xa()){let e=t.node;ct(e)&&e.getData()?.pending&&e.remove()}}function Hx(t){return[t.formID,t]}var Wx=$({nodes:[me],plugins:[{Component:Za,position:"normal"}],slashMenu:{groups:[Z([{Icon:Vr,key:"upload",keywords:["upload","image","file","img","picture","photo","media"],label:({i18n:t})=>t.t("lexical:upload:label"),onSelect:({editor:t})=>{t.dispatchCommand(ze,{replace:!1})}}])]},toolbarFixed:{groups:[be([{ChildComponent:Vr,isActive:({selection:t})=>{if(!Ux(t)||!t.getNodes().length)return!1;let e=t.getNodes()[0];return ct(e)},key:"upload",label:({i18n:t})=>t.t("lexical:upload:label"),onSelect:({editor:t})=>{t.dispatchCommand(ze,{replace:!1})}}])]}});import{c as Vx}from"react/compiler-runtime";import{jsx as Qr}from"react/jsx-runtime";import{ShimmerEffect as Kx,useConfig as Jx}from"@payloadcms/ui";import{lazy as zx,Suspense as Xx,useEffect as Zx,useState as Yx}from"react";var Ya={block:"LexicalEditorTheme__block",blockCursor:"LexicalEditorTheme__blockCursor",characterLimit:"LexicalEditorTheme__characterLimit",code:"LexicalEditorTheme__code",inlineBlock:"LexicalEditorTheme__inlineBlock",heading:{h1:"LexicalEditorTheme__h1",h2:"LexicalEditorTheme__h2",h3:"LexicalEditorTheme__h3",h4:"LexicalEditorTheme__h4",h5:"LexicalEditorTheme__h5",h6:"LexicalEditorTheme__h6"},hr:"LexicalEditorTheme__hr",hrSelected:"LexicalEditorTheme__hrSelected",indent:"LexicalEditorTheme__indent",link:"LexicalEditorTheme__link",list:{checklist:"LexicalEditorTheme__checklist",listitem:"LexicalEditorTheme__listItem",listitemChecked:"LexicalEditorTheme__listItemChecked",listitemUnchecked:"LexicalEditorTheme__listItemUnchecked",nested:{listitem:"LexicalEditorTheme__nestedListItem"},olDepth:["LexicalEditorTheme__ol1","LexicalEditorTheme__ol2","LexicalEditorTheme__ol3","LexicalEditorTheme__ol4","LexicalEditorTheme__ol5"],ul:"LexicalEditorTheme__ul"},ltr:"LexicalEditorTheme__ltr",mark:"LexicalEditorTheme__mark",markOverlap:"LexicalEditorTheme__markOverlap",paragraph:"LexicalEditorTheme__paragraph",placeholder:"LexicalEditorTheme__placeholder",quote:"LexicalEditorTheme__quote",relationship:"LexicalEditorTheme__relationship",rtl:"LexicalEditorTheme__rtl",tab:"LexicalEditorTheme__tabNode",table:"LexicalEditorTheme__table",tableAddColumns:"LexicalEditorTheme__tableAddColumns",tableAddRows:"LexicalEditorTheme__tableAddRows",tableAlignment:{center:"LexicalEditorTheme__tableAlignmentCenter",right:"LexicalEditorTheme__tableAlignmentRight"},tableCell:"LexicalEditorTheme__tableCell",tableCellActionButton:"LexicalEditorTheme__tableCellActionButton",tableCellActionButtonContainer:"LexicalEditorTheme__tableCellActionButtonContainer",tableCellHeader:"LexicalEditorTheme__tableCellHeader",tableCellResizer:"LexicalEditorTheme__tableCellResizer",tableCellSelected:"LexicalEditorTheme__tableCellSelected",tableFrozenColumn:"LexicalEditorTheme__tableFrozenColumn",tableRowStriping:"LexicalEditorTheme__tableRowStriping",tableScrollableWrapper:"LexicalEditorTheme__tableScrollableWrapper",tableSelected:"LexicalEditorTheme__tableSelected",tableSelection:"LexicalEditorTheme__tableSelection",text:{bold:"LexicalEditorTheme__textBold",code:"LexicalEditorTheme__textCode",italic:"LexicalEditorTheme__textItalic",strikethrough:"LexicalEditorTheme__textStrikethrough",subscript:"LexicalEditorTheme__textSubscript",superscript:"LexicalEditorTheme__textSuperscript",underline:"LexicalEditorTheme__textUnderline",underlineStrikethrough:"LexicalEditorTheme__textUnderlineStrikethrough"},upload:"LexicalEditorTheme__upload"};var Yr={namespace:"lexical",theme:Ya};function qa({config:t,featureClientImportMap:e,featureClientSchemaMap:o,field:r,schemaPath:n,unSanitizedEditorConfig:l}){let s=new Map;for(let c of l.features){if(!c?.clientFeatureProps?.featureKey||c?.clientFeatureProps?.order===void 0||c?.clientFeatureProps?.order===null)throw new Error("A Feature you have installed does not return the client props as clientFeatureProps. Please make sure to always return those props, even if they are null, as other important props like order and featureKey are later on injected.");s.set(c.clientFeatureProps.featureKey,c)}l.features=l.features.sort((c,u)=>c.clientFeatureProps.order-u.clientFeatureProps.order);let i=new Map,d=0;for(let c of l.features){let u=typeof c.feature=="function"?c.feature({config:t,featureClientImportMap:e,featureClientSchemaMap:o,featureProviderMap:s,field:r,resolvedFeatures:i,schemaPath:n,unSanitizedEditorConfig:l}):c.feature;u.key=c.clientFeatureProps.featureKey,u.order=d,i.set(c.clientFeatureProps.featureKey,u),d++}return i}import{deepMerge as Gx}from"payload/shared";var Qa=t=>{let e={enabledFeatures:[],enabledFormats:[],markdownTransformers:[],nodes:[],plugins:[],providers:[],slashMenu:{dynamicGroups:[],groups:[]},toolbarFixed:{groups:[]},toolbarInline:{groups:[]}},o={};if(t.forEach(r=>{r.key==="toolbarFixed"&&r.sanitizedClientFeatureProps?.customGroups&&(o={...o,...r.sanitizedClientFeatureProps.customGroups})}),!t?.size)return e;t.forEach(r=>{if(r.providers?.length&&(e.providers=e.providers.concat(r.providers)),r.enableFormats?.length&&e.enabledFormats.push(...r.enableFormats),r.nodes?.length)for(let n of r.nodes)e.nodes.push(n);if(r.plugins?.length&&r.plugins.forEach((n,l)=>{e.plugins?.push({clientProps:r.sanitizedClientFeatureProps,Component:n.Component,key:r.key+l,position:n.position})}),r.toolbarInline?.groups?.length)for(let n of r.toolbarInline.groups){let l=e.toolbarInline.groups.find(s=>s.key===n.key);l?e.toolbarInline.groups=e.toolbarInline.groups.filter(s=>s.key!==n.key):l={...n,items:[]},n?.items?.length&&(l.items=l.items.concat(n.items)),e.toolbarInline?.groups.push(l)}if(r.toolbarFixed?.groups?.length)for(let n of r.toolbarFixed.groups){let l=e.toolbarFixed.groups.find(s=>s.key===n.key);l?e.toolbarFixed.groups=e.toolbarFixed.groups.filter(s=>s.key!==n.key):l={...n,items:[]},n?.items?.length&&(l.items=l.items.concat(n.items)),e.toolbarFixed?.groups.push(l)}if(r.slashMenu?.groups){r.slashMenu.dynamicGroups?.length&&(e.slashMenu.dynamicGroups=e.slashMenu.dynamicGroups.concat(r.slashMenu.dynamicGroups));for(let n of r.slashMenu.groups){let l=e.slashMenu.groups.find(s=>s.key===n.key);l?e.slashMenu.groups=e.slashMenu.groups.filter(s=>s.key!==n.key):l={...n,items:[]},n?.items?.length&&(l.items=l.items.concat(n.items)),e.slashMenu.groups.push(l)}}if(r.markdownTransformers?.length)for(let n of r.markdownTransformers)typeof n=="function"?e.markdownTransformers.push(n({allNodes:e.nodes,allTransformers:e.markdownTransformers})):e.markdownTransformers.push(n);e.enabledFeatures.push(r.key)}),Object.keys(o).length>0&&(e.toolbarFixed.groups=e.toolbarFixed.groups.map(r=>{let n=o[r.key];return n?Gx(r,n):r})),e.toolbarInline.groups.sort((r,n)=>r.order&&n.order?r.order-n.order:r.order?-1:n.order?1:0),e.toolbarFixed.groups.sort((r,n)=>r.order&&n.order?r.order-n.order:r.order?-1:n.order?1:0);for(let r of e.toolbarInline.groups)r.items.sort((n,l)=>n.order&&l.order?n.order-l.order:n.order?-1:l.order?1:0);for(let r of e.toolbarFixed.groups)r.items.sort((n,l)=>n.order&&l.order?n.order-l.order:n.order?-1:l.order?1:0);return e};function qr(t,e,o){return{admin:o,features:Qa(t),lexical:e,resolvedFeatureMap:t}}var qx=zx(()=>import("./Field-2A2VQXKP.js").then(t=>({default:t.RichText}))),Qx=t=>{let e=Vx(18),{admin:o,clientFeatures:r,featureClientImportMap:n,featureClientSchemaMap:l,field:s,lexicalEditorConfig:i,schemaPath:d}=t,c;e[0]!==o?(c=o===void 0?{}:o,e[0]=o,e[1]=c):c=e[1];let u=c,a;e[2]!==n?(a=n===void 0?{}:n,e[2]=n,e[3]=a):a=e[3];let m=a,p=i===void 0?Yr:i,{config:f}=Jx(),[h,x]=Yx(null),w,E;e[4]!==u||e[5]!==r||e[6]!==f||e[7]!==m||e[8]!==l||e[9]!==s||e[10]!==h||e[11]!==p||e[12]!==d?(w=()=>{if(h)return;let _=[];for(let g of Object.values(r))g.clientFeatureProvider&&_.push(g.clientFeatureProvider(g.clientFeatureProps));let C=qa({config:f,featureClientImportMap:m,featureClientSchemaMap:l,field:s,schemaPath:d??s.name,unSanitizedEditorConfig:{features:_,lexical:p}});x(qr(C,p,u))},E=[u,r,f,m,l,s,h,p,d],e[4]=u,e[5]=r,e[6]=f,e[7]=m,e[8]=l,e[9]=s,e[10]=h,e[11]=p,e[12]=d,e[13]=w,e[14]=E):(w=e[13],E=e[14]),Zx(w,E);let N;return e[15]!==h||e[16]!==t?(N=Qr(Xx,{fallback:Qr(Kx,{height:"35vh"}),children:h&&Qr(qx,{...t,editorConfig:h})}),e[15]=h,e[16]=t,e[17]=N):N=e[17],N};function eC(t){return t instanceof HTMLElement}function tC(...t){return t.filter(Boolean).join(" ")}var Mo=new WeakMap;function ec(t){let e=t.changedTouches[0];return e===void 0?null:[e.clientX,e.clientY]}function Do(t,e){let o=Mo.get(t);if(o===void 0){let r=new Set,n=s=>{o!==void 0&&(o.start=ec(s))},l=s=>{if(o===void 0)return;let{start:i}=o;if(i===null)return;let d=ec(s);for(let c of r)d!==null&&c([d[0]-i[0],d[1]-i[1]],s)};t.addEventListener("touchstart",n),t.addEventListener("touchend",l),o={handleTouchend:l,handleTouchstart:n,listeners:r,start:null},Mo.set(t,o)}return o.listeners.add(e),()=>{oC(t,e)}}function oC(t,e){let o=Mo.get(t);if(o===void 0)return;let{listeners:r}=o;r.delete(e),r.size===0&&(Mo.delete(t),t.removeEventListener("touchstart",o.handleTouchstart),t.removeEventListener("touchend",o.handleTouchend))}function rC(t,e){return Do(t,(o,r)=>{let[n,l]=o;n<0&&-n>Math.abs(l)&&e(n,r)})}function nC(t,e){return Do(t,(o,r)=>{let[n,l]=o;n>0&&n>Math.abs(l)&&e(n,r)})}function lC(t,e){return Do(t,(o,r)=>{let[n,l]=o;l<0&&-l>Math.abs(n)&&e(n,r)})}function iC(t,e){return Do(t,(o,r)=>{let[n,l]=o;l>0&&l>Math.abs(n)&&e(n,r)})}import{c as sC}from"react/compiler-runtime";import{jsx as aC}from"react/jsx-runtime";import"react";var cC=()=>{let t=sC(2),{EditButton:e}=ge(),o;return t[0]!==e?(o=e?aC(e,{}):null,t[0]=e,t[1]=o):o=t[1],o};import{c as uC}from"react/compiler-runtime";import{jsx as dC}from"react/jsx-runtime";import"react";var mC=()=>{let t=uC(2),{RemoveButton:e}=ge(),o;return t[0]!==e?(o=e?dC(e,{}):null,t[0]=e,t[1]=o):o=t[1],o};import{c as pC}from"react/compiler-runtime";import{jsx as fC}from"react/jsx-runtime";import"react";var hC=()=>{let t=pC(2),{Label:e}=ge(),o;return t[0]!==e?(o=e?fC(e,{}):null,t[0]=e,t[1]=o):o=t[1],o};import{c as gC}from"react/compiler-runtime";import{jsx as xC}from"react/jsx-runtime";import"react";var CC=t=>{let e=gC(3),{children:o}=t,{InlineBlockContainer:r}=ge(),n;return e[0]!==r||e[1]!==o?(n=r?xC(r,{children:o}):null,e[0]=r,e[1]=o,e[2]=n):n=e[2],n};import{jsx as bC}from"react/jsx-runtime";import"react";var kC=t=>{let{children:e,...o}=t,{BlockCollapsible:r}=Ce();return r?bC(r,{...o,children:e}):null};import{c as _C}from"react/compiler-runtime";import{jsx as TC}from"react/jsx-runtime";import"react";var wC=()=>{let t=_C(2),{EditButton:e}=Ce(),o;return t[0]!==e?(o=e?TC(e,{}):null,t[0]=e,t[1]=o):o=t[1],o};import{c as EC}from"react/compiler-runtime";import{jsx as SC}from"react/jsx-runtime";import"react";var NC=()=>{let t=EC(2),{RemoveButton:e}=Ce(),o;return t[0]!==e?(o=e?SC(e,{}):null,t[0]=e,t[1]=o):o=t[1],o};import{stringify as LC}from"qs-esm";var yC=({apiURL:t,depth:e,draft:o,locale:r})=>async({id:l,collectionSlug:s,select:i})=>{let d=LC({depth:e??0,draft:o??!1,locale:r,select:i},{addQueryPrefix:!0});return await fetch(`${t}/${s}/${l}${d}`,{credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"}).then(u=>u.json())};var tc={customEndRegex:{optional:!0,regExp:/[ \t]*```$/},customStartRegex:/^[ \t]*```(\w+)?/,doNotTrimChildren:!0,export:({fields:t})=>!t.code.includes(`
`)&&!t.language?.length?"```"+t.code+"```":"```"+(t.language||"")+(t.code?`
`+t.code:"")+"\n```",import:({children:t,closeMatch:e,openMatch:o})=>{let r=o?.[1];return t.startsWith(`
`)&&(t=t.slice(1)),t.endsWith(`
`)&&(t=t.slice(0,-1)),!!e&&!t.includes(`
`)&&o?.input?.trim()!=="```"+r?{code:r+(t?.length?t:""),language:""}:{code:t,language:r}}};import{jsx as RC}from"react/jsx-runtime";import{CodeField as IC,useFormFields as vC}from"@payloadcms/ui";import{useId as MC,useMemo as DC}from"react";var $o={abap:"ABAP",apex:"Apex",azcli:"Azure CLI",bat:"Batch",bicep:"Bicep",cameligo:"CameLIGO",clojure:"Clojure",coffee:"CoffeeScript",cpp:"C++",csharp:"C#",csp:"CSP",css:"CSS",cypher:"Cypher",dart:"Dart",dockerfile:"Dockerfile",ecl:"ECL",elixir:"Elixir",flow9:"Flow9",freemarker2:"FreeMarker 2",fsharp:"F#",go:"Go",graphql:"GraphQL",handlebars:"Handlebars",hcl:"HCL",html:"HTML",ini:"INI",java:"Java",javascript:"JavaScript",julia:"Julia",kotlin:"Kotlin",less:"Less",lexon:"Lexon",liquid:"Liquid",lua:"Lua",m3:"M3",markdown:"Markdown",mdx:"MDX",mips:"MIPS",msdax:"DAX",mysql:"MySQL","objective-c":"Objective-C",pascal:"Pascal",pascaligo:"PascaLIGO",perl:"Perl",pgsql:"PostgreSQL",php:"PHP",pla:"PLA",plaintext:"Plain Text",postiats:"Postiats",powerquery:"Power Query",powershell:"PowerShell",protobuf:"Protobuf",pug:"Pug",python:"Python",qsharp:"Q#",r:"R",razor:"Razor",redis:"Redis",redshift:"Amazon Redshift",restructuredtext:"reStructuredText",ruby:"Ruby",rust:"Rust",sb:"Small Basic",scala:"Scala",scheme:"Scheme",scss:"SCSS",shell:"Shell",solidity:"Solidity",sophia:"Sophia",sparql:"SPARQL",sql:"SQL",st:"Structured Text",swift:"Swift",systemverilog:"SystemVerilog",tcl:"Tcl",twig:"Twig",typescript:"TypeScript",typespec:"TypeSpec",vb:"Visual Basic",wgsl:"WGSL",xml:"XML",yaml:"YAML"};var $C=({autoComplete:t,field:e,forceRender:o,languages:r=$o,path:n,permissions:l,readOnly:s,renderedBlocks:i,schemaPath:d,typescript:c,validate:u})=>{let a=vC(([w])=>w.language),m=a?.value||a?.initialValue||"typescript",p=MC(),f=r[m],h=DC(()=>({...e,type:"code",admin:{...e.admin,editorOptions:{},editorProps:{defaultPath:m==="ts"?`file-${e.name}-${p}.tsx`:void 0},language:m}}),[e,m,p]),x=`${e.name}-${m}-${f}`;return h&&RC(IC,{autoComplete:t,field:h,forceRender:o,onMount:(w,E)=>{E.editor.defineTheme("vs-dark",{base:"vs-dark",colors:{"editor.background":"#222222"},inherit:!0,rules:[]}),E.editor.defineTheme("vs",{base:"vs",colors:{"editor.background":"#f5f5f5"},inherit:!0,rules:[]}),E.languages.typescript.typescriptDefaults.setCompilerOptions({allowNonTsExtensions:!0,allowJs:!0,allowSyntheticDefaultImports:!0,esModuleInterop:!0,jsx:E.languages.typescript.JsxEmit.React,moduleResolution:E.languages.typescript.ModuleResolutionKind.NodeJs,noEmit:!0,paths:c?.paths,reactNamespace:"React",target:E.languages.typescript.ScriptTarget[c?.target??"ESNext"],typeRoots:c?.typeRoots??["node_modules/@types"]}),E.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!c?.enableSemanticValidation,noSyntaxValidation:!1}),(async()=>{c?.fetchTypes&&Array.isArray(c.fetchTypes)&&c.fetchTypes.length>0&&await Promise.all(c.fetchTypes.map(async _=>{let g=await(await fetch(_.url)).text();E.languages.typescript.typescriptDefaults.addExtraLib(g,_.filePath)}))})()},path:n,permissions:l,readOnly:s,renderedBlocks:i,schemaPath:d,validate:u},x)};import{jsx as re,jsxs as cc}from"react/jsx-runtime";import{useLexicalEditable as HC}from"@lexical/react/useLexicalEditable";import{ChevronIcon as UC,Combobox as WC,CopyToClipboard as GC,PopupList as VC,RenderFields as KC,useForm as JC,useFormFields as uc,useTranslation as zC}from"@payloadcms/ui";import XC from"react";import{jsx as oc}from"react/jsx-runtime";import"react";var rc=()=>oc("svg",{fill:"none",height:"12",viewBox:"0 0 15 12",width:"15",xmlns:"http://www.w3.org/2000/svg",children:oc("path",{d:"M11.3738 8.62598L14.0404 5.95931L11.3738 3.29264M3.37376 3.29264L0.707092 5.95931L3.37376 8.62598M9.04043 0.625977L5.70709 11.2926",stroke:"currentColor",strokeLinecap:"square"})});import{jsx as lc}from"react/jsx-runtime";import"react";import{useCollapsible as OC}from"@payloadcms/ui";import{jsx as nc}from"react/jsx-runtime";import"react";var Ao=()=>nc("svg",{fill:"none",height:"15",viewBox:"0 0 15 15",width:"15",xmlns:"http://www.w3.org/2000/svg",children:nc("path",{d:"M7.16667 13.8333V9.83333M7.16667 9.83333L9.16667 11.8333M7.16667 9.83333L5.16667 11.8333M7.16667 4.5V0.5M7.16667 4.5L9.16667 2.5M7.16667 4.5L5.16667 2.5M1.83333 7.16667H0.5M5.83333 7.16667H4.5M9.83333 7.16667H8.5M13.8333 7.16667H12.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})});var AC="code-block-collapse-button",ic=()=>{let{toggle:t}=OC();return lc("button",{className:AC,onClick:t,type:"button",children:lc(Ao,{})})};import{jsx as sc,jsxs as FC}from"react/jsx-runtime";import"react";import{useCollapsible as BC,useTranslation as jC}from"@payloadcms/ui";var PC="code-block-floating-collapse-button",ac=()=>{let{isCollapsed:t,toggle:e}=BC(),{t:o}=jC();return t?FC("button",{className:PC,onClick:e,type:"button",children:[sc("span",{children:o("general:collapse")}),sc(Ao,{})]}):null};var We="payload-richtext-code-block",ZC=t=>{let{languages:e}=t,o=e||$o,{BlockCollapsible:r,formSchema:n,RemoveButton:l}=Ce(),{setModified:s}=JC(),{t:i}=zC(),{codeField:d}=uc(([f])=>({codeField:f?.code})),{selectedLanguageField:c,setSelectedLanguage:u}=uc(([f,h])=>({selectedLanguageField:f?.language,setSelectedLanguage:x=>{h({type:"UPDATE",path:"language",value:x}),s(!0)}})),a=o[c?.value],m=HC(),p=XC.useMemo(()=>Object.entries(o).map(([f,h])=>({name:`${f} ${h}`,Component:re(VC.Button,{active:!1,disabled:!1,onClick:()=>{u(f)},children:re("span",{className:`${We}__language-code`,"data-language":f,children:h})})})),[o,u]);return re(r,{Actions:cc("div",{className:`${We}__actions`,children:[re(WC,{button:cc("div",{className:`${We}__language-selector-button`,"data-selected-language":c?.value,children:[re("span",{children:a}),re(UC,{className:`${We}__chevron`})]}),buttonType:"custom",className:`${We}__language-selector`,disabled:!m,entries:p,horizontalAlign:"right",minEntriesForSearch:8,searchPlaceholder:i("fields:searchForLanguage"),showScrollbar:!0,size:"large"}),re(GC,{value:d?.value??""}),re(ic,{}),m&&re(l,{})]}),className:We,collapsibleProps:{AfterCollapsible:re(ac,{}),disableHeaderToggle:!0,disableToggleIndicator:!0},Pill:re("div",{className:`${We}__pill`,children:re(rc,{})}),children:re(KC,{fields:n,forceRender:!0,parentIndexPath:"",parentPath:"",parentSchemaPath:"",permissions:!0,readOnly:!m})})};import{c as YC}from"react/compiler-runtime";import{jsx as ut}from"react/jsx-runtime";import{FieldContext as qC,FieldPathContext as dc,ServerFunctionsContext as mc,ShimmerEffect as QC,useServerFunctions as e2}from"@payloadcms/ui";import t2,{useEffect as o2,useRef as r2}from"react";var n2=t=>{let e=YC(9),{field:o,initialValue:r,Loading:n,path:l,schemaPath:s,setValue:i,value:d}=t,[c,u]=t2.useState(null),a=e2(),{_internal_renderField:m}=a,[p,f]=s.split(".",2),h=l??(o&&"name"in o?o?.name:"")??"",x;e[0]!==m||e[1]!==o||e[2]!==r||e[3]!==l||e[4]!==s?(x=()=>{(async function(){let{Field:y}=await m({field:{...o||{},type:"richText",admin:{...o?.admin||{},hidden:!1}},initialValue:r??void 0,path:l,schemaPath:s});u(y)})()},e[0]=m,e[1]=o,e[2]=r,e[3]=l,e[4]=s,e[5]=x):x=e[5];let w=x,E=r2(!1),N,_;if(e[6]!==w?(N=()=>{E.current||(E.current=!0,w())},_=[w],e[6]=w,e[7]=N,e[8]=_):(N=e[7],_=e[8]),o2(N,_),!c)return typeof n<"u"?n:ut(QC,{});let C={...a,getFormState:async b=>a.getFormState({...b,collectionSlug:p==="collection"?f:void 0,globalSlug:p==="global"?f:void 0})};if(typeof d>"u"&&!i)return ut(mc,{value:{...C},children:ut(dc,{value:h,children:c},h)});let g={disabled:!1,formInitializing:!1,formProcessing:!1,formSubmitted:!1,initialValue:d,path:h,setValue:i??l2,showError:!1,value:d};return ut(mc,{value:{...C},children:ut(dc,{value:h,children:ut(qC,{value:g,children:c})},h)})};function l2(){}function pc({nodes:t,text:e}){let o={root:{type:"root",children:[],direction:"ltr",format:"",indent:0,version:1}};return e&&o.root.children.push({type:"paragraph",children:[{type:"text",detail:0,format:0,mode:"normal",style:"",text:e,version:1}],direction:"ltr",format:"",indent:0,textFormat:0,textStyle:"",version:1}),t?.length&&o.root.children.push(...t),o}var i2=pc;export{Nt as $createAutoLinkNode,Ae as $createBlockNode,Ye as $createHorizontalRuleNode,mt as $createInlineBlockNode,_e as $createLinkNode,He as $createRelationshipNode,pe as $createUploadNode,we as $isAutoLinkNode,$e as $isBlockNode,St as $isHorizontalRuleNode,pt as $isInlineBlockNode,J as $isLinkNode,Er as $isRelationshipNode,ct as $isUploadNode,Ac as AlignFeatureClient,Te as AutoLinkNode,kC as BlockCollapsible,wC as BlockEditButton,ie as BlockNode,NC as BlockRemoveButton,Uc as BlockquoteFeatureClient,qu as BlocksFeatureClient,_d as BoldFeatureClient,le as CAN_USE_DOM,Lf as ChecklistFeatureClient,ZC as CodeBlockBlockComponent,$C as CodeComponent,b0 as DETAIL_TYPE_TO_DETAIL,h0 as DOUBLE_LINE_BREAK,I0 as DebugJsxConverterFeatureClient,_0 as ELEMENT_FORMAT_TO_TYPE,k0 as ELEMENT_TYPE_TO_FORMAT,kc as ENABLE_SLASH_MENU_COMMAND,gc as EditorConfigProvider,ft as FieldsDrawer,oh as FixedToolbarFeatureClient,gm as HeadingFeatureClient,$m as HorizontalRuleFeatureClient,ke as HorizontalRuleNode,Xe as INSERT_BLOCK_COMMAND,Ze as INSERT_INLINE_BLOCK_COMMAND,p0 as IS_ALL_FORMATTING,Zm as IndentFeatureClient,CC as InlineBlockContainer,cC as InlineBlockEditButton,hC as InlineBlockLabel,dt as InlineBlockNode,mC as InlineBlockRemoveButton,Nd as InlineCodeFeatureClient,fh as InlineToolbarFeatureClient,Id as ItalicFeatureClient,x0 as LTR_REGEX,Zf as LexicalPluginToLexicalFeatureClient,mf as LinkFeatureClient,oe as LinkNode,f0 as NON_BREAKING_SPACE,F as NodeFormat,Af as OrderedListFeatureClient,l0 as ParagraphFeatureClient,Cc as Point,g0 as RTL_REGEX,_c as Rect,k1 as RelationshipFeatureClient,Se as RelationshipNode,n2 as RenderLexical,Qx as RichTextField,r0 as SlateToLexicalFeatureClient,Ad as StrikethroughFeatureClient,Bd as SubscriptFeatureClient,Wd as SuperscriptFeatureClient,T0 as TEXT_MODE_TO_TYPE,C0 as TEXT_TYPE_TO_FORMAT,w0 as TEXT_TYPE_TO_MODE,ue as TOGGLE_LINK_COMMAND,ix as TableFeatureClient,md as TestRecorderFeatureClient,lm as TextStateFeatureClient,Ft as ToolbarButton,Ue as ToolbarDropdown,xd as TreeViewFeatureClient,zd as UnderlineFeatureClient,Wf as UnorderedListFeatureClient,Wx as UploadFeatureClient,me as UploadNode,iC as addSwipeDownListener,rC as addSwipeLeftListener,nC as addSwipeRightListener,lC as addSwipeUpListener,i2 as buildDefaultEditorState,pc as buildEditorState,tc as codeConverterClient,or as createBlockNode,$ as createClientFeature,v0 as defaultColors,Yr as defaultEditorLexicalConfig,Ir as getDOMRangeRect,Tc as getEnabledNodes,yC as getRestPopulateFn,qe as getSelectedNode,eC as isHTMLElement,bc as isPoint,tC as joinClasses,qr as sanitizeClientEditorConfig,Qa as sanitizeClientFeatures,_o as setFloatingElemPosition,fo as setFloatingElemPositionForLinkEditor,Z as slashMenuBasicGroupWithItems,be as toolbarAddDropdownGroupWithItems,nr as toolbarFeatureButtonsGroupWithItems,Y as toolbarFormatGroupWithItems,te as toolbarTextDropdownGroupWithItems,Ce as useBlockComponentContext,H as useEditorConfigContext,ge as useInlineBlockComponentContext,xc as useLexicalDocumentDrawer,he as useLexicalDrawer,Ot as useLexicalListDrawer};
//# sourceMappingURL=index.js.map

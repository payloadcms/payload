{"version":3,"sources":["../../../src/components/AssignTenantFieldModal/index.client.tsx"],"sourcesContent":["'use client'\n\nimport type { ClientCollectionConfig } from 'payload'\n\nimport { getTranslation } from '@payloadcms/translations'\nimport {\n  Button,\n  Modal,\n  Pill,\n  PopupList,\n  useConfig,\n  useDocumentInfo,\n  useDocumentTitle,\n  useModal,\n  useTranslation,\n} from '@payloadcms/ui'\nimport { drawerZBase, useDrawerDepth } from '@payloadcms/ui/elements/Drawer'\nimport React from 'react'\n\nimport type {\n  PluginMultiTenantTranslationKeys,\n  PluginMultiTenantTranslations,\n} from '../../translations/index.js'\n\nimport { useTenantSelection } from '../../providers/TenantSelectionProvider/index.client.js'\nimport './index.scss'\n\nexport const assignTenantModalSlug = 'assign-tenant-field-modal'\nconst baseClass = 'assign-tenant-field-modal'\n\nexport const AssignTenantFieldTrigger: React.FC = () => {\n  const { openModal } = useModal()\n  const { t } = useTranslation<PluginMultiTenantTranslations, PluginMultiTenantTranslationKeys>()\n  const { options } = useTenantSelection()\n\n  if (options.length <= 1) {\n    return null\n  }\n\n  return (\n    <>\n      <PopupList.Button onClick={() => openModal(assignTenantModalSlug)}>\n        {t('plugin-multi-tenant:assign-tenant-button-label')}\n      </PopupList.Button>\n    </>\n  )\n}\n\nexport const AssignTenantFieldModal: React.FC<{\n  afterModalClose: () => void\n  afterModalOpen: () => void\n  children: React.ReactNode\n  onCancel?: () => void\n  onConfirm?: () => void\n}> = ({ afterModalClose, afterModalOpen, children, onCancel, onConfirm }) => {\n  const editDepth = useDrawerDepth()\n  const { i18n, t } = useTranslation<\n    PluginMultiTenantTranslations,\n    PluginMultiTenantTranslationKeys\n  >()\n  const { collectionSlug } = useDocumentInfo()\n  const { title } = useDocumentTitle()\n  const { getEntityConfig } = useConfig()\n  const collectionConfig = getEntityConfig({ collectionSlug }) as ClientCollectionConfig\n  const { closeModal, isModalOpen: isModalOpenFn } = useModal()\n  const isModalOpen = isModalOpenFn(assignTenantModalSlug)\n  const wasModalOpenRef = React.useRef<boolean>(isModalOpen)\n\n  const onModalConfirm = React.useCallback(() => {\n    if (typeof onConfirm === 'function') {\n      onConfirm()\n    }\n    closeModal(assignTenantModalSlug)\n  }, [onConfirm, closeModal])\n\n  const onModalCancel = React.useCallback(() => {\n    if (typeof onCancel === 'function') {\n      onCancel()\n    }\n    closeModal(assignTenantModalSlug)\n  }, [onCancel, closeModal])\n\n  React.useEffect(() => {\n    if (wasModalOpenRef.current && !isModalOpen) {\n      // modal was open, and now is closed\n      if (typeof afterModalClose === 'function') {\n        afterModalClose()\n      }\n    }\n\n    if (!wasModalOpenRef.current && isModalOpen) {\n      // modal was closed, and now is open\n      if (typeof afterModalOpen === 'function') {\n        afterModalOpen()\n      }\n    }\n    wasModalOpenRef.current = isModalOpen\n  }, [isModalOpen, onCancel, afterModalClose, afterModalOpen])\n\n  if (!collectionConfig) {\n    return null\n  }\n\n  return (\n    <Modal\n      className={baseClass}\n      slug={assignTenantModalSlug}\n      style={{\n        zIndex: drawerZBase + editDepth,\n      }}\n    >\n      <div className={`${baseClass}__bg`} />\n      <div className={`${baseClass}__wrapper`}>\n        <div className={`${baseClass}__header`}>\n          <h3>\n            {t('plugin-multi-tenant:assign-tenant-modal-title', {\n              title,\n            })}\n          </h3>\n          <Pill className={`${baseClass}__collection-pill`} size=\"small\">\n            {getTranslation(collectionConfig.labels.singular, i18n)}\n          </Pill>\n        </div>\n        <div className={`${baseClass}__content`}>{children}</div>\n        <div className={`${baseClass}__actions`}>\n          <Button buttonStyle=\"secondary\" margin={false} onClick={onModalCancel}>\n            {t('general:cancel')}\n          </Button>\n          <Button margin={false} onClick={onModalConfirm}>\n            {t('general:confirm')}\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  )\n}\n"],"names":["getTranslation","Button","Modal","Pill","PopupList","useConfig","useDocumentInfo","useDocumentTitle","useModal","useTranslation","drawerZBase","useDrawerDepth","React","useTenantSelection","assignTenantModalSlug","baseClass","AssignTenantFieldTrigger","openModal","t","options","length","onClick","AssignTenantFieldModal","afterModalClose","afterModalOpen","children","onCancel","onConfirm","editDepth","i18n","collectionSlug","title","getEntityConfig","collectionConfig","closeModal","isModalOpen","isModalOpenFn","wasModalOpenRef","useRef","onModalConfirm","useCallback","onModalCancel","useEffect","current","className","slug","style","zIndex","div","h3","size","labels","singular","buttonStyle","margin"],"mappings":"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"}
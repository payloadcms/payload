{"version":3,"sources":["../src/types.ts"],"sourcesContent":["import type { AcceptedLanguages } from '@payloadcms/translations'\nimport type {\n  AccessArgs,\n  AccessResult,\n  ArrayField,\n  CollectionConfig,\n  CollectionSlug,\n  Field,\n  RelationshipField,\n  SingleRelationshipField,\n  TypedUser,\n} from 'payload'\n\nexport type MultiTenantPluginConfig<ConfigTypes = unknown> = {\n  /**\n   * Base path for your application\n   *\n   * https://nextjs.org/docs/app/api-reference/config/next-config-js/basePath\n   *\n   * @default undefined\n   */\n  basePath?: string\n  /**\n   * After a tenant is deleted, the plugin will attempt to clean up related documents\n   * - removing documents with the tenant ID\n   * - removing the tenant from users\n   *\n   * @default true\n   */\n  cleanupAfterTenantDelete?: boolean\n  /**\n   * Automatically\n   */\n  collections: {\n    [key in CollectionSlug]?: {\n      /**\n       * Override the access result from the collection access control functions\n       *\n       * The function receives:\n       *  - accessResult: the original result from the access control function\n       *  - accessKey: 'read', 'create', 'update', 'delete', 'readVersions', or 'unlock'\n       *  - ...restOfAccessArgs: the original arguments passed to the access control function\n       */\n      accessResultOverride?: CollectionAccessResultOverride\n      /**\n       * Opt out of adding the tenant field and place\n       * it manually using the `tenantField` export from the plugin\n       */\n      customTenantField?: boolean\n      /**\n       * Set to `true` if you want the collection to behave as a global\n       *\n       * @default false\n       */\n      isGlobal?: boolean\n      /**\n       * Overrides for the tenant field, will override the entire tenantField configuration\n       */\n      tenantFieldOverrides?: CollectionTenantFieldConfigOverrides\n      /**\n       * Set to `false` if you want to manually apply the baseListFilter\n       * Set to `false` if you want to manually apply the baseFilter\n       *\n       * @default true\n       */\n      useBaseFilter?: boolean\n      /**\n       * @deprecated Use `useBaseFilter` instead. If both are defined,\n       * `useBaseFilter` will take precedence. This property remains only\n       * for backward compatibility and may be removed in a future version.\n       *\n       * Originally, `baseListFilter` was intended to filter only the List View\n       * in the admin panel. However, base filtering is often required in other areas\n       * such as internal link relationships in the Lexical editor.\n       *\n       * @default true\n       */\n      useBaseListFilter?: boolean\n      /**\n       * Set to `false` if you want to handle collection access manually without the multi-tenant constraints applied\n       *\n       * @default true\n       */\n      useTenantAccess?: boolean\n    }\n  }\n  /**\n   * Enables debug mode\n   * - Makes the tenant field visible in the admin UI within applicable collections\n   *\n   * @default false\n   */\n  debug?: boolean\n  /**\n   * Enables the multi-tenant plugin\n   *\n   * @default true\n   */\n  enabled?: boolean\n  /**\n   * Localization for the plugin\n   */\n  i18n?: {\n    translations: {\n      [key in AcceptedLanguages]?: {\n        /**\n         * Shown inside 3 dot menu on edit document view\n         *\n         * @default 'Assign Tenant'\n         */\n        'assign-tenant-button-label'?: string\n        /**\n         * Shown as the title of the assign tenant modal\n         *\n         * @default 'Assign \"{{title}}\"'\n         */\n        'assign-tenant-modal-title'?: string\n        /**\n         * Shown as the label for the assigned tenant field in the assign tenant modal\n         *\n         * @default 'Assigned Tenant'\n         */\n        'field-assignedTenant-label'?: string\n        /**\n         * Shown as the label for the global tenant selector in the admin UI\n         *\n         * @default 'Filter by Tenant'\n         */\n        'nav-tenantSelector-label'?: string\n      }\n    }\n  }\n  /**\n   * Field configuration for the field added to all tenant enabled collections\n   */\n  tenantField?: RootTenantFieldConfigOverrides\n  /**\n   * Field configuration for the field added to the users collection\n   *\n   * If `includeDefaultField` is `false`, you must include the field on your users collection manually\n   * This is useful if you want to customize the field or place the field in a specific location\n   */\n  tenantsArrayField?:\n    | {\n        /**\n         * Access configuration for the array field\n         */\n        arrayFieldAccess?: ArrayField['access']\n        /**\n         * Name of the array field\n         *\n         * @default 'tenants'\n         */\n        arrayFieldName?: string\n        /**\n         * Name of the tenant field\n         *\n         * @default 'tenant'\n         */\n        arrayTenantFieldName?: string\n        /**\n         * When `includeDefaultField` is `true`, the field will be added to the users collection automatically\n         */\n        includeDefaultField?: true\n        /**\n         * Additional fields to include on the tenants array field\n         */\n        rowFields?: Field[]\n        /**\n         * Access configuration for the tenant field\n         */\n        tenantFieldAccess?: RelationshipField['access']\n      }\n    | {\n        arrayFieldAccess?: never\n        arrayFieldName?: string\n        arrayTenantFieldName?: string\n        /**\n         * When `includeDefaultField` is `false`, you must include the field on your users collection manually\n         */\n        includeDefaultField?: false\n        rowFields?: never\n        tenantFieldAccess?: never\n      }\n  /**\n   * Customize tenant selector label\n   *\n   * Either a string or an object where the keys are i18n codes and the values are the string labels\n   *\n   * @deprecated Use `i18n.translations` instead.\n   */\n  tenantSelectorLabel?:\n    | Partial<{\n        [key in AcceptedLanguages]?: string\n      }>\n    | string\n  /**\n   * The slug for the tenant collection\n   *\n   * @default 'tenants'\n   */\n  tenantsSlug?: string\n  /**\n   * Function that determines if a user has access to _all_ tenants\n   *\n   * Useful for super-admin type users\n   */\n  userHasAccessToAllTenants?: (\n    user: ConfigTypes extends { user: unknown } ? ConfigTypes['user'] : TypedUser,\n  ) => boolean\n  /**\n   * Override the access result on the users collection access control functions\n   *\n   * The function receives:\n   *  - accessResult: the original result from the access control function\n   *  - accessKey: 'read', 'create', 'update', 'delete', 'readVersions', or 'unlock'\n   *  - ...restOfAccessArgs: the original arguments passed to the access control function\n   */\n  usersAccessResultOverride?: CollectionAccessResultOverride\n  /**\n   * Opt out of adding access constraints to the tenants collection\n   */\n  useTenantsCollectionAccess?: boolean\n  /**\n   * Opt out including the baseListFilter to filter tenants by selected tenant\n   */\n  useTenantsListFilter?: boolean\n\n  /**\n   * Opt out including the baseListFilter to filter users by selected tenant\n   */\n  useUsersTenantFilter?: boolean\n}\n\nexport type RootTenantFieldConfigOverrides = Partial<\n  Omit<\n    SingleRelationshipField,\n    | '_sanitized'\n    | 'hidden'\n    | 'index'\n    | 'localized'\n    | 'max'\n    | 'maxRows'\n    | 'min'\n    | 'minRows'\n    | 'relationTo'\n    | 'required'\n    | 'type'\n    | 'unique'\n    | 'virtual'\n  >\n>\n\nexport type CollectionTenantFieldConfigOverrides = Partial<\n  Omit<RootTenantFieldConfigOverrides, 'name'>\n>\n\nexport type Tenant<IDType = number | string> = {\n  id: IDType\n  name: string\n}\n\nexport type UserWithTenantsField = {\n  tenants?:\n    | {\n        tenant: number | string | Tenant\n      }[]\n    | null\n} & TypedUser\n\ntype AllAccessKeysT<T extends readonly string[]> = T[number] extends keyof Omit<\n  Required<CollectionConfig>['access'],\n  'admin'\n>\n  ? keyof Omit<Required<CollectionConfig>['access'], 'admin'> extends T[number]\n    ? T\n    : never\n  : never\n\nexport type AllAccessKeys = AllAccessKeysT<\n  ['create', 'read', 'update', 'delete', 'readVersions', 'unlock']\n>\n\nexport type CollectionAccessResultOverride = ({\n  accessKey,\n  accessResult,\n}: {\n  accessKey: AllAccessKeys[number]\n  accessResult: AccessResult\n} & AccessArgs) => AccessResult | Promise<AccessResult>\n"],"names":[],"mappings":"AA2RA,WAMuD"}